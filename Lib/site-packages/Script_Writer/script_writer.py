import sys
from PyQt5.QtWidgets import QApplication, QWidget
from win32api import GetSystemMetrics
from PyQt5.QtGui import QIcon
from PyQt5.QtWidgets import QApplication, QWidget, QInputDialog, QLineEdit, QFileDialog
from PyQt5.QtWidgets import QApplication, QWidget, QPushButton, QMessageBox
from PyQt5 import QtGui, uic, Qt
from PyQt5.QtGui import QStandardItemModel,QStandardItem
import traceback
from variable_file_getter import Variable_File_Getter
import os
from PyQt5.QtGui import QIcon, QPixmap
import base64
import sys
from PyQt5.QtGui import *
from PyQt5.QtWidgets import *
from PyQt5.QtCore import *
from Script_Writer.editor import Editor_Class
from Script_Writer.snipping_tool import Snipping_Tool_Class


import shutil
import PyQt5
from win32api import GetSystemMetrics
from PyQt5 import QtCore


class Script_Writer_Class(QWidget):

    def __init__(self):
        super().__init__()
        #self.ui = uic.loadUi(r"database_viewer.ui")
        self.ui = uic.loadUi(r"C:\ImageScripter_2\Lib\site-packages\Script_Writer\script_writer.ui")
        self.editor = Editor_Class()
        self.ui.setWindowTitle("Script Writer")
        self.ui.horizontalLayout.addWidget(self.editor)
        self.ui.pushButton_4.clicked.connect(self.capture_button_clicked)
        self.ui.actionOpen.triggered.connect(self.open_clicked)
        self.ui.actionSave.triggered.connect(self.Save_clicked)
        self.ui.actionSave_As.triggered.connect(self.Save_As_clicked)
        self.ui.actionClose.triggered.connect(self.Close_clicked)
        #self.ui.show()
        self.ui.showMaximized()

    def open_clicked(self):
        print('open')

    def Save_clicked(self):
        print('save')

    def Save_As_clicked(self):
        print('save as')

    def Close_clicked(self):
        print('close')




    def capture_button_clicked(self):
        import subprocess
        subprocess.Popen(r"C:\ImageScripter_2\python.exe C:\ImageScripter_2\Lib\site-packages\Script_Writer\snipping_tool.py", shell=True)





        #window = Snipping_Tool_Class()
        ##window.show()




if __name__ == '__main__':
    app = QApplication(sys.argv)
    Script_Writer = Script_Writer_Class()
    #Script_Writer.showMaximized()
    sys.exit(app.exec_())