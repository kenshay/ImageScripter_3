
from elan import *
Start_Image_Show()
from elan.functions import Diff

#Finished 3/6/19

#DONE
def Get_Device_List_Simple(One,Two,Three):
    One.Click()
    Two.RightClickTypeThenPress(Three,'enter')
    list = AddNewDevice.ListView.GetSelection(1)
    AddNewDevice.PushButton.Click('Cancel')
    return list

#Configurator.Reset(start=True)
Configurator.Start(password = '')

#Past_List =  ['Autonomic OSD', 'Kaleidescape', 'Lilin', 'SnapAV Luma 500 NVR', 'SnapAV WPS-300-NVR', 'Sony BDP-CX7000ES']
Past_List =  ['Autonomic OSD', 'ELAN', 'Kaleidescape', 'ELAN', 'Lilin', 'Janus', 'SnapAV Luma 500 NVR', 'ELAN', 'SnapAV WPS-300-NVR', 'ELAN', 'Sony BDP-CX7000ES', 'ELAN']

one = Configurator.media
two = Configurator.sources
three = 'aaa'

Current_List = Get_Device_List_Simple(one,two,three)


Configurator.system.Click()

if Current_List != Past_List:
    Difference = Diff(Past_List,Current_List)
    error = 'List Changed\n' + str(Difference)
    raise ValueError(error)

Configurator.CloseAndClean()


Close_Image_Show()