from elan import ElanSettings
from elan import *
from ImageScripter import *
import os
import telnetlib
from ImageScripter import *
from elan import *
from pytank.Core.SystemFunctions import Say

def YesNoCombobox(button,yes_or_no,x = 200):
    button.RealClick(xoffset = x)
    if yes_or_no == 'yes':
        Configurator.Type('y')
        Configurator.Press('enter')       
    elif yes_or_no == 'no':
        Configurator.Type('n')
        Configurator.Press('enter')

def PowerAndroid():

    PanamaxIP = "192.168.0.199"
    Interface_Outlet = 5
    
    def PowerOn(x):
        x = str(x)
        string = "!SWITCH " +  x + " ON"
        tn = telnetlib.Telnet(PanamaxIP, 23)
        user = ""
        tn.write(string.encode('ascii') + "\r\n".encode('ascii'))
        tn.close()
        print('cloased')
    
    
    
    def PowerOff(x):
        x = str(x)
        string = "!SWITCH " +  x + " OFF"
        tn = telnetlib.Telnet(PanamaxIP, 23)
        user = ""
        tn.write(string.encode('ascii') + "\r\n".encode('ascii'))
        tn.close()
        print('Powered OFF')
        
    Viewer.Start()
    Viewer.CloseAndClean()
    
    
    if not os.path.exists(ElanSettings.adb_location):
        print('You need to set the adb location in Elan settings')
    else:
        os.chdir(ElanSettings.adb_location)
        os.system("adb start-server")
        
        PowerOff(Interface_Outlet)
        sleep(10)
        PowerOn(Interface_Outlet)
        
        #os.system("adb reboot")    
        
    for i in range(500):
        try:
            if Android.away.Exists():
                os.system("adb shell settings put global stay_on_while_plugged_in 3")
                break
            elif Android.attentionpassword.Exists():
                os.system("adb shell settings put global stay_on_while_plugged_in 3")
                break
            else:
                print("Waiting for Android 3..")
                PowerOff(Interface_Outlet)
                sleep(10)
                PowerOn(Interface_Outlet)
                sleep(60)
                os.system("adb shell settings put global stay_on_while_plugged_in 3")
                
        except Exception as e:
            print("Exception -> " + str(e))
            print("Waiting for Android 4..")
            PowerOff(Interface_Outlet)
            sleep(10)
            PowerOn(Interface_Outlet)
            sleep(60)
            os.system("adb shell settings put global stay_on_while_plugged_in 3")

####################################

print("Power Android")

PowerAndroid()



def Check_If_Blue_Screen_Exists(): 
        Say("Checking if Blue Screen Exists")
        x = 0
        for i in range(2):
            if Android.bluescreenlarge.Exists() == True:
                Say("BlueScreen exists")
                x += 1
                sleep(1)
                if x >= 2:
                    raise ValueError("Blue Screen Exception")
                else:
                    pass
            elif Android.bluescreenlarge.Exists() == False:
                Say("Blue Screen Does Not Exist")
      
                pass
              
     

dvr_path = "//192.168.0.194/files/DVR"
static_camera_url = "http://192.168.0.103/onvif/device_service"
camera_url_generic = "http://192.168.0.195/nphMotionJpeg?Resolution=320x240&Quality=Standard"
#camera_ip = "192.168.0.195"
camera_ip = "195"
cameraType = "Panasonic Standard Series"
generic_user = 'Administrator'

generic_Pasword = 'password'
#############


Configurator.SetTimeZone()
#############Add Nas

Say("Attempting to Add Network Attached Storage")
Configurator.Start()

Configurator.video.Click()
Configurator.builtindvroptions.Click()
Configurator.Edit.SetText(0,dvr_path)#@

Configurator.Edit.SetText(6,"50000")#@

Configurator.apply.Click()

Configurator.custompages.Click()
Configurator.builtindvroptions.Click()

Configurator.storagesizesetto5000.Wait()
####################################################ADD Dynamic
Say("Attempting to Add ONVIF Dynamic Camera")
Configurator.videocamerassources.RightClickType('a')
try:
    AddNewDevice.Wait()
except:
    sleep(3)
    #theObject.RealClick()
    Configurator.videocamerassources.RightClickType('a')
    
AddNewDevice.name.Wait()
sleep(1)
AddNewDevice.Type('Dynamic')


AddNewDevice.ListView.Select(1,"ONVIF Video Source (Dynamic)")
AddNewDevice.Wait()
sleep(3)

AddNewDevice.Edit.SetText(1,'admin')#@
AddNewDevice.Edit.SetText(2,'admin')#@


AddNewDevice.PushButton.Click("Search For Devices")

Add.devicetype.Wait()
Add.devicetype.RealClick()
sleep(5)
Add.ListView.Select(0,"Linear")
Add.PushButton.Click("OK")

####################################Add Static 1
Say("Attempting to Add ONVIF Static Camera 1")
Configurator.videocamerassources.RightClickType('a')
try:
    AddNewDevice.Wait()
except:
    sleep(3)
    #theObject.RealClick()
    Configurator.videocamerassources.RightClickType('a') 
AddNewDevice.name.Wait()
sleep(1)
AddNewDevice.Type('Static One')
AddNewDevice.ListView.Select(1,"ONVIF Video Source (Static)")
AddNewDevice.Wait()
sleep(3)
Add.PushButton.Click("OK")
sleep(3)
#Configurator.Edit.SetText(9,"admin")
#Configurator.Edit.SetText(10,"admin")
Configurator.username.RealClick(xoffset = 200)
Configurator.Type("admin")
#
Configurator.password.RealClick(xoffset = 200)
Configurator.Type("admin")



#Configurator.Edit.SetText(8,static_camera_url)
Configurator.url.RealClick(xoffset = 400)
for i in range(100):
    Press('backspace')
Configurator.Type(static_camera_url)


sleep(2)
Configurator.apply.Click()

####################################Add Static 2
Say("Attempting to Add ONVIF Static Camera 2")
Configurator.videocamerassources.RightClickType('a')
try:
    AddNewDevice.Wait()
except:
    sleep(3)
    #theObject.RealClick()
    Configurator.videocamerassources.RightClickType('a') 
AddNewDevice.name.Wait()
sleep(1)
AddNewDevice.Type('Static Two')
AddNewDevice.ListView.Select(1,"ONVIF Video Source (Static)")
AddNewDevice.Wait()
sleep(3)
Add.PushButton.Click("OK")
sleep(3)
#Configurator.Edit.SetText(9,"admin")
#Configurator.Edit.SetText(10,"admin")
Configurator.username.RealClick(xoffset = 200)
Configurator.Type("admin")
#
Configurator.password.RealClick(xoffset = 200)
Configurator.Type("admin")

#Configurator.Edit.SetText(8,static_camera_url)
Configurator.url.RealClick(xoffset = 400)
for i in range(100):
    Press('backspace')
Configurator.Type(static_camera_url)

sleep(2)
Configurator.apply.Click()


####################################Add Generic 1
Say("Attempting to Add Generic URL Video Camera 1")
Configurator.videocamerassources.RightClickType('a')
try:
    AddNewDevice.Wait()
except:
    sleep(3)
    #theObject.RealClick()
    Configurator.videocamerassources.RightClickType('a') 
AddNewDevice.name.Wait()
sleep(1)
AddNewDevice.Type('Generic One')
AddNewDevice.ListView.Select(1,"Generic URL Video Camera")
AddNewDevice.Wait()
sleep(3)
Add.PushButton.Click("OK")
sleep(5)
#Configurator.Edit.SetText(5,camera_url_generic)
Configurator.url.RealClick(xoffset = 400)
for i in range(100):
    Press('backspace')
Configurator.Type(camera_url_generic)




#################################################
#Configurator.Edit.SetText(7,camera_ip)7 #Bad
#Configurator.ipaddress.RealClick(xoffset = 150)
#Configurator.Type(camera_ip)
Configurator.ipaddress.RealClick(xoffset = 320)
Configurator.Press('backspace')
Configurator.Type(camera_ip)
##############################################
############################
#sleep(3)########################################
#Configurator.Edit.SetText(8,generic_user) Bad
#Configurator.Edit.SetText(9,generic_Pasword) Bad
######
Configurator.username.RealClick(xoffset = 200)
Configurator.Type(generic_user)
#
Configurator.password.RealClick(xoffset = 200)
Configurator.Type(generic_Pasword)
######
#Configurator.Edit.SetText(11,generic_user)#fix
#Configurator.Edit.SetText(12,generic_Pasword)#fix
################################
sleep(2)
Configurator.apply.Click()

####################################Add Generic 2
Say("Attempting to Add Generic URL Video Camera 2")
Configurator.videocamerassources.RightClickType('a')
try:
    AddNewDevice.Wait()
except:
    sleep(3)
    #theObject.RealClick()
    Configurator.videocamerassources.RightClickType('a') 
AddNewDevice.name.Wait()
sleep(1)
AddNewDevice.Type('Generic Two')
AddNewDevice.ListView.Select(1,"Generic URL Video Camera")
AddNewDevice.Wait()
sleep(3)
Add.PushButton.Click("OK")

sleep(3)
#Configurator.Edit.SetText(5,camera_url_generic)
Configurator.url.RealClick(xoffset = 400)
for i in range(100):
    Press('backspace')
Configurator.Type(camera_url_generic)

Configurator.ipaddress.RealClick(xoffset = 320)
Configurator.Press('backspace')
Configurator.Type(camera_ip)
###########################
######
Configurator.username.RealClick(xoffset = 200)
Configurator.Type(generic_user)
#
Configurator.password.RealClick(xoffset = 200)
Configurator.Type(generic_Pasword)
########
#Configurator.Edit.SetText(11,generic_user)#fix
#Configurator.Edit.SetText(12,generic_Pasword)#fix
#Configurator.Edit.SetText(6,camera_ip)
#Configurator.Edit.SetText(8,generic_user)
#Configurator.Edit.SetText(9,generic_Pasword)
sleep(2)
Configurator.apply.Click()



###############################Start loop#################

####################################Add Panasonic one PPlain
Say("Attempting to Add Panasonic one PPlain Camera")
NameVar = "PPlain"
Configurator.videocamerassources.RightClickType('a')
try:
    AddNewDevice.Wait()
except:
    sleep(3)
    #theObject.RealClick()
    Configurator.videocamerassources.RightClickType('a') 
AddNewDevice.name.Wait()
sleep(1)
AddNewDevice.Type(NameVar)
AddNewDevice.ListView.Select(1,cameraType)
AddNewDevice.Wait()
sleep(3)
Add.PushButton.Click("OK")
Configurator.name.Wait()
sleep(3)
#Configurator.Edit.SetText(5,camera_ip)
Configurator.ipaddress.RealClick(xoffset=320)
Configurator.Press('backspace')
Configurator.Type(camera_ip)
#$$$
#Configurator.ComboBox.Select(6,1)
YesNoCombobox(Configurator.hidefullscreencontrol,'yes')  
#Configurator.ComboBox.Select(7,1)
YesNoCombobox(Configurator.hiderescontrol,'yes')  
sleep(2)
Configurator.apply.Click()

####################################Add Panasonic Two PZoom
Say("Attempting to Add Panasonic Zoom Camera")
NameVar = "PZoom"
Configurator.videocamerassources.RightClickType('a')
try:
    AddNewDevice.Wait()
except:
    sleep(3)
    #theObject.RealClick()
    
    ############################################
    try:
        Configurator.videocamerassources.RightClickType('a') 
    except:
        pass
AddNewDevice.name.Wait()
sleep(1)
AddNewDevice.Type(NameVar)
AddNewDevice.ListView.Select(1,cameraType)
AddNewDevice.Wait()
sleep(3)
Add.PushButton.Click("OK")

Configurator.name.Wait()
sleep(3)
#Configurator.Edit.SetText(5,camera_ip)
Configurator.ipaddress.RealClick(xoffset=320)
Configurator.Press('backspace')
Configurator.Type(camera_ip)
###
#Configurator.ComboBox.Select(1,1)
YesNoCombobox(Configurator.haszoom,'yes')  
#Turn off Full Screen, Resolution
#Configurator.ComboBox.Select(6,1)
#Configurator.ComboBox.Select(7,1)
YesNoCombobox(Configurator.hidefullscreencontrol,'yes')  
YesNoCombobox(Configurator.hiderescontrol,'yes') 
#Configurator.ComboBox.Select(7,1)




sleep(2)
Configurator.apply.Click()

####################################Add Panasonic Three PPResets
Say("Attempting to Add Panasonic PPResets Camera")
NameVar = "PPresets"
Configurator.videocamerassources.RightClickType('a')
try:
    AddNewDevice.Wait()
except:
    sleep(3)
    #theObject.RealClick()
    Configurator.videocamerassources.RightClickType('a') 
AddNewDevice.name.Wait()
sleep(1)
AddNewDevice.Type(NameVar)
AddNewDevice.ListView.Select(1,cameraType)
AddNewDevice.Wait()
sleep(3)
Add.PushButton.Click("OK")
Configurator.name.Wait()

sleep(3)
#Configurator.Edit.SetText(5,camera_ip)
Configurator.ipaddress.RealClick(xoffset=320)
Configurator.Press('backspace')
Configurator.Type(camera_ip)
###
#Configurator.ComboBox.Select(2,1)
YesNoCombobox(Configurator.haspresets,'yes') 
####
#Turn off Full Screen, Resolution
YesNoCombobox(Configurator.hidefullscreencontrol,'yes')  
YesNoCombobox(Configurator.hiderescontrol,'yes') 
#Configurator.ComboBox.Select(6,1)
#Configurator.ComboBox.Select(7,1)

sleep(2)
Configurator.apply.Click()

####################################Add Panasonic Four PAudio
Say("Attempting to Add Panasonic PAudio Camera")
NameVar = "PAudio"
Configurator.videocamerassources.RightClickType('a')
try:
    AddNewDevice.Wait()
except:
    sleep(3)
    #theObject.RealClick()
    Configurator.videocamerassources.RightClickType('a') 
AddNewDevice.name.Wait()
sleep(1)
AddNewDevice.Type(NameVar)

AddNewDevice.ListView.Select(1,cameraType)
AddNewDevice.Wait()
sleep(3)
Add.PushButton.Click("OK")
Configurator.name.Wait()
sleep(3)
#Configurator.Edit.SetText(5,camera_ip)
Configurator.ipaddress.RealClick(xoffset=320)
Configurator.Press('backspace')
Configurator.Type(camera_ip)
###
#Configurator.ComboBox.Select(3,1)
YesNoCombobox(Configurator.hasaudio,'yes')
####
#Turn off Full Screen, Resolution
#Configurator.ComboBox.Select(6,1)
#Configurator.ComboBox.Select(7,1)
YesNoCombobox(Configurator.hidefullscreencontrol,'yes')  
YesNoCombobox(Configurator.hiderescontrol,'yes') 

sleep(2)
Configurator.apply.Click()


####################################Add Panasonic FIVE FullScreen
Say("Attempting to Add Panasonic FullScreen Camera")
NameVar = "PFullScreen"
Configurator.videocamerassources.RightClickType('a')
try:
    AddNewDevice.Wait()
except:
    sleep(3)
    #theObject.RealClick()
    Configurator.videocamerassources.RightClickType('a') 
AddNewDevice.name.Wait()
sleep(1)
AddNewDevice.Type(NameVar)

AddNewDevice.ListView.Select(1,cameraType)
AddNewDevice.Wait()
sleep(3)
Add.PushButton.Click("OK")
Configurator.name.Wait()
sleep(3)
#Configurator.Edit.SetText(5,camera_ip)
Configurator.ipaddress.RealClick(xoffset=320)
Configurator.Press('backspace')
Configurator.Type(camera_ip)
##
#Configurator.ComboBox.Select(6,0)
YesNoCombobox(Configurator.hidefullscreencontrol,'no')  
##


#Turn off Resolution
YesNoCombobox(Configurator.hiderescontrol,'yes')  
#Configurator.ComboBox.Select(7,1)



sleep(2)
Configurator.apply.Click()

####################################Add Panasonic Six Resolution
Say("Attempting to Add Panasonic Resolution Camera")
NameVar = "PResolution"
Configurator.videocamerassources.RightClickType('a')
try:
    AddNewDevice.Wait()
except:
    sleep(3)
    #theObject.RealClick()
    Configurator.videocamerassources.RightClickType('a') 
AddNewDevice.name.Wait()
sleep(1)
AddNewDevice.Type(NameVar)

AddNewDevice.ListView.Select(1,cameraType)
AddNewDevice.Wait()
sleep(3)
Add.PushButton.Click("OK")
Configurator.name.Wait()
sleep(10)
#for i in range(10):
    #Configurator.Edit.SetText(5,camera_ip)
Configurator.ipaddress.RealClick(xoffset=320)
Configurator.Press('backspace')
Configurator.Type(camera_ip)

#Configurator.ComboBox.Select(7,0)
YesNoCombobox(Configurator.hiderescontrol,'no')  


#Turn off Full Screen
#Configurator.ComboBox.Select(6,1)
YesNoCombobox(Configurator.hidefullscreencontrol,'yes')  




sleep(2)
Configurator.apply.Click()

####################################Add Panasonic Seven All
Say("Attempting to Add Panasonic All Camera")
NameVar = "PAll"
Configurator.videocamerassources.RightClickType('a')
try:
    AddNewDevice.Wait()
except:
    sleep(3)
    #theObject.RealClick()
    Configurator.videocamerassources.RightClickType('a') 
AddNewDevice.name.Wait()
sleep(1)
AddNewDevice.Type(NameVar)

AddNewDevice.ListView.Select(1,cameraType)
AddNewDevice.Wait()
sleep(3)
Add.PushButton.Click("OK")
Configurator.name.Wait()
sleep(3)
#Configurator.Edit.SetText(5,camera_ip)

Configurator.ipaddress.RealClick(xoffset=320)
Configurator.Press('backspace')
Configurator.Type(camera_ip)

#Configurator.ComboBox.Select(0,1)
#Configurator.ComboBox.Select(1,1)
#Configurator.ComboBox.Select(2,1)
#Configurator.ComboBox.Select(3,1)
#Configurator.ComboBox.Select(4,1)
#Configurator.ComboBox.Select(10,1)
#Configurator.ComboBox.Select(11,1)
#Configurator.ComboBox.Select(6,0)
#Configurator.ComboBox.Select(7,0)
YesNoCombobox(Configurator.haspanandtilt,'yes')
YesNoCombobox(Configurator.haszoom,'yes')
YesNoCombobox(Configurator.haspresets,'yes')
YesNoCombobox(Configurator.hasaudio,'yes')
YesNoCombobox(Configurator.hasmotiondetect,'yes')
YesNoCombobox(Configurator.flipimage180,'yes')
YesNoCombobox(Configurator.hidefullscreencontrol,'no')
YesNoCombobox(Configurator.hiderescontroll,'no')
YesNoCombobox(Configurator.showprivacymasktoggle,'yes')
YesNoCombobox(Configurator.enabledvr,'yes')
sleep(2)
Configurator.apply.Click()

####################################Add Panasonic Eight Low
Say("Attempting to Add Panasonic Low Camera")
NameVar = "PLow"
Configurator.videocamerassources.RightClickType('a')
try:
    AddNewDevice.Wait()
except:
    sleep(3)
    #theObject.RealClick()
    Configurator.videocamerassources.RightClickType('a') 
AddNewDevice.name.Wait()
sleep(1)
AddNewDevice.Type(NameVar)

AddNewDevice.ListView.Select(1,cameraType)
AddNewDevice.Wait()
sleep(3)
Add.PushButton.Click("OK")

Configurator.name.Wait()
sleep(3)

#Configurator.Edit.SetText(5,camera_ip)
Configurator.ipaddress.RealClick(xoffset=320)
Configurator.Press('backspace')
Configurator.Type(camera_ip)



YesNoCombobox(Configurator.hiderescontroll,'no')

Configurator.defaultresolution.RealClick(xoffset = 200)
Configurator.Press('up') 
Configurator.Press('up') 
Configurator.Press('up') 
Configurator.Press('enter') 


#Turn off Full Screen
YesNoCombobox(Configurator.hidefullscreencontrol,'yes')








sleep(2)
Configurator.apply.Click()

####################################Add Panasonic Nine PMed
Say("Attempting to Add Panasonic Med Camera")
NameVar = "PMed"
Configurator.videocamerassources.RightClickType('a')
try:
    AddNewDevice.Wait()
except:
    sleep(3)
    #theObject.RealClick()
    Configurator.videocamerassources.RightClickType('a') 
AddNewDevice.name.Wait()
sleep(1)
AddNewDevice.Type(NameVar)

AddNewDevice.ListView.Select(1,cameraType)
AddNewDevice.Wait()
sleep(3)
Add.PushButton.Click("OK")
Configurator.name.Wait()
sleep(3)
#Configurator.Edit.SetText(5,camera_ip)
Configurator.ipaddress.RealClick(xoffset=320)
Configurator.Press('backspace')
Configurator.Type(camera_ip)



YesNoCombobox(Configurator.hiderescontroll,'no')

Configurator.defaultresolution.RealClick(xoffset = 200)
Configurator.Press('up') 
Configurator.Press('up') 
Configurator.Press('enter') 


#Turn off Full Screen
YesNoCombobox(Configurator.hidefullscreencontrol,'yes')



sleep(2)
Configurator.apply.Click()

####################################Add Panasonic Ten PHigh
Say("Attempting to Add Panasonic High Camera")
NameVar = "PHigh"
Configurator.videocamerassources.RightClickType('a')
try:
    AddNewDevice.Wait()
except:
    sleep(3)
    #theObject.RealClick()
    try:
        Configurator.videocamerassources.RightClickType('a')
    except ValueError:
        pass
AddNewDevice.name.Wait()
sleep(1)
AddNewDevice.Type(NameVar)

AddNewDevice.ListView.Select(1,cameraType)
AddNewDevice.Wait()
sleep(3)
Add.PushButton.Click("OK")
Configurator.name.Wait()
sleep(3)
#Configurator.Edit.SetText(5,camera_ip)

Configurator.ipaddress.RealClick(xoffset=320)
Configurator.Press('backspace')
Configurator.Type(camera_ip)

YesNoCombobox(Configurator.hiderescontroll,'no')

Configurator.defaultresolution.RealClick(xoffset = 200)
Configurator.Press('up') 
Configurator.Press('enter') 


#Turn off Full Screen
YesNoCombobox(Configurator.hidefullscreencontrol,'yes')



sleep(2)
Configurator.apply.Click()

####################################Add Panasonic Eleven PDVR
Say("Attempting to Add Panasonic DVR Camera")
NameVar = "PDVR"
Configurator.videocamerassources.RightClickType('a')
try:
    AddNewDevice.Wait()
except:
    sleep(3)
    #theObject.RealClick()
    Configurator.videocamerassources.RightClickType('a') 
AddNewDevice.name.Wait()
sleep(1)
AddNewDevice.Type(NameVar)

AddNewDevice.ListView.Select(1,cameraType)
AddNewDevice.Wait()
sleep(3)
Add.PushButton.Click("OK")
Configurator.name.Wait()
sleep(3)
#Configurator.Edit.SetText(5,camera_ip)
Configurator.ipaddress.RealClick(xoffset=320)
Configurator.Press('backspace')
Configurator.Type(camera_ip)
######

#####
#Configurator.ComboBox.Select(4,1)
YesNoCombobox(Configurator.hasmotiondetect,'yes')

#Configurator.ComboBox.Select(9,1)
#Res high
Configurator.defaultresolution.RealClick(xoffset = 200)
Configurator.Press('up') 
Configurator.Press('enter') 


#Configurator.ComboBox.Select(12,2)
YesNoCombobox(Configurator.enabledvr,'yes')


#Turn off Full Screen, Resolution
#Configurator.ComboBox.Select(6,1)
#Configurator.ComboBox.Select(7,1)
YesNoCombobox(Configurator.hidefullscreencontrol,'yes')  
YesNoCombobox(Configurator.hiderescontrol,'yes') 


sleep(2)
Configurator.apply.Click()
#############################################################quad setup
Say("Creating Quad custom page")
Configurator.custompages.RightClickType('a')
Add.Edit.SetText(0,'FourCam')
Add.PushButton.Click("OK")
Configurator.system.Click()
Configurator.video.Click()

sleep(3)
Configurator.fourcam.Max()

Configurator.largeformat.Click()

Configurator.topleft.RightClickType('a')
Add.Edit.SetText(0,'VidONE')
Add.ListBox.Select(0,'Video Stream')
Add.PushButton.Click('OK')

Configurator.topright.RightClickType('a')
Add.Edit.SetText(0,'VidTWO')
Add.ListBox.Select(0,'Video Stream')
Add.PushButton.Click('OK')

Configurator.bottomleft.RightClickType('a')
Add.Edit.SetText(0,'VidTHREE')
Add.ListBox.Select(0,'Video Stream')
Add.PushButton.Click('OK')

Configurator.bottomright.RightClickType('a')
Add.Edit.SetText(0,'VidFOUR')
Add.ListBox.Select(0,'Video Stream')
Add.PushButton.Click('OK')
Configurator.apply.Click()
sleep(4)

###############################################VIDONE
Configurator.vidone.RightClickType("s")
sleep(2)
#print(VideoStream.ComboBox.GetSelection(2))
try:
    VideoStream.ComboBox.Select(2,'Dynamic')
except:
    Configurator.vidfour.Click()
    Configurator.vidone.RightClickType("s")
    sleep(2)
    VideoStream.ComboBox.Select(2,'Dynamic')

VideoStream.ComboBox.Select(3,'FS Full')   
 
VideoStream.Close()
Configurator.apply.Click()
###############################################VIDTWO
Configurator.vidtwo.RightClickType("s")
sleep(2)
#print(VideoStream.ComboBox.GetSelection(2))
try:
    VideoStream.ComboBox.Select(2,'Generic One')
except:
    try:
        Configurator.vidtwo.RightClickType("s")
        sleep(5)
        VideoStream.ComboBox.Select(2,'Generic One')
    except:
        Configurator.vidtwo2.RightClickType("s")
        sleep(10)
        VideoStream.ComboBox.Select(2,'Generic One')
    
    
VideoStream.Close()
Configurator.apply.Click()
###############################################VIDTHREE
Configurator.vidthree.RightClickType("s")
sleep(2)
#print(VideoStream.ComboBox.GetSelection(2))
VideoStream.ComboBox.Select(2,'Generic Two')
VideoStream.Close()
Configurator.apply.Click()
###############################################VIDFOUR
Configurator.vidfour.RightClickType("s")
sleep(2)
#print(VideoStream.ComboBox.GetSelection(2))
VideoStream.ComboBox.Select(2,'PAll')
VideoStream.Close()
Configurator.apply.Click()
###########################################################CheckDVRSTATus
Say("Checking DVR Status")
sleep(3)

Configurator.pdvrdevice.RightClickType('S')
sleep(2)
Status.bytesout.Wait()
sleep(2)
if Status.motiona.Exists == True:
    raise ValueError("Motion should not be N.A.")
else:
    Status.Close()

Configurator.CloseAndClean()

if Android.shuddar.Exists():
    Android.shuddar.Click()
else:
    print('shudder doesnt exist')

sleep(3)
Android.video.Click()

sleep(3)
try:
    Android.videocameras.Click(xoffset = -500,yoffset = 200)
except:
    sleep(5)
    Android.video.Click()
    Android.videocameras.Click(xoffset = -500,yoffset = 200)
    sleep(3)
###kkkk

############################################Dynamic
Say("Checking for Blue Screen on Dynamic Camera")
Check_If_Blue_Screen_Exists()

Android.gonextarrow.Click()

############################################Static 1
Say("Checking for Blue Screen on Static 1 Camera")

Check_If_Blue_Screen_Exists()

Android.gonextarrow.Click()

############################################Static 2
Say("Checking for Blue Screen on Static 2 Camera")
Check_If_Blue_Screen_Exists()

Android.gonextarrow.Click()

############################################Generic 1
Say("Checking for Blue Screen on Generic 1 Camera")
Check_If_Blue_Screen_Exists()

Android.gonextarrow.Click()

############################################Generic 2
Say("Checking for Blue Screen on Generic 2 Camera")
Check_If_Blue_Screen_Exists()

Android.gonextarrow.Click()

############################################Plain########
Say("Checking for Blue Screen on Plain Camera")
Check_If_Blue_Screen_Exists()

Android.nocamcontrols.Wait()


Android.gonextarrow.Click()

############################################Zoom########
Say("Checking for Blue Screen on Zoom Camera")
Check_If_Blue_Screen_Exists()

for i in range(5):
    Android.zoomincam.Click()
sleep(3)
for i in range(5):
    Android.zoomoutcam.Click()

Check_If_Blue_Screen_Exists()

Android.gonextarrow.Click()

############################################Preset########
Say("Checking for Blue Screen on Preset Camera")
Check_If_Blue_Screen_Exists()

Android.preset.Click()
sleep(3)
Android.preset7.Click()


Android.gonextarrow.Click()


############################################Audio########
Say("Checking for Blue Screen on Audio Camera")
Check_If_Blue_Screen_Exists()

Android.audioon.Click()

try:
    Android.audiooff.Click()
except:
    pass

Android.gonextarrow.Click()


############################################Full Screen########
Say("Checking for Blue Screen on Full Screen Camera")
Check_If_Blue_Screen_Exists()

Android.fullscreen.Wait()

####################################Go into full screen

Android.fullscreen.Click()
sleep(3)

Android.ClickWithXY(400,300)

sleep(3)

Android.gonextarrow.Click()


############################################Resolution########
Say("Checking for Blue Screen on Resolution Camera")
Check_If_Blue_Screen_Exists()

######Check Res

Android.highrez.Click()
Android.mediumrezmenu.Click()
Android.medrez.Click()
Android.lowrezmenu.Click()
Android.lowrez.Click()
Android.highrezinmenu.Click()



#Android.highres.Click()
#Android.mediuminner.Click()
#Android.medres.Click()
#Android.highinner.Click()
#Android.highres.Wait()
Android.gonextarrow.Click()


############################################All########
Say("Checking for Blue Screen on All Camera")
Check_If_Blue_Screen_Exists()

Android.allvidcontrols.Wait()

######Check Full
Android.fullscreen.Click()
sleep(3)
Android.ClickWithXY(400,300)
sleep(3)
######Check Res

Android.highrez.Click()

Android.mediumrezmenu.Click()

Android.medrez.Click()
Android.lowrezmenu.Click()

Android.lowrez.Click()
Android.highrezinmenu.Click()
Android.allvidcontrols.Wait()





Android.gonextarrow.Click()


############################################Res Low########
Say("Checking for Blue Screen on Res Low Camera")
Check_If_Blue_Screen_Exists()

Android.resisonlow.Wait()
Android.gonextarrow.Click()


############################################Res Med########
Say("Checking for Blue Screen on Res Med Camera")
Check_If_Blue_Screen_Exists()

Android.resisonmed.Wait()
Android.gonextarrow.Click()



############################################Res High########
Say("Checking for Blue Screen on High Camera")
Check_If_Blue_Screen_Exists()

Android.resisonhigh.Wait()
Android.gonextarrow.Click()


############################################DVR########
Say("Checking for Blue Screen on DVR Camera")
Check_If_Blue_Screen_Exists()

Android.dvrlogo.Click()

Android.dvrblockback.ClickAndRepeat(7)

Android.playvideo.Click()


####################

Android.alldvrcontrols.Wait()

#############Minus
try:
    Android.dvrminus.Click()
except:
    sleep(4)
    #################Remove when timeline fixed
    try:
        Android.ptime.Click()
        Android.dvrminus.Click()
    except:
        print('Faled TimeLine')
    
    
    
Android.dvrforward.Click()
Android.dvrminus.Click()
Android.dvrforward.Click()
#############Plus
try:
    Android.dvrplus.Click()
except:
    sleep(2)
    Android.dvrbigback.Click()
    sleep(2)
    Android.dvrplus.Click()
    
#############Middle
Android.dvrmiddle.Click()
#############Other
Android.dvrback.Click()
Android.dvrforward.Click()
Android.dvrpause.Click()
Android.skipbackdvr.Click()
Android.skipforward.Click()
Android.dvrforwardback.Click()
Android.dvrblockback.Click()
Android.dvrblockforward.Click()


##############################################DVR END

Android.gonextarrow3.Click()

##################################################Quad View


########################################################Right RIGHT RIGHT RIGHT

Android.shuddar.Click()
try:
    Android.homeicon.Click()
except:
    sleep(3)
    Android.shuddar.Click()
    Android.homeicon.Click()
Android.shuddar.Click()
Android.video.Click()
Android.videocameras.Click(xoffset = -500,yoffset = 200)

##################################################Next next next then back 5x#############
for t in range(2):
    
     ########################################################Right Right Right Right
    for i in range(16):
        Android.gonextarrow2.Click()
    
    ########################################################Left Left Left Left
    
    for i in range(16):
        Android.gobacktarrow2.Click()


for i in range(16):
        Android.gonextarrow2.Click()
        Check_If_Blue_Screen_Exists()

###############################################QUad Cam

#BUG
#Android.quadfour.ClickAndRepeat(amount_of_times = 5,yoffset = 150)
#Android.ClickWithXY(400,200)


####################################Add Relay Generic 3 
Configurator.Start()
Configurator.video.Click()
Configurator.videocamerassources.RightClickType('a')
try:
    AddNewDevice.Wait()
except:
    sleep(3)
    #theObject.RealClick()
    Configurator.videocamerassources.RightClickType('a') 
AddNewDevice.name.Wait()
sleep(1)
AddNewDevice.Type('Generic Relay Three')
AddNewDevice.ListView.Select(1,"Generic URL Video Camera")
AddNewDevice.Wait()
sleep(3)
Add.PushButton.Click("OK")
sleep(3)
#Configurator.Edit.SetText(5,camera_url_generic)
Configurator.url.RealClick(xoffset = 400)
for i in range(100):
    Press('backspace')
Configurator.Type(camera_url_generic)
##########


Configurator.ipaddress.RealClick(xoffset = 320)
Configurator.Press('backspace')
Configurator.Type(camera_ip)
###########################
#Configurator.Edit.SetText(11,generic_user)#fix
#Configurator.Edit.SetText(12,generic_Pasword)#fix
Configurator.username.RealClick(xoffset = 200)
Configurator.Type(generic_user)
#
Configurator.password.RealClick(xoffset = 200)
Configurator.Type(generic_Pasword)


##########

#Configurator.Edit.SetText(6,camera_ip)
#Configurator.Edit.SetText(8,generic_user)
#Configurator.Edit.SetText(9,generic_Pasword)
sleep(2)
Configurator.apply.Click()


Configurator.genericrelaythreehighlighted.Max()
Configurator.cameraoptions.Click(threshold=.92)
sleep(3)

Configurator.Edit.SetText(0,'Momentary')
Configurator.ComboBox.Select(0,2)
Configurator.ComboBox.Select(1,0)
Configurator.Edit.SetText(1,'Toggle')
Configurator.ComboBox.Select(2,3)
Configurator.ComboBox.Select(3,1)
Configurator.ComboBox.Select(3,1)
Configurator.apply.Click()
######################################Check Relay in Viewer

Configurator.CloseAndClean()

Android.shuddar.Click()


Android.fourcamallview.Click(xoffset=400,yoffset = 30)
Check_If_Blue_Screen_Exists()
Android.fullscreenmomentarytoggle.Wait()
sleep(3)
Android.momentaryvid.Click()
sleep(3)
Android.togglevid.Click()
Check_If_Blue_Screen_Exists()
Android.toggleactivated.Wait()

###############################Add Relay to All#################################
Configurator.Start()
Configurator.video.Click()
sleep(4)

Configurator.pallsource.Click()
Configurator.pallsourcehigh.Max()
Configurator.cameraoptions.Click(threshold=.92)
sleep(3)
Configurator.Edit.SetText(0,'Momentary')
Configurator.ComboBox.Select(0,2)
Configurator.ComboBox.Select(1,0)
Configurator.Edit.SetText(1,'Toggle')
Configurator.ComboBox.Select(2,3)
Configurator.ComboBox.Select(3,1)
Configurator.ComboBox.Select(3,1)
Configurator.apply.Click()

######################################Check All Relay in Viewer

Configurator.CloseAndClean()

Android.gobackarrow.Click()
Android.gobackarrow.Click()
Android.gobackarrow.Click()
Android.gobackarrow.Click()
Android.gobackarrow.Click()
Android.gobackarrow.Click()
Check_If_Blue_Screen_Exists()
sleep(3)
Android.momentaryvid.Click()
sleep(3)
Android.togglevid.Click()
Check_If_Blue_Screen_Exists()

######################################All Zoom in
Android.zoomin2.ClickAndRepeat(10)
Android.zoomout2.ClickAndRepeat(10)
Check_If_Blue_Screen_Exists()
###############Delete Generic Devices Crash
'''
Configurator.Start()
Configurator.video.Click()

Configurator.videocamerassources.RightClickType('a')
try:
    AddNewDevice.Wait()
except:
    sleep(3)
    #theObject.RealClick()
    Configurator.videocamerassources.RightClickType('a') 
AddNewDevice.name.Wait()
sleep(1)
AddNewDevice.Type('Generic Crash')
AddNewDevice.ListView.Select(1,"Generic URL Video Camera")
AddNewDevice.Wait()
sleep(3)
Add.PushButton.Click("OK")
sleep(3)
Configurator.Edit.SetText(5,camera_url_generic)



sleep(2)
Configurator.apply.Click()
Configurator.genericcrashhighlighted.RightClickType('d')
HlConfig.PushButton.Click('Yes')
try:
    HlConfig.Close()
except:
    pass
'''
############### End Delete Generic Devices Crash
################################################Delete All Cameras
Configurator.Start()
Configurator.video.Click()


sleep(5)
while True:
    if Configurator.pcam.Exists():
        Configurator.pcam.RightClickType('d')
        sleep(2)
        HlConfig.PushButton.Click('Yes')
        try:
            HlConfig.Close()
        except:
            pass
    else:
        print('doesnt exists')
        break

    
while True:
    if Configurator.gcam.Exists():
        Configurator.gcam.RightClickType('d')
        sleep(2)
        HlConfig.PushButton.Click('Yes')
        try:
            HlConfig.Close()
        except:
            pass
    else:
        print('doesnt exists')
        break    


Configurator.CloseAndClean()
##########################################################################
Configurator.Reset()
print('###################Finished########################')
