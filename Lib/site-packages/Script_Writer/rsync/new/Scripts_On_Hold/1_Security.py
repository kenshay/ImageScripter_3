from ImageScripter import *
from elan import *
from elan import functions
from pytank.Core import Settings

Settings.CaptureMode = False
V = Android

Viewer.Start()
Viewer.Close()
sleep(3)
ElanConnectPro.CloseWithX()
try:
    ElanConnectPro.CloseWithX()
except:
    pass

Configurator.SetTimeZone()
Configurator.Start()
Configurator.lighting.Click()
sleep(3)
Configurator.lightinginterfaces.RightClickType('a')

AddNewDevice.ListView.Select(1,"Virtual Lighting Device Controller")
AddNewDevice.PushButton.Click('OK')

Configurator.lightingdevices.RightClickType('a')
sleep(15)
#Froze in loop here
print('Start X10 Switch')
Add.ListBox.Select(0,'X10 Switch')
print('end X10 Switch')
if HlConfig.theparameterisincorrect.Exists():
    HlConfig.PushButton.Click('OK')
    try:
        Add.Close()
    except:
        pass
    Configurator.Close()
    Configurator.Start()
    Configurator.lighting.Click()
    sleep(3)
    Configurator.lightingdevices.RightClickType('a')
    sleep(15)
    #Froze in loop here
    print('Start X10 Switch')
    Add.ListBox.Select(0,'X10 Switch')
    print('end X10 Switch')
    if HlConfig.theparameterisincorrect.Exists():
        HlConfig.PushButton.Click('OK')
        
    sleep(3)
    #Configurator.lightingdevices.RightClickType('a')
    #sleep(3)
    Add.ListBox.Select(0,'X10 Switch')
sleep(3)
Add.PushButton.Click('OK')
sleep(3)
###############################Two
Configurator.security.Click()

Configurator.communicationdevices.RightClickType('a')
sleep(1)
Add.ListView.Select(1,'Standard Connection')
sleep(1)

try:
    Add.ListBox.Select(0,"Serial Port")
except:
    try:
        Configurator.CloseAndClean()
    except:
        pass
    try:
        ELAN.Close()
    except:
        pass
    try:
        Add.Close()
    except:
        pass
    try:
        Configurator.CloseAndClean()
    except:
        pass
    Configurator.Start()
    Configurator.security.Click()   
    Configurator.communicationdevices.RightClickType('a')
    sleep(5)
    Add.ListView.Select(1,'Standard Connection')
    sleep(3)
    try:
        Add.ListBox.Select(0,"Serial Port")
    except:
        sleep(5)
        Add.ListView.Select(1,'Standard Connection')
        sleep(3)
        Add.ListBox.Select(0,"Serial Port")
sleep(3)
Add.ComboBox.Select(0,0)
Add.ComboBox.Select(0,0)
sleep(1)
try:
    Add.PushButton.Click('OK')
except:
    sleep(3)
    try:    
        Add.PushButton.Click('OK')
    except:
        print("problem happened")
        Add.Close()
############################################
sleep(3)

Configurator.securitypanels.RightClickType('a')

Add.ListView.Select(1,"Virtual Security Controller")
Add.PushButton.Click('OK')
Configurator.discoverdevices.Click()
############################################

sleep(3)

Configurator.media.Click()
Configurator.security.Click()
sleep(3)
Configurator.communicationdevices.RightClickType('a')

try:
    Add.ListView.Select(1,'Standard Connection')
except:
    Configurator.communicationdevices.RightClickType('a')
    Add.ListView.Select(1,'Standard Connection')
sleep(1)
Add.ListBox.Select(0,"Serial Port")
sleep(1)
Add.ComboBox.Select(0,1)
sleep(1)
Add.ComboBox.Select(0,1)
sleep(1)
try:
    Add.PushButton.Click('OK')
except:
    
    Add.Close()
sleep(1)
########################################

Configurator.securitypanels.RightClickType('a')

sleep(1)
Add.ListView.Select(1,"Virtual Security Controller")
sleep(1)
Add.Edit.SetText(0,'V_security_2')
sleep(1)
Add.PushButton.Click('OK')
sleep(1)
Configurator.discoverdevices.Click()
#############################################
try:
    Configurator.doorlocks.RightClickType('a')
except:
    try:
        Configurator.Max()
        Configurator.doorlocks.RightClickType('a')
    except:
        Configurator.media.Click()
        Configurator.security.Click()
        sleep(1)
        Configurator.doorlocks.RightClickType('a')

Add.ListView.Select(1,"Virtual Door Lock")
sleep(1)
Add.ListView.Select(1,"Virtual Door Lock")
Add.PushButton.Click('OK')
sleep(1)

try:
    Configurator.Edit.SetText(0,'zwave')
except:
    Add.Close()
    Configurator.doorlocks.RightClickType('a')
    sleep(10)
    Add.ListView.Select(1,"Virtual Door Lock")
    sleep(1)
    Add.ListView.Select(1,"Virtual Door Lock")
    Add.PushButton.Click('OK')
    sleep(1)
    try:
        Add.Press('enter')
    except:
        pass
    ###############Failed here on edit zwave################
    try:
        Configurator.Edit.SetText(0,'zwave')
    except ValueError:
        Add.Close()
        sleep(10)
        Configurator.doorlocks.RightClickType('a')
        sleep(10)
        Add.ListView.Select(1,"Virtual Door Lock")
        sleep(1)
        Add.ListView.Select(1,"Virtual Door Lock")
        Add.PushButton.Click('OK')
        sleep(1)
        try:
            Add.Press('enter')
        except:
            pass
        sleep(10)
        #Broke here
        for i in range(100):
            try:
                Configurator.Edit.SetText(0,'zwave')
                break
            except:
                print(" Configurator.Edit.SetText(0,'zwave')")
                print(str(i))
                sleep(1)
                if i == 98:
                    raise ValueError("Configurator.Edit.SetText(0,'zwave')")
            

    # Broke here Configurator.Edit.SetText(0,'zwave')
sleep(3)
Configurator.apply.Click()
sleep(1)
####################################
Configurator.doorlocks.RightClickType('a')

Add.ListView.Select(1,"Virtual Door Lock")
sleep(1)

Add.PushButton.Click('OK')
sleep(1)

Configurator.Edit.SetText(0,'2nd_door_lock')
sleep(1)

Configurator.apply.Click()
sleep(1)

#######################################
Configurator.doorlocks.RightClickType('a')

Add.ListView.Select(1,"Virtual Door Lock")
sleep(1)
Add.PushButton.Click('OK')
sleep(1)
Configurator.Edit.SetText(0,'3rd_door_lock')
sleep(1)
Configurator.apply.Click()
sleep(1)
########################################

Configurator.doorlockgroups.RightClickType('a')

Add.Edit.SetText(0,'group one')
Add.PushButton.Click('OK')
##############################

Configurator.zwavelocktab.Click()
Configurator.addtab.Click()
Configurator.apply.Click()
###################################

Configurator.doorlockgroups.RightClickType('a')
Add.Edit.SetText(0,'group two')
Add.PushButton.Click('OK')
##################################
sleep(3)

Configurator.seconddoorlocktab.Click()

try:
    Configurator.addtab.Click()
except:
    Configurator.interface.Click()
    sleep(3)
    Configurator.tp12.Max()
    Configurator.pagelayoutsecuritysystem.Click()
    Configurator.seconddoorlocktab.Click()
    Configurator.addtab.Click()

sleep(2)    
Configurator.thirddoorlocktab.Click()

Configurator.addtab.Click()
Configurator.apply.Click()

####################################
Configurator.doorcontrols.RightClickType('a')

Add.Edit.SetText(0,'doorlockcontrol')
Add.PushButton.Click('OK')
sleep(3)

Configurator.ComboBox.Select(0,1)
Configurator.ComboBox.Select(0,0)
Configurator.apply.Click()
######################################
####################################
Configurator.doorcontrols.RightClickType('a')
Add.Edit.SetText(0,'IO Momentary Control')
Add.ComboBox.Select(0,1)
Add.PushButton.Click('OK')

sleep(3)
Configurator.ComboBox.Select(0,1)
Configurator.ComboBox.Select(1,1)
Configurator.ComboBox.Select(0,1)
Configurator.ComboBox.Select(1,1)
Configurator.apply.Click()
####################################

Configurator.doorcontrols.RightClickType('a')
sleep(3)
Add.Edit.SetText(0,'IO Toggle Control')

Add.ComboBox.Select(0,2)
Add.ComboBox.Select(0,2)

Add.PushButton.Click('OK')
Configurator.ComboBox.Select(0,1)
Configurator.ComboBox.Select(0,1)
Configurator.ComboBox.Select(1,1)
Configurator.ComboBox.Select(1,1)
Configurator.apply.Click()
######################################
Configurator.doorcontrols.RightClickType('a')
Add.Edit.SetText(0,'Lighting Control')
Add.ComboBox.Select(0,3)
Add.PushButton.Click('OK')

sleep(3)
Configurator.ComboBox.Select(0,0)
Configurator.ComboBox.Select(0,0)
Configurator.apply.Click()
####################################
Configurator.doorcontrols.RightClickType('a')
Add.Edit.SetText(0,'Sec Zone Output Toggle Control')
Add.ComboBox.Select(0,4)
Add.PushButton.Click('OK')

sleep(3)

Configurator.ComboBox.Select(0,1)
Configurator.ComboBox.Select(0,1)
Configurator.ComboBox.Select(1,1)
Configurator.ComboBox.Select(1,1)
Configurator.apply.Click()
######################################

sleep(4)
Configurator.media.Click()
sleep(4)
Configurator.security.Click()
sleep(4)
sleep(2)
#Foun bug
try:
   Configurator.scrolldown.Click()
except:
   pass

Configurator.custompages.RightClickType('a')

sleep(3)
Add.PushButton.Click("OK")
Configurator.Edit.SetText(0,"Security Custom Page")
Configurator.apply.Click()
####################################
Configurator.media.Click()
Configurator.security.Click()

#bug
try:
   Configurator.scrolldown.Click()
except:
   pass

while Configurator.min.Exists():
    try:
        sleep(1)
        Configurator.min.Click()
    except:
        pass
    sleep(1)


sleep(6)

try:
    Configurator.custompages.Max()
except:
    Configurator.custompageshighlighted.Max()
sleep(3)
try:
    Configurator.securitycustompage.Max()
except:
    Configurator.media.Click()
    Configurator.security.Click()
    Configurator.custompages.Max()
    Configurator.securitycustompage.Max()






Configurator.largeformat.Click()
####################################

sleep(2)
Configurator.custompagelayoutblack.RightClickType('a')

Add.ListBox.Select(0,'Door Lock')
Add.Edit.SetText(0,'DoorLockCustomControl')
Add.PushButton.Click('OK')
#############################

sleep(3)
try:
    Configurator.dooctockcustomcontrol2.RightClickType('s')
except:
    #Failed here
    try:
        Configurator.DoorLockCustomControl.RightClickType('s')
    except:
        sleep(2)
        Configurator.DoorLockCustomControl3.RightClickType('s')
    

Door.ComboBox.Select(2,'zwave')
Door.Close()
####################################

Configurator.custompagelayoutblack.RightClickType('a')    
Add.ListBox.Select(0,'Door Lock Secure All Button')
Add.Edit.SetText(0,'Secure All Button')
Add.PushButton.Click('OK')
sleep(3)
if Configurator.secureallbutton.Exists() == True:
    pass
else:
    Configurator.custompagelayoutblack.RightClickType('a')    
    Add.ListBox.Select(0,'Door Lock Secure All Button')
    Add.Edit.SetText(0,'Secure All Button')
    sleep(1)
    Add.ok.Click()
    sleep(3)


###########################
Configurator.custompagelayoutblack.RightClickType('a')

Add.ListBox.Select(0,'Door Lock Unsecure All Button')
Add.Edit.SetText(0,'Unsecure All Button')
Add.PushButton.Click('OK')
###########################
#RESIZE MISSING

############################

while Configurator.min.Exists():
    try:
        sleep(1)
        Configurator.min.Click()
    except:
        print('min failed')
        pass
    sleep(1)
sleep(3)

#########################################Group one

Configurator.interfacegroups.RightClickType('a')
Add.Edit.SetText(0,'group 1')
Add.PushButton.Click("OK")




sleep(2)


Configurator.houseitem.Click()
Configurator.addtab.Click()

Configurator.garageitem.Click()
Configurator.addtab.Click()

Configurator.houseitem.Click()
Configurator.addtab.Click()

Configurator.garageitem.Click()
Configurator.addtab.Click()
try:
    Configurator.apply.Click()
except:
    Configurator.garageitem.Click()
    Configurator.addtab.Click()
    Configurator.apply.Click()
    

##################################

Configurator.interfacegroups.RightClickType('a')

Add.Edit.SetText(0,'group 2')
Add.PushButton.Click("OK")
###############################

Configurator.zwaveitem.Click()
Configurator.addtab.Click()

Configurator.seconddoorlockitem.Click()
Configurator.addtab.Click()

Configurator.thirddoorlockitem.Click()
Configurator.addtab.Click()

Configurator.grouponeitem.Click()
Configurator.addtab.Click()

Configurator.grouptwoitem.Click()
Configurator.addtab.Click()



Configurator.securitycustompageitem.Click()
Configurator.addtab.Click()

Configurator.doorlockcontrolitem.Click()
Configurator.addtab.Click()

Configurator.iomomentarycontrolitem.Click()
Configurator.addtab.Click()

Configurator.iotoggleitem.Click()
Configurator.addtab.Click()

Configurator.lightingcontrolitem.Click()
Configurator.addtab.Click()

Configurator.seczoneoutputtogglecontrolitem.Click()
Configurator.addtab.Click()

Configurator.apply.Click()
###################################

Configurator.interface.Click()
sleep(2)
Configurator.tp12.Max()
##################################

Configurator.pagelayoutsecuritysystem.Click()


Configurator.thirddoorlocktab.Click()
Configurator.removetab.Click()

Configurator.housetab.Click()


Configurator.seconddoorlocktab.Click()
Configurator.removetab.Click()
Configurator.housetab.Click()

Configurator.zwavetab.Click()
Configurator.removetab.Click()
Configurator.housetab.Click()
Configurator.apply.Click()



Configurator.tabsetup.Wait(threshold = .90)





for i in range(10):
    Configurator.availablepages.Click(yoffset=30)
    Configurator.addtab.Click()
Configurator.apply.Click()

####################################
Configurator.system.Click()
#################################
#Change part names

Configurator.security.Click()
sleep(3)

Configurator.virtualsecuritycontrolerandzones.ClickPip(Configurator.housepart)

sleep(2)
Configurator.Edit.SetText(0,'HouseONE')
Configurator.apply.Click()
Configurator.system.Click()
Configurator.security.Click()
sleep(3)

Configurator.virtualsecuritycontrollerhouseonegarage.ClickPip(Configurator.garage)

sleep(3)

Configurator.Edit.SetText(0,'GarageONE')
Configurator.apply.Click()
Configurator.system.Click()
##############################################################

Configurator.RestartHard()


try:
    ElanConnectPro.CloseAndClean()
except:
    pass
#################################VIEWER#########################

################################disable doorlockpassword
functions.Turn_On_TP12()

V.settingswheel.Click()
V.one.Click()
V.two.Click()
V.three.Click()

V.four2.Click()
###################
V.doorlocksettings.Click()
V.zwavelock.Click()

V.elaninterfacecodedisable.Click()
########################

V.seconddoorlocksetting.Click()
V.elaninterfacecodedisable.Click()
########################
V.thirddoorlocksetting.Click()
V.elaninterfacecodedisable.Click()

########################

V.elanlog.Click()
#######################################################################################

V.security.Click()

#V.allaredisarmed.SetThreshold(60)
#stopped here on all disarmed
V.allaredisarmed.Wait()
                                                #House ONe
V.houseone2.Click()
V.stay.Click()
V.one.Click()
V.two.Click()
V.three.Click()

V.four.Click()
V.enter.Click()
V.armed.Wait()
############################House 2########################
V.nextsecpart.Click()
V.stay.Click()
V.one.Click()
V.two.Click()
V.three.Click()
V.four.Click()
V.enter.Click()

V.armed.Wait()

#################################House 3########
V.nextsecpart.Click()
V.away.Click()

V.one.Click()
V.two.Click()
V.three.Click()
V.four.Click()
V.enter.Click()

V.armed.Wait()
################################House4#########

V.nextsecpart.Click()
V.away.Click()
V.one.Click()
V.two.Click()
V.three.Click()
V.four.Click()
V.enter.Click()
V.armed.Wait()

################################################
V.shuddar.Click()

V.allarearmed.Wait()
#==============================================================================
# 
#==============================================================================

V.houseone.Click()
V.disarm.Click()
V.one.Click()
V.two.Click()
V.three.Click()
V.four.Click()
V.enter.Click()

V.readytoarm.Wait()

#==========================================2=garage one=============================
V.nextsecpart.Click()
V.disarm.Click()
V.one.Click()
V.two.Click()
V.three.Click()
V.four.Click()
V.enter.Click()
V.readytoarm.Wait()
#============================================3 House==========================
V.nextsecpart.Click()
V.disarm.Click()
V.one.Click()
V.two.Click()
V.three.Click()
V.four.Click()
V.enter.Click()
V.readytoarm.Wait()
#===========================================4garage=============================
V.nextsecpart.Click()
V.disarm.Click()
V.one.Click()
V.two.Click()
V.three.Click()
V.four.Click()
V.enter.Click()
V.readytoarm.Wait()
###################################################
V.shuddar.Click()
V.allaredisarmed.Wait()
#############################################

V.houseone.Click()

V.houseonepagelooksgood.Wait()

V.middleshutter.Click()
##########################################
V.frontdoorbackdoorfirstfloormotionsideentrance.Wait()

####################################
V.gotosecurityhistor.Click()

V.securitypagelooksgood44.Wait()

######################################
V.zoomin.Click()
V.zoomin.Click()
V.zoomin.Click()
V.zoomin.Click()
#####################################
V.secnavleft.Click()
V.secnavright.Click()
######################################
V.zoomout.Click()
V.zoomout.Click()
V.zoomout.Click()
V.zoomout.Click()

######################################Part 2
#######################################################################
V.nextsecpart.Click()
V.allzonesreadypagelooksgood.Wait()
##########################################

V.zonelistpage.Click()
V.sideentrancegaragedoorlooksgood.Wait()

####################################
V.gotosecurityhistor.Click()

V.securitypage2looksgood.Wait()
######################################
V.zoomin.Click()
V.zoomin.Click()
V.zoomin.Click()
V.zoomin.Click()

#####################################
V.secnavleft.Click()
V.secnavright.Click()
######################################
V.zoomout.Click()
V.zoomout.Click()
V.zoomout.Click()
V.zoomout.Click()

######################################
######################################Part 3
#################################HOUSE######################################
V.nextsecpart.Click()
V.allzonesreadypagelooksgood.Wait()
##########################################
V.zonelistpage.Click()
V.frontdoorbackdoorfirstfloormotionsideentrancelooksgood.Wait()
####################################
V.gotosecurityhistor.Click()
V.securitypagelooksgood3.Wait()
######################################
V.zoomin.Click()
V.zoomin.Click()
V.zoomin.Click()
V.zoomin.Click()
#####################################
V.secnavleft.Click()
V.secnavright.Click()
######################################
V.zoomout.Click()
V.zoomout.Click()
V.zoomout.Click()
V.zoomout.Click()
######################################
######################################
######################################Part 4
##########################################GARAGe#############################
V.nextsecpart.Click()
V.allzonesreadypagelooksgood.Wait()
##########################################
V.zonelistpage.Click()
V.sideentrancegaragedoorlooksgood.Wait()

####################################

sleep(3)
V.gotosecurityhistory.Click()
V.securitypagelooksgood4.Wait()



######################################
V.zoomin.Click()
V.zoomin.Click()
V.zoomin.Click()
V.zoomin.Click()
#####################################
V.secnavleft.Click()
V.secnavright.Click()
######################################
V.zoomout.Click()
V.zoomout.Click()
V.zoomout.Click()
V.zoomout.Click()
######################################
###################################################CustomPage##########################End of part


V.shuddar.Click()

V.securitycustompage.Click()
sleep(3)
#V.custompagelooksgoodunsecureallsecureall.Wait()
####################################################

V.smalllock.Click()
V.doorislocked.Wait()
V.unlocaksmall.Click()
V.doorisunlocked.Wait()
V.smalllock.Click()

V.doorislocked.Wait()
##################################
V.unsecureallbutton.Click()
V.doorisunlocked.Wait()
############################
V.secureallbutton.Click()
V.doorislocked.Wait()
##################################
###########################################Make doorlock Vis
V.shuddar.Click()
V.homeicon.Click()


Configurator.Start()
Configurator.interface.Click()

sleep(3)

Configurator.interfacetp12.Max()
Configurator.pagelayoutsecuritysystem.Click()

#########################################
for i in range(15):
    Configurator.selectedpages.Click(yoffset=30)
    Configurator.removetab.Click()
Configurator.zwavepage.Click()
Configurator.addtab.Click()    

Configurator.seconddoorlockpage.Click()
Configurator.addtab.Click()   

Configurator.thirddoorlockpage.Click()
Configurator.addtab.Click()

Configurator.grouponepage.Click()
Configurator.addtab.Click()

Configurator.grouptwopage.Click()
Configurator.addtab.Click()
sleep(5)

Configurator.apply.Click()
sleep(5)
Configurator.media.Click()
Configurator.interface.Click()

sleep(3)
Configurator.interfacetp12.Max()
Configurator.pagelayoutsecuritysystem.Click()

Configurator.zwave2nddoorock3rddoorockgrouponegrouptwo.Wait()
Configurator.CloseAndClean()
###############################################Setup Done
#########################doorlock

if V.shuddar.Exists():
    V.shuddar.Click()
        
V.security.Click()

V.zwavedoorlock.Click()

V.verifiylockpage.Wait()
V.unlock.Click()
V.unlocked.Wait()
V.lock.Click()
try:
    V.locked.Wait()
except:
    V.lock.Click()
    V.locked.Wait()        
#############################
V.nextdoorlock.Click()
V.verifiylockpage.Wait()

V.unlock.Click()
V.unlocked.Wait()
V.lock.Click()
V.locked.Wait()

sleep(2)
#######################################Lock  group page one
V.shudder2.Click()

V.groupone.Click()
#####################
V.logpage.Click()

V.logpagelooksgood.Wait()

##########################
V.unlocklogpage.Click()
V.grouppageunlocked.Wait()

V.locklogpage.Click()
V.grouppagelocked.Wait()

#######################################Lock  group page two

V.nextgroup.Click()

Configurator.Reset()

print("Finished")

#####################
#V.logpageone.Click()
#V.logpageonelooksgood.Wait()
##########################
#V.unlockone.Click()
#V.grouppageoneunlocked.Wait()
#V.lockone.Click()
#V.grouppageonelocked.Wait()
##############################

#V.logpagetwo.Click()
#V.logpagetwolooksgood.Wait()
##########################
#V.unlocktwo.Click()
#V.grouppagetwounlocked.Wait()
#V.locktwo.Click()
#V.grouppagetwolocked.Wait()
##########################
#V.unlockallgrouppage.Click()
#V.groupunlocked.Wait()
#V.lockallgrouppage.Click()
#V.grouplocked.Wait()
###################################history
#V.historypageicon.Click()
#V.historypagelooksgood.Wait()
#V.zoomin.Click()
#V.arrowleft.Click()
#V.arrowright.Click()
#V.zoomout.Click()
##################################################OverView
#V.shuddar.Click()
################################
#Overview page:
#o	Click lock zwave
#o	Verify
#o	Click unlock zwave
#o	Verify
#o	Repeat for virtual
#o	Click-slide to activate each door control
 
