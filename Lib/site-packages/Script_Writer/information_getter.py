from Script_Writer.variable_file_getter import Variable_File_Getter
import os
from copy import copy
Applications_Path = Variable_File_Getter.getVariableFromFile('Applications_Folder_Location')
print(Applications_Path)
List_Of_Commands = ['Click','RightClick','Wait','WaitVanish']
List_Of_Application_Commands = ['Close','Min','Max','CloseAndClean','Start']
class Information_Getter_Class():
    def __init__(self):
        pass

    def get_list_of_completes(self):
        List_OF_Completes = []
        List_Of_Applications = os.listdir(Applications_Path)
        List_Of_Applications = [x for x in List_Of_Applications if x != '.png']
        for App in List_Of_Applications:
            try:
                os.chdir(Applications_Path)
                os.chdir(App)
                List_Of_Images = os.listdir()
                List_Of_Images = [x for x in List_Of_Images if x.endswith('.png')]
                List_Of_Images = [x for x in List_Of_Images if '_' not in x]
                for image in List_Of_Images:
                    image = image.strip('.png')
                    for command in List_Of_Commands:
                        List_OF_Completes.append(App + '.' + image + '.' + command)
            except Exception as e:
                print(e)
        for App in List_Of_Applications:
            for command in List_Of_Application_Commands:
                List_OF_Completes.append(App + '.' + command)
                print(App + '.' + command)




        return List_OF_Completes

    def get_list_of_Applications(self):
        List_OF_Completes = []
        List_Of_Applications = os.listdir(Applications_Path)
        List_Of_Applications = [str(x) for x in List_Of_Applications if x != '.png']
        return List_Of_Applications


    def get_full_image_path(self,app,image):
        image = image + '.png'
        curDur = os.getcwd()
        os.chdir(str(Applications_Path))
        os.chdir(str(app))
        path = os.path.abspath(image)
        os.chdir(curDur)
        return path

    def get_full_app_path(self,app):
        curDur = os.getcwd()
        os.chdir(str(Applications_Path))
        path = os.path.abspath(str(app))
        os.chdir(curDur)
        return path


    def get_full_applications_folder_path(self):
        #curDur = os.getcwd()
        #os.chdir(str(Applications_Path))
        path = os.path.abspath(str(Applications_Path))
        #os.chdir(curDur)
        return path




#import os
#os.chdir(r"C:\ImageScripter_2\Lib\site-packages\elan\Applications_And_Devices\addnew")
#print(os.listdir())

Information_Getter = Information_Getter_Class()
Information_Getter.get_list_of_completes()
#Information_Getter = Information_Getter_Class()
#app = 'Configurator'
#image = 'media'
#print(Information_Getter.get_full_image_path(app))
#print(Information_Getter.get_full_applications_folder_path())