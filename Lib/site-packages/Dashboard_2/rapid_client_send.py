
import time
import multiprocessing
import random

def worker():
    import socket
    from paths import Dashboard_Server_IP,Dashboard_Server_PORT
    import traceback
    import pickle
    import os
    path = 'C:\Eluminate\Projects\_elan_\elan\Applications_And_Devices\Configurator'
    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as server:
        print('Connecting to Server, ',Dashboard_Server_IP)
        print('Connecting to Port, ',Dashboard_Server_PORT)
        server.connect((Dashboard_Server_IP, Dashboard_Server_PORT))
        print('Connected to Server')
        os.chdir(path)
        List = os.listdir()
        while True:
            img = random.choice(List)
            with open(img, 'rb') as f:
                picture = f.read()
            Info_Dictionary = dict([('name', 'ken'), ('password', 'shayshay'), ('picture', picture)])
            Info_Dictionary_Pickled = pickle.dumps(Info_Dictionary)
            server.sendall(Info_Dictionary_Pickled)
            time.sleep(1)
if __name__ == '__main__':
    jobs = []
    for i in range(4):
        p = multiprocessing.Process(target=worker)
        jobs.append(p)
        p.start()
        time.sleep(5)