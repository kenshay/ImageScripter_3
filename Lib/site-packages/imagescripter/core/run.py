from elan import *
from elan import *
import os

path = r"C:\ImageScripter_2\Lib\site-packages\elan\lang_default_for_script.xml"
old_text = r"C:\ImageScripter_2\Lib\site-packages\elan\old_lang_default_for_script.txt"	

Configurator.Start()
Configurator.language.Click()
Configurator.export.Click()
try:
	os.remove(path)
except Exception as e:
	print(e)

window = SaveAs.getWindow()
window.edit.wait('visible')
window.edit.set_text(path)

Sleep(5)
window.Save.click()
Press('enter')
#window = ConfirmSaveAs.getWindow()
#window.yes.wait('visible')
#window.yes.Click()
Sleep(5)

try:
	with open(path,'r') as f:
		text = f.read()
except:
	Sleep(10)
	with open(path,'r') as f:
		text = f.read()
###############################This is for fixing the script when changes happen. Keep Commented out or test is useless##########
#with open(old_text,'w') as f:
#	f.write(text)
#############################################################################################
with open(old_text,'r') as f:
	old_text = f.read()	

if old_text != text:
		print('diff')
		#List1 = list(old_text)
		#List2 = list(text)
		#a = list(set(List1) - set(List2))
		#b = list(set(List2) - set(List1))
		#string = ''
		#string = string + str(a)
		#string = string + '\\n'
		#string = string + str(b)
		import difflib
		output_list = str([li for li in difflib.ndiff(old_text,text) if li[0] != ' '])
		output_list2 = str([li for li in difflib.ndiff(text,old_text) if li[0] != ' '])
		string = ''
		string = string + output_list
		string = string + '\\n'
		string = string + output_list2	
		#print(path)
	    #print(old_text)
		raise ValueError(string)
else:
	print('Old and New Language files are still the same, test passed')
	print(path)
	print(old_text)
	