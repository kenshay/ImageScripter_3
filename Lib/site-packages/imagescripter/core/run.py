from imagescripter import *
import shutil
import os
from datetime import datetime
from imagescripter import *

try:
	Display_Text('Creating Database backup')
	Name_File = r"C:\Eluminate\Projects\_elan_\Settings\File_Name_Backup.txt"
	try:
		with open(Name_File,'r') as f:
			test = f.read()
	except:
		with open(Name_File,'w') as f:
			f.write('new')

	database_folder = r"C:\Eluminate\Projects\_elan_\Settings\Database_Backups"
	if not os.path.exists(database_folder):
		os.makedirs(database_folder)
	lastdir = os.getcwd()
	os.chdir(database_folder)
	def getTime():
		from datetime import date
		year_ = str(date.today().year)
		now = datetime.now()
		now = str(now.strftime("%c"))
		print(now)
		now = now.replace('/','_')
		print(now)
		now = now.replace(':','-')
		print(now)
		now = now.replace(' ','_')
		now = now.replace('__','_')
		print(now)
		list = now.split('_')
		return "Database_Backup_" + '_' + list[1] + '_' + list[2] + '_' + year_
		#return now.strftime('%I:%M:%S')
	src = r"\\172.16.43.21\nas\Reports\Databases"
	print('name_of_file')
	name_of_file = getTime()
	try:
		Display_Text('Trying to Create Database backup for ' + name_of_file)
		print("Starting Cloud Backup")
		shutil.copytree(src, name_of_file)
		print('Finished Backup of Cloud')
		Display_Text('Finished Database backup for ' + name_of_file)
	except WindowsError:
		print('Backup Already Completed Today')
		Display_Text('Backup Already Completed Today for ' + name_of_file)
		pass
except Exception as e:
	Display_Text(str(e))