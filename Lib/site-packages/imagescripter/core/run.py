from elan import *
from elan import *
Start_Image_Show()
#DONE1
GetBackTOHomeScreenITP8()
Itp8.climate.Click()
Sleep(2)
Itp8.climatemiddletop.Wait()
Sleep(2)
if Itp8.climateoffline.Exists() == True:
    raise ValueError("Exception 7, a Thermostat appears to be offline!")
else:
    pass
##############################################################
d = 0
for x in range(100):
    try:
        Itp8.righttermostatcustompage.Click()
        Sleep(2)
        Itp8.righttermostatcustompagepage.Wait()
        Sleep(2)
        break
    except:
        d += 1
        if d >= 60:
            raise ValueError('Something went wrong with climate')
        Itp8.climatehighlighted.Click()
        Sleep(2)
        Itp8.climate.Click()
        Sleep(2)
Itp8.settocoolmode.Click()
Sleep(2)
Itp8.setcoolto99.Click()
Sleep(2)
Itp8.setfantoauto.Click()
Sleep(2)
Itp8.shudder.Click()
Sleep(2)
try:
    Itp8.cool99updown.Wait(threshold = .95,seconds = 10)
    Sleep(2)
except:
    Itp8.righttermostatcustompage.Click()
    Sleep(2)
    Itp8.setcoolto99.Click()
    Sleep(2)
    Itp8.shudder.Click()
    Sleep(2)
    Itp8.cool99updown.Wait(threshold=.95, seconds=10)
    Sleep(2)
Sleep(2)
Itp8.rightthermostat.Click()
Sleep(2)
Itp8.bigcoolsetto99.Wait(threshold = .92)
Sleep(2)
Itp8.shudder.Click()
Sleep(2)
Itp8.climatehighlighted.Click()
Sleep(2)
print("Finished")
Close_Image_Show()