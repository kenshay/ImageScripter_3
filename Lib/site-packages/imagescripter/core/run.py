from imagescripter import *
from imagescripter import *
from imagescripter import *
###############DELTE ME################
Configurator.Reset(start=True)
########################################
try:
	Configurator.Start()
except:
	try:
		Ecp.Close()
	except:
		pass
	try:
		ElanConnectPro.Close()
	except:
		pass
	Sleep(100)
	Configurator.Start()
##Global Cache
Configurator.inputoutput.Click()
Sleep(3)
Configurator.communicationdevices.RightClickType('a')
Sleep(5)
Add.ListView.Select(0,'GlobalCache GC-100, iTach')
Sleep(3)
Add.PushButton.Click('OK')
Sleep(3)
Press('enter')
Sleep(3)
Configurator.Edit.SetText(4,'107')
Sleep(3)
Configurator.apply.Click()
Sleep(3)
Configurator.discoverdevices.Click()
Configurator.irlist.Wait()
Sleep(3)
Configurator.media.Click()
Sleep(5)
Configurator.zonecontrollers.RightClickType('a')
Add.devicetype.Wait()
Add.ListView.Select(1,'ELAN EL-IPD  Dante')
Sleep(5)
Add.PushButton.Click('OK')
Configurator.okgreen123.Wait(seconds = 20)
Configurator.discoverdantedevices.Wait()
Configurator.discoverdantedevices.Click()
Configurator.searchingbar.Wait()
Configurator.searchingbar.WaitVanish()
try:
	Configurator.devicesarethere.Wait()
except:
	Configurator.discoverdantedevices.Click()
	Configurator.devicesarethere.Wait()
	
Sleep(10)
#Configurator.zones34234.Max()
#Sleep(4)
#try:
#	Configurator.ampextzoneone.Click()
#except:
#	Configurator.zonecontrollers.Max()
#	try:
#		Configurator.zones34234.Wait()
#	except:
#		try:
#			Configurator.ampextzoneone.Wait(seconds = 10)
#		except:
#			Configurator.zoneshighlighted.Max()
		
Configurator.zones34234.Max()
Configurator.ampextzoneone.Wait()
Configurator.ampextzoneone.Click()
	
Sleep(3)
Configurator.Edit.SetText(0,'AMP-EXT Zone 1')
Sleep(3)
Configurator.apply.Click()
####################
try:
	Configurator.sources444.RightClickTypeThenPress('aaaaaaa','enter')
except:
	Configurator.communicationdevices.RightClickTypeThenPress('aaaaaaa','enter',xoffset=-48,yoffset=19)
Sleep(3)
Import.Edit.SetText(0,'Toshiba')
Import.ComboBox.Select(0,'Toshiba')
Import.ComboBox.Select(1,'DVD')
Import.ComboBox.Select(2,'Code Group 2')
Import.PushButton.Click('OK')
Press('enter')
Configurator.ComboBox.Select(3,'IR Output 2:1')
Configurator.apply.Click()
Configurator.elanelipdmultichassis.Click()
Sleep(3)
Configurator.Edit.SetText(0,'ELAN EL-IPD Dante')
Configurator.apply.Click()
Configurator.videodisplays.Click()
Sleep(10)
try:
	Configurator.elanelipddante.Click(xoffset=-84,yoffset=21,seconds = 5)
except:
	try:
		Configurator.zonecontrollers.Max()
		Configurator.elanelipddante.Click(xoffset=-84,yoffset=21,seconds = 5)
	except:
		#Configurator.zonessdf4564.Max()
		Configurator.elanelipddante.Click(threshold = .90,xoffset=-84,yoffset=21,seconds = 5)
Configurator.pressi81e308.Click()
Configurator.sidesettings.Wait()
Configurator.ComboBox.Select(0,'Interface: Toshiba')
Sleep(5)
Configurator.apply.Click()
Sleep(20)
########################MTX-8CH############
Configurator.zonecontrollers.RightClickType('a')
Add.ListView.Select(1,'ELAN EL-IPD Standalone')
Sleep(5)
Add.searchfordevices.Click()
##########################################################################Here###############
try:
	Add.elipdmtx8ch.Wait(seconds = 20)
except:
	Sleep(2)
	HlConfig.Close()
	Sleep(2)
	Add.searchfordevices.Click()
	Sleep(2)
	Add.elipdmtx8ch.Wait(seconds = 20)
	Sleep(2)
	
Add.elipdmtx8ch.Click()
Add.PushButton.Click('OK')
try:
	Configurator.okgreen123.Wait()
except:
	try:
		Configurator.zonecontrollers.Click()
	except:
		ElanConnectPro.CloseAndClean()
		Configurator.Start()
		Configurator.media.Click()
		Sleep(2)
		Configurator.zonecontrollers.Max()
		
	Configurator.elanelipdmtx8ch.Click()
	Configurator.okgreen123.Wait()
Configurator.elanelipdmtx8chhighlighted.Click(xoffset=-91,yoffset=42)
Sleep(3)
Configurator.zoneone1.Click()
Sleep(3)
Configurator.Edit.SetText(0,'MTX-8CH Zone 1')
Sleep(3)
Configurator.apply.Click()
Sleep(10)
####################PRE MSI#########################
Configurator.zonecontrollers.RightClickType('a')
Add.devicetype.Wait()
Add.ListView.Select(1,'ELAN EL-IPD Standalone')
Sleep(5)
Add.searchfordevices.Click()
try:
	Add.elanpremsi.Wait(seconds = 20)
except:
	Sleep(2)
	HlConfig.Close()
	Sleep(2)
	Add.searchfordevices.Click()
	Sleep(2)
	Add.elanpremsi.Wait(seconds = 20)
	Sleep(2)
Add.elanpremsi.Click()
Add.PushButton.Click('OK')
Configurator.okgreen123.Wait()
Configurator.elanelipdpremsihighlighted.Click(xoffset=-89,yoffset=39)
Sleep(3)
Configurator.zoneone1.Click()
Sleep(3)
Configurator.Edit.SetText(0,'PRE MSI Zone 1')
Sleep(3)
Configurator.apply.Click()
############################ADD SOURCES####################
########################################MTX 8CH
Configurator.climate.Click()
Configurator.media.Click()
try:
	Configurator.elanelipdmtx8ch.Click(xoffset=-96,yoffset=20)
except:
	Configurator.zonecontrollers.Max()
	Configurator.elanelipdmtx8ch.Click(xoffset=-96,yoffset=20)
Configurator.analog1.Click()
Configurator.ComboBox.Select(0,6)
Configurator.apply.Click()
########################################Pre msI
Configurator.climate.Click()
Configurator.media.Click()
Configurator.elanelipdpremsi.Click(xoffset=-96,yoffset=20)
Configurator.analog1.Click()
Configurator.ComboBox.Select(0,7)
Configurator.apply.Click()
###############################################################
###########################################
Configurator.interface.Click()
Sleep(4)
Configurator.default.Max()
Configurator.pagelayoutmediasystem.Click()
Configurator.selectedpages.Click(xoffset=7,yoffset=21)
for i in range(25):
	print(i,'-',25)
	Configurator.removetab.Click()
################################
Configurator.tabampzone1.Click()
Configurator.addtab.Click()
Configurator.apply.Click()
######################################
################################
Configurator.tabmtx8chzone1.Click()
Configurator.addtab.Click()
Configurator.apply.Click()
######################################
################################
Configurator.tabpremsizone1.Click()
Configurator.addtab.Click()
Configurator.apply.Click()
######################################
Configurator.CloseAndClean()
Viewer.Start()
Viewer.media3items.Click()
Viewer.CloseAndClean()