from imagescripter import *
from paths import *
from imagescripter import *
from elan.ssh_manager import SSH_Manager_Class
from imagescripter.core.variable_file_getter import Variable_File_Getter
if Controller_Type != 'SC100':
	raise ValueError('You need to program this to work with a non SC100 controller')
#####################################################################################
IP = Variable_File_Getter.getVariableFromFile('Controller_IP')
Port = int(Elan_Controller_Port)
User = Elan_Controller_User_Name
Password = Elan_Controller_Password
SSH_Manager = SSH_Manager_Class(ipaddress=IP, port=Port, username=User, password=Password)
List  = SSH_Manager.get_list_folder_contents('../ELAN/LOG/')
Group_Of_Messages = ''
for the_file in List:
	if 'system_log' in the_file:
		FAIL = True
		path = '/ELAN/LOG/' + the_file
		Date_Modified = 'ERROR'
		for i in range(10):
			try:
				print(i)
				Date_Modified = SSH_Manager.get_file_modified_info(path)
				break
			except Exception as e:
				print(e)
				Sleep(3)	
		contents = SSH_Manager.get_file_contents(path)
		message = ''
		message += '####################' + "THE FILE NAME = " + the_file + '########################\n'
		#message += "THE FILE NAME = " + the_file + '\n'
		message += "DATE MODIFIED = " + Date_Modified + '\n'
		message += "CONTENTS: " + '\n'
		message += '------------------------------' + '\n'
		message += contents + '\n'
		message += '------------------------------' + '\n'
		message += '##############################################################' + '\n'
		Group_Of_Messages += message + '\n\n\n\n' + '=========================================================================\n'
		print(message)
		print('Remving -> ',path)
		for i in range(5):
			try:
				print(i)
				SSH_Manager.remove_file(path)
				break
			except Exception as e:
				print(e)
		Display_Text(message)
	else:
		print('No Errors Detected')
if Group_Of_Messages != '':
	raise ValueError(Group_Of_Messages)
else:
	Display_Text('No Errors Detected')