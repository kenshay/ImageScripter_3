from imagescripter import *
from imagescripter import *
###############DELTE ME################
Configurator.Reset(start=True)
########################################
times = 0
try:
	Configurator.Start()
except:
	try:
		Configurator.CloseAndClean()
	except:
		pass
	try:
		Configurator.CloseAndClean()
	except:
		pass
	try:	
		Configurator.Start()
	except:
		try:
			Configurator.yellowmedia33.Wait(seconds = 20)
			Configurator.Reset()
			Configurator.Start()
		except:
			Configurator.yellowmedia.Wait()
			Configurator.Reset()
			Configurator.Start()
##Global Cache
Configurator.inputoutput.Click()
Sleep(3)
Configurator.communicationdevices.RightClickType('a')
Sleep(5)
Add.ListView.Select(0,'GlobalCache GC-100, iTach')
Sleep(3)
Add.PushButton.Click('OK')
Sleep(3)
Press('enter')
Sleep(3)
Configurator.Edit.SetText(4,'107')
Sleep(3)
Configurator.apply.Click()
Sleep(3)
Configurator.discoverdevices.Click()
try:
	Configurator.irlist.Wait()
except:
	raise ValueError('Global Cache seems to be Down')
Sleep(3)
Configurator.media.Click()
Sleep(5)
############################################################
try:
	Configurator.sources444.RightClickTypeThenPress('aaaaaaa','enter')
except:
	Configurator.communicationdevices.RightClickTypeThenPress('aaaaaaa','enter',xoffset=-48,yoffset=19)
Sleep(3)
Import.Edit.SetText(0,'Toshiba')
Import.ComboBox.Select(0,'Toshiba')
Import.ComboBox.Select(1,'DVD')
Import.ComboBox.Select(2,'Code Group 2')
Import.PushButton.Click('OK')
Press('enter')
Configurator.ComboBox.Select(3,'IR Output 2:1')
Configurator.apply.Click()
#########################################################
########################MTX-8CH############
Configurator.zonecontrollers.RightClickType('a')
Add.ListView.Select(1,'ELAN EL-IPD Standalone')
Sleep(5)
Add.searchfordevices.Click()
##########################################################################Here###############
try:
	Add.elipdmtx8ch.Wait(seconds = 20)
except:
	Sleep(2)
	HlConfig.Close()
	Sleep(2)
	Add.searchfordevices.Click()
	Sleep(2)
	Add.elipdmtx8ch.Wait(seconds = 20)
	Sleep(2)
	
Add.elipdmtx8ch.Click()
Add.PushButton.Click('OK')
try:
	Configurator.okgreen123.Wait()
except:
	Configurator.zonecontrollers.Click()
	Configurator.elanelipdmtx8ch.Click()
	Configurator.okgreen123.Wait()
Configurator.elanelipdmtx8chhighlighted.Click(xoffset=-91,yoffset=42)
Sleep(3)
Configurator.zoneone1.Click()
Sleep(3)
Configurator.Edit.SetText(0,'MTX-8CH Zone 1')
Sleep(3)
Configurator.apply.Click()
Sleep(10)
############################ADD SOURCES####################
########################################MTX 8CH
Configurator.climate.Click()
Configurator.media.Click()
try:
	Configurator.elanelipdmtx8ch.Click(xoffset=-96,yoffset=20)
except:
	Configurator.zonecontrollers.Max()
	Configurator.elanelipdmtx8ch.Click(xoffset=-96,yoffset=20)
################ANALOG 1#############
Configurator.analog1.Click()
Configurator.ComboBox.Select(3,0)#######MOde
Configurator.apply.Click()
Configurator.ComboBox.Select(3,1)#######MOde
Configurator.apply.Click()
Configurator.ComboBox.Select(4,0)#######Inputs
Configurator.apply.Click()
Configurator.ComboBox.Select(4,1)#######Input
Configurator.apply.Click()
Configurator.ComboBox.Select(4,2)#######Input
Configurator.apply.Click()
Configurator.ComboBox.Select(4,3)#######Input
Configurator.apply.Click()
Configurator.ComboBox.Select(4,3)#######Input
Configurator.apply.Click()
Configurator.ComboBox.Select(5,0)#######Input level gain
Configurator.apply.Click()
Configurator.ComboBox.Select(5,5)#######Input level gain
Configurator.apply.Click()
Configurator.ComboBox.Select(5,12)#######Input level gain
Configurator.apply.Click()
Configurator.Edit.SetText(1,'Analog 1')
Configurator.apply.Click()
Configurator.ComboBox.Select(4,0)#######Input
Configurator.apply.Click()
###############################################
################ANALOG 2#############
Configurator.analog2.Click()
Configurator.ComboBox.Select(3,0)#######MOde
Configurator.apply.Click()
Configurator.ComboBox.Select(3,1)#######MOde
Configurator.apply.Click()
Configurator.ComboBox.Select(4,0)#######Inputs
Configurator.apply.Click()
Configurator.ComboBox.Select(4,1)#######Input
Configurator.apply.Click()
Configurator.ComboBox.Select(4,2)#######Input
Configurator.apply.Click()
Configurator.ComboBox.Select(4,3)#######Input
Configurator.apply.Click()
Configurator.ComboBox.Select(5,0)#######Input level gain
Configurator.apply.Click()
Configurator.ComboBox.Select(5,5)#######Input level gain
Configurator.apply.Click()
Configurator.ComboBox.Select(5,12)#######Input level gain
Configurator.apply.Click()
Configurator.Edit.SetText(1,'Analog 2')
Configurator.apply.Click()
Configurator.ComboBox.Select(4,0)#######Input
Configurator.apply.Click()
###############################################
################ANALOG 3#############
Configurator.analog3.Click()
Configurator.ComboBox.Select(3,0)#######MOde
Configurator.apply.Click()
Configurator.ComboBox.Select(3,1)#######MOde
Configurator.apply.Click()
Configurator.ComboBox.Select(4,0)#######Inputs
Configurator.apply.Click()
Configurator.ComboBox.Select(4,1)#######Input
Configurator.apply.Click()
Configurator.ComboBox.Select(4,2)#######Input
Configurator.apply.Click()
Configurator.ComboBox.Select(4,3)#######Input
Configurator.apply.Click()
Configurator.ComboBox.Select(5,0)#######Input level gain
Configurator.apply.Click()
Configurator.ComboBox.Select(5,5)#######Input level gain
Configurator.apply.Click()
Configurator.ComboBox.Select(5,12)#######Input level gain
Configurator.apply.Click()
Configurator.Edit.SetText(1,'Analog 3')
Configurator.apply.Click()
################ANALOG 3#############
Configurator.analog4.Click()
Configurator.ComboBox.Select(4,1)#######MOde
Configurator.Edit.SetText(1,'Analog 4')
Configurator.apply.Click()
Configurator.ComboBox.Select(4,0)#######Input
Configurator.apply.Click()
Configurator.ComboBox.Select(0,1)
Configurator.apply.Click()
##################################################CHECK PAGES
Configurator.elanelipdmtx8ch.Click()
Configurator.elanelipdmtx8chpage.Wait()
Configurator.elanelipdmtx8chpage2.Wait()
Configurator.elanelipdmtx8chpage3.Wait()
#########################
Configurator.analog1.Click()
Configurator.analog1page2.Wait()
Configurator.analog1page3.Wait()
#########################
try:
	try:
		Configurator.zoneconfiguration.Click()
	except:
		Sleep(2)
		Configurator.zones45734.Max()
		Sleep(3)
		Configurator.zoneconfiguration.Click()
except:
	pass
try:
	Configurator.zoneconfigurationpage.Wait(seconds = 10)
except:
	Configurator.zoneconfigurationpage234235345.Wait(seconds = 10)
#########################
Configurator.mtx8chzone1.Click()
try:
	Configurator.mtx8chzone1page.Wait(seconds = 10)
except:
	HlConfig.messagewarning.Wait()
	Sleep(3)
	HlConfig.PushButton.Click('OK')
	Press('enter')
########################
Configurator.editbo4234.Click()
Configurator.editbo4234page.Wait()
Configurator.canceledit.Click()
##################################################Firmware
Configurator.elanelipdmtx8ch.Click()
Configurator.mcuversion.Wait(threshold = .99)
Configurator.dspversion.Wait(threshold = .99)
##################################################UPDATE Firmware
Configurator.updatefirmware1313.Click()
Sleep(10)
try:
	HlConfig.PushButton.Click('OK')
except:
	pass
try:
	HlConfig.PushButton.Click('OK')
except:
	pass
Press('enter')
Press('enter')
Configurator.configreading.WaitVanish()
try:
	Configurator.greenok12412.Wait()
except:
	Configurator.greenok12412.Wait(seconds = 500)
Configurator.mcuversion.Wait(threshold = .99)
Configurator.dspversion.Wait(threshold = .99)
##################################################Rename Zone
try:
	Configurator.zone5.Click()
except:
	Configurator.zones45734.Max()
	Configurator.zone5.Click()
Sleep(5)
Configurator.Edit.SetText(0,'Changing the name test')
Configurator.apply.Click()
try:
	Configurator.analog1.Click()
except:
	Configurator.zones2342343.Max()
	Sleep(2)
	Configurator.analog1.Click()
Configurator.changingthenametest.Wait()
##################################################Source Zone
try:
	Configurator.zone5.Click()
except:
	Configurator.zones45734.Max()
	Configurator.zone5.Click()	
Sleep(5)
Configurator.Edit.SetText(1,'Changing the SOURCE name test')
Configurator.apply.Click()
############################
try:
	Configurator.zoneconfiguration.Click()
except:
	Sleep(2)
	Configurator.zones45734.Max()
	Sleep(3)
	Configurator.zoneconfiguration.Click()
########################Mono_Zone################
Sleep(3)
Configurator.mtx8chzonezoneoutput.RightClickTypeThenPress('cc','enter')
Sleep(3)
CreateNewZone.Edit.SetText(0,'Mono_Zone')
Sleep(3)
CreateNewZone.PushButton.Click('OK')
Sleep(40)
try:
	Configurator.apply.Click()
except:
	pass
try:
	Configurator.zoneoutputconfiguration.RightClickType('m',xoffset=143,yoffset=47)##Mono
	Configurator.apply.Click()
	Sleep(60)
except:
	Configurator.zones45734.Max()
	Sleep(3)
	Configurator.zoneconfiguration.Click()
	#####
	Configurator.mtx8chzonezoneoutput.RightClickTypeThenPress('cc','enter')
	Sleep(3)
	CreateNewZone.Edit.SetText(0,'Mono_Zone')
	Sleep(3)
	CreateNewZone.PushButton.Click('OK')
	Sleep(40)
	Configurator.zoneoutputconfiguration.RightClickType('m',xoffset=143,yoffset=47)##Mono
	Sleep(60)
	Configurator.apply.Click()
	#####	
Sleep(3)
try:
	Configurator.zoneoutputconfiguration.RightClickType('m',xoffset=448,yoffset=47)
except:
	Configurator.zones34234.Max()
	Sleep(3)
	Configurator.zoneconfiguration.Click()
	Configurator.zoneoutputconfiguration.RightClickType('m',xoffset=448,yoffset=47)
Sleep(3)
try:
	Configurator.linelevelgain.Click(xoffset=120,yoffset=49)
except:
	try:
		HlConfig.PushButton.Click('Yes')
	except:
		##########################
		HlConfig.PushButton.Click('OK')
		Sleep(1)
		Press('enter')
		Press('enter')
	Sleep(1)
	Press('enter')
	try:
		Configurator.linelevelgain.Click(xoffset=120,yoffset=49)
	except:
		############################
		try:
			Configurator.zoneconfiguration.Click()
		except:
			Sleep(2)
			Configurator.zones45734.Max()
			Sleep(3)
			try:
				Configurator.zoneconfiguration.Click()
				Configurator.zoneoutputconfiguration.RightClickType('m',xoffset=448,yoffset=47)
			except:
				Configurator.zones45734.Max()
				Sleep(5)
				Configurator.zoneconfiguration.Click()
				Configurator.zoneoutputconfiguration.RightClickType('m',xoffset=448,yoffset=47)
			Sleep(3)
			try:
				Configurator.linelevelgain.Click(xoffset=120,yoffset=49)
			except:
				pass
'''
		########################Mono_Zone################
#try:		
#	Configurator.linelevelgain.Click(xoffset=120,yoffset=49)
#except:
#	Configurator.zoneoutputconfiguration.RightClickType('m',xoffset=448,yoffset=47,threshold =.36)
#	Sleep(3)
#	try:
#		Configurator.linelevelgain.Click(xoffset=120,yoffset=49)
#	except:
#		pass
#	Configurator.linelevelgain.Click(xoffset=120,yoffset=49)
#Configurator.linelevelgain.Click(xoffset=120,yoffset=49)
##################Lip sink
#Configurator.linelevelgain.Click(xoffset=3,yoffset=147)
#Configurator.linelevelgain.Click(xoffset=3,yoffset=147)
#Configurator.linelevelgain.Click(xoffset=3,yoffset=147)
###################Lip sink
#Sleep(10)
#EditOutputSettings.PushButton.Click('Save')
#Sleep(5)
#Press('enter')
#Sleep(5)
#try:
	EditOutputSettings.PushButton.Click('Save')
	Sleep(5)
except:
	pass
Sleep(5)
try:
	Configurator.apply.Click()
except:
	pass
Sleep(5)
########################Mono_Zone################
Configurator.mtx8chzonezoneoutput.RightClickTypeThenPress('cc','enter')
Sleep(3)
CreateNewZone.Edit.SetText(0,'Mono_Zone')
Sleep(3)
CreateNewZone.PushButton.Click('OK')
Sleep(5)
Configurator.apply.Click()
Sleep(20)
Configurator.zoneoutputconfiguration.RightClickType('m',xoffset=143,yoffset=47)
Configurator.apply.Click()
Sleep(60)
Configurator.zoneoutputconfiguration.RightClickType('m',xoffset=448,yoffset=47)
Configurator.linelevelgain.Click(xoffset=120,yoffset=49)
Configurator.linelevelgain.Click(xoffset=120,yoffset=49)
Configurator.linelevelgain.Click(xoffset=120,yoffset=49)
##################Lip sink
Configurator.linelevelgain.Click(xoffset=3,yoffset=147)
Configurator.linelevelgain.Click(xoffset=3,yoffset=147)
Configurator.linelevelgain.Click(xoffset=3,yoffset=147)
##################Lip sink
Sleep(10)
EditOutputSettings.PushButton.Click('Save')
Press('enter')
try:
	EditOutputSettings.PushButton.Click('Save')
except:
	pass
Sleep(5)
Configurator.apply.Click()
##################################################
try:
	Configurator.mediayellow.Click()
except:
	pass
try:
	Configurator.elanelipdsmtx8chyellow.Click()
except:
	Configurator.zonecontrollers.Max()
	Configurator.elanelipdsmtx8chyellow.Click()	
Configurator.invalidzoneconfiguration.Wait()
try:
	Configurator.monozone.RightClickType('d')
except:
	Configurator.zones45756.Max()
	Configurator.monozone.RightClickType('d')
HlConfig.PushButton.Click('Yes')
Press('enter')
Configurator.monozone.RightClickType('d')	
HlConfig.PushButton.Click('Yes')
Press('enter')
Sleep(3)
try:
	Configurator.monozone18ch.RightClickType('d')
	Sleep(1)
except:
	Configurator.zones34234.Max()
	Sleep(1)
	Configurator.monozone18ch.RightClickType('d')
Sleep(3)
HlConfig.PushButton.Click('Yes')
Press('enter')
try:
	HlConfig.PushButton.Click('Yes')
	Press('enter')
except:
	pass
	
Configurator.elanelipdmtx8ch.Click()
Configurator.okgreen123.Wait()
'''
Configurator.Close()
Viewer.Start()
##########################Zone 2##################################################
Viewer.media.Click()
Viewer.mediazonessetright.Wait()
Viewer.zone2.Click()
Viewer.toshibasource.Click()
Viewer.sourcepagethere.Wait()
Viewer.shuddar.Click(xoffset=645,yoffset=520)
Viewer.shuddar.Click(xoffset=910,yoffset=521)
Viewer.shuddar.Click(xoffset=910,yoffset=521)
Viewer.shuddar.Click(xoffset=910,yoffset=521)
Viewer.shuddar.Click(xoffset=746,yoffset=521)
Viewer.shuddar.Click(xoffset=746,yoffset=521)
Viewer.shuddar.Click(xoffset=746,yoffset=521)
Viewer.settingpagefor8ch.Click()
Viewer.resetloudnessdndpage.Wait()
##########################################




####################################BUTTON PRESS SAVE PRESET
Viewer.allpresetsoff.Wait()
Viewer.pop.PressAndHold(3)
Viewer.overwrite.Click()
Sleep(3)
Press('backspace')
Type('test')
Press('enter')
Viewer.testpop.PressAndHold(3)
Viewer.resettesttopop.Click()
Viewer.popsettings.Wait()
###########################################################



Viewer.pop.Click()
Viewer.popsettings.Wait()

Viewer.rock.Click()
Viewer.rocksettings.Wait()

Viewer.jazz.Click()
Viewer.jazzsettings.Wait()

Viewer.classical.Click()
Viewer.classicalsettings.Wait()

Viewer.acoustic.Click()
Viewer.acousticsettings.Wait()

Viewer.randb.Click()
Viewer.randbsettings.Wait()

Sleep(4)
Viewer.resetbutton.Click()
try:
	Viewer.allpresetsoff.Wait(seconds = 20)
except:
	Viewer.resetbutton.Click()
	Viewer.allpresetsoff.Wait(seconds = 20)
########################################


Viewer.dnd.Click()
Viewer.dndselected.Wait(seconds=10,threshold = .99)
Viewer.loudness.Click()
Viewer.loudnessselected.Wait(seconds=10,threshold = .99)
Viewer.highlighted8chsettings.Click()
Sleep(3)
Viewer.settingpagefor8ch.Click()
Viewer.loudnessselected.Wait(seconds=10,threshold = .99)
Viewer.dndselected.Wait(seconds=10,threshold = .99)
Viewer.loudnessselected.Click()
Viewer.dndselected.Click()
Viewer.unhighlightedsettings.Wait(seconds=10,threshold = .99)
Viewer.resetbutton.Click()
Viewer.highlighted8chsettings.Click()
Viewer.nextzone234.Click()
#############################################################Zone 3
Viewer.toshibasource.Click()
Viewer.sourcepagethere.Wait()
Viewer.shuddar.Click(xoffset=645,yoffset=520)
Viewer.shuddar.Click(xoffset=910,yoffset=521)
Viewer.shuddar.Click(xoffset=910,yoffset=521)
Viewer.shuddar.Click(xoffset=910,yoffset=521)
Viewer.shuddar.Click(xoffset=746,yoffset=521)
Viewer.shuddar.Click(xoffset=746,yoffset=521)
Viewer.shuddar.Click(xoffset=746,yoffset=521)
Viewer.settingpagefor8ch.Click()
Viewer.resetloudnessdndpage.Wait(seconds = 10,threshold = .98)
##########################################
Viewer.allpresetsoff.Wait()

Viewer.pop.Click()
Viewer.popsettings.Wait()

Viewer.rock.Click()
Viewer.rocksettings.Wait()

Viewer.jazz.Click()
Viewer.jazzsettings.Wait()

Viewer.classical.Click()
Viewer.classicalsettings.Wait()

Viewer.acoustic.Click()
Viewer.acousticsettings.Wait()

Viewer.randb.Click()
Viewer.randbsettings.Wait()


Viewer.resetbutton.Click()
Viewer.allpresetsoff.Wait()
########################################
















Viewer.dnd.Click()
Viewer.loudness.Click()
Viewer.resetbutton.Click()
Viewer.highlighted8chsettings.Click()
Viewer.nextzone234.Click()
#################################
#############################################################Zone 4
Viewer.toshibasource.Click()
Viewer.sourcepagethere.Wait()
Viewer.shuddar.Click(xoffset=645,yoffset=520)
Viewer.shuddar.Click(xoffset=910,yoffset=521)
Viewer.shuddar.Click(xoffset=910,yoffset=521)
Viewer.shuddar.Click(xoffset=910,yoffset=521)
Viewer.shuddar.Click(xoffset=746,yoffset=521)
Viewer.shuddar.Click(xoffset=746,yoffset=521)
Viewer.shuddar.Click(xoffset=746,yoffset=521)
Viewer.settingpagefor8ch.Click()
Viewer.resetloudnessdndpage.Wait()
##########################################
Viewer.allpresetsoff.Wait()

Viewer.pop.Click()
Viewer.popsettings.Wait()

Viewer.rock.Click()
Viewer.rocksettings.Wait()

Viewer.jazz.Click()
Viewer.jazzsettings.Wait()

Viewer.classical.Click()
Viewer.classicalsettings.Wait()

Viewer.acoustic.Click()
Viewer.acousticsettings.Wait()

Viewer.randb.Click()
Viewer.randbsettings.Wait()


Viewer.resetbutton.Click()
Viewer.allpresetsoff.Wait()
########################################
Viewer.dnd.Click()
Viewer.loudness.Click()
Viewer.resetbutton.Click()
Viewer.highlighted8chsettings.Click()
Viewer.nextzone234.Click()
#################################	
#############################################################Changing the name test zone#######
Viewer.toshibasource.Click()
Viewer.sourcepagethere.Wait()
Viewer.shuddar.Click(xoffset=645,yoffset=520)
Viewer.shuddar.Click(xoffset=910,yoffset=521)
Viewer.shuddar.Click(xoffset=910,yoffset=521)
Viewer.shuddar.Click(xoffset=910,yoffset=521)
Viewer.shuddar.Click(xoffset=746,yoffset=521)
Viewer.shuddar.Click(xoffset=746,yoffset=521)
Viewer.shuddar.Click(xoffset=746,yoffset=521)
Viewer.settingpagefor8ch.Click()
Viewer.resetloudnessdndpage.Wait()
##########################################
Viewer.allpresetsoff.Wait()

Viewer.pop.Click()
Viewer.popsettings.Wait()

Viewer.rock.Click()
Viewer.rocksettings.Wait()

Viewer.jazz.Click()
Viewer.jazzsettings.Wait()

Viewer.classical.Click()
Viewer.classicalsettings.Wait()

Viewer.acoustic.Click()
Viewer.acousticsettings.Wait()

Viewer.randb.Click()
Viewer.randbsettings.Wait()


Viewer.resetbutton.Click()
Viewer.allpresetsoff.Wait()
########################################
Viewer.dnd.Click()
Viewer.loudness.Click()
Viewer.resetbutton.Click()
Viewer.highlighted8chsettings.Click()
Viewer.nextzone234.Click()
#################################	
#############################################################zone 6#######
Viewer.toshibasource.Click()
Viewer.sourcepagethere.Wait()
Viewer.shuddar.Click(xoffset=645,yoffset=520)
Viewer.shuddar.Click(xoffset=910,yoffset=521)
Viewer.shuddar.Click(xoffset=910,yoffset=521)
Viewer.shuddar.Click(xoffset=910,yoffset=521)
Viewer.shuddar.Click(xoffset=746,yoffset=521)
Viewer.shuddar.Click(xoffset=746,yoffset=521)
Viewer.shuddar.Click(xoffset=746,yoffset=521)
Viewer.settingpagefor8ch.Click()
Viewer.resetloudnessdndpage.Wait()
##########################################
Viewer.allpresetsoff.Wait()

Viewer.pop.Click()
Viewer.popsettings.Wait()

Viewer.rock.Click()
Viewer.rocksettings.Wait()

Viewer.jazz.Click()
Viewer.jazzsettings.Wait()

Viewer.classical.Click()
Viewer.classicalsettings.Wait()

Viewer.acoustic.Click()
Viewer.acousticsettings.Wait()

Viewer.randb.Click()
Viewer.randbsettings.Wait()


Viewer.resetbutton.Click()
Viewer.allpresetsoff.Wait()
########################################
Viewer.dnd.Click()
Viewer.loudness.Click()
Viewer.resetbutton.Click()
Viewer.highlighted8chsettings.Click()
'''
Viewer.CloseAndClean()
Configurator.Start()
#################################DELETE
Configurator.media.Click()
Configurator.zonecontrollers.Max()
Sleep(3)
Configurator.elanipdmtx8ch.RightClickType('d')
Sleep(3)
HlConfig.PushButton.Click('Yes')
try:
	HlConfig.PushButton.Click('Yes')
except:
	pass
Press('enter')
Configurator.nozonecontrollersthere.Wait()
Configurator.system.Click()
#Configurator.Reset()
#ElanConnectPro.CloseAndClean()
#try:
#	HlConfig.Close()
#except:
#	pass
'''