from imagescripter import *
from imagescripter import *

GoHomeAndStayOn()
Nexus7.climate.Click()
Sleep(2)
Nexus7.climatemiddletop.Wait()
Sleep(2)
if Nexus7.climateoffline.Exists() == True:
    raise ValueError("Exception 7, a Thermostat appears to be offline!")
else:
    pass
##############################################################
d = 0
for x in range(100):
    try:
        Nexus7.righttermostatcustompage.Click()
        Sleep(2)
        Nexus7.righttermostatcustompagepage.Wait()
        Sleep(2)
        break
    except:
        d += 1
        if d >= 60:
            raise ValueError('Something went wrong with climate')
        Nexus7.climatehighlighted.Click()
        Sleep(2)
        Nexus7.climate.Click()
        Sleep(2)
Nexus7.settocoolmode.Click()
Sleep(2)
Nexus7.setcoolto99.Click()
Sleep(2)
Nexus7.setfantoauto.Click()
Sleep(2)
Nexus7.shudder.Click()
Sleep(2)
try:
    Nexus7.cool99updown.Wait(threshold = .95,seconds = 10)
    Sleep(2)
except:
    Nexus7.righttermostatcustompage.Click()
    Sleep(2)
    Nexus7.setcoolto99.Click()
    Sleep(2)
    Nexus7.shudder.Click()
    Sleep(2)
    Nexus7.cool99updown.Wait(threshold=.95, seconds=10)
    Sleep(2)
Sleep(2)
Nexus7.rightthermostat.Click()
Sleep(2)
Nexus7.bigcoolsetto99.Wait(threshold = .92)
Sleep(2)
Nexus7.shudder.Click()
Sleep(2)
Nexus7.climatehighlighted.Click()
Sleep(2)
print("Finished")
Close_Image_Show()