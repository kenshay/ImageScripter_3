from imagescripter import *
from imagescripter import *
from pyzbar.pyzbar import decode
from PIL import Image
from selenium import webdriver
from selenium.webdriver.common.keys import Keys
Configurator.Reset(start=True)
################You need to do this to set the password on the viewer. This is a trick to do it automatiocally###############
Viewer.Start()
Viewer.CloseAndClean()###################Then you close the viewer, CloseAndClean will close the viewer and Elan Connect Pro.
#####################################################################################################
GetBackTOHomeScreenAndStayOn()###################Wake up and keep awake screen and the get back to home######################
Itp8.shutter.Click()
Itp8.settingscog.Click()
Itp8.keypadone.Click()
Itp8.keypadone.Click()
Itp8.keypadone.Click()
Itp8.keypadone.Click()
Itp8.configurethisstation.Click()
Itp8.voicecontrol.Click()
Itp8.voicecontrolpage.Wait(threshold=.95)
Itp8.wake_word_menu.Click()
Itp8.wake_word_alexa.Click()
Itp8.wake_word_mic_gain_menu.Click()
Itp8.wake_word_mic_gain_options.Wait()
Itp8.wake_word_mic_gain_50.Click()
Itp8.voice_processor_menu.Click()
Itp8.voice_processor_menu_amazon_alexa.Click()
Itp8.media_plays_menu.Click()
Itp8.media_plays_on_local_zone.Click()
Itp8.flyout_controls_menu.Click()
Itp8.flyout_controls_disabled.Click()
decoded_qr = decode(Image.open(Template_Path))
decoded_url = decoded_qr[0].data.decode('utf-8')
print(decoded_url)
username = 'pvpeabody.corebrands@gmail.com'
password = '1CoreBrands#'
driver = webdriver.Chrome("C:\Eluminate\System\ImageScripter\Browser\chromedriver.exe")
driver.get(decoded_url)
element = driver.find_element_by_id('ap_email')
element.send_keys(username)
element = driver.find_element_by_id('ap_password')
element.send_keys(password)
element.send_keys(Keys.RETURN)
driver.close()
driver.quit()
Itp8.confirm_authorization.Wait()
Itp8.elan_home_button.Click()
##############################################################You should always end on the main icon page.
Itp8.shutter.Click()
#######################################Then look for the settings wheel, one last time to make sure you are where you expect.
Itp8.settingswheel.Wait()