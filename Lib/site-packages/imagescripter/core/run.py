from imagescripter import *
from imagescripter import *

GoHomeAndStayOn()
Sleep(3)
try:
    Nexus7.security10items.Click(amount = 2)
except:
    Sleep(3)
    Nexus7.homeicon10itemshighlighted.Wait(seconds=1)
    Sleep(3)
    Nexus7.homeicon10itemshighlighted.Click()
    Sleep(3)
    Nexus7.security10items.Click(amount=10)
    Sleep(3)
Sleep(2)
Nexus7.houserightdoorlockleftdoorlocksecuritypage.Wait()
Sleep(2)
if Nexus7.paneloffline.Exists() == True:
    raise ValueError("Panel is Offline")
Nexus7.housesecuritypartition.Click()
Sleep(2)


if Nexus7.paneloffline123123.Exists() == True:
    raise ValueError("Panel is Offline")



##############################################################Read to arm
None1 = True
if Nexus7.readytoarm.Exists(threshold = .95):
    None1 = False
    Nexus7.stay.Click()
    Sleep(2)
    try:
        Nexus7.areyousureyes.Click()
        Sleep(2)
    except:
        Nexus7.cancel.Click()
        Sleep(2)
        Nexus7.stay.Click()
        Sleep(2)
        Nexus7.areyousureyes.Click()
        Sleep(2)
    Nexus7.armed.Wait(threshold = .95)
    Sleep(2)
    ##################################################Disarm
    Nexus7.disarm.Click()
    Nexus7.keyone.Click()
    Nexus7.keyone.Click()
    Nexus7.keyone.Click()
    Nexus7.keyone.Click()
    Nexus7.enter.Click()
    try:
        Nexus7.readytoarm.Wait(threshold = .95,seconds = 5)
    except:
        Nexus7.disarm.Click()
        Nexus7.keyone.Click()
        Nexus7.keyone.Click()
        Nexus7.keyone.Click()
        Nexus7.keyone.Click()
        Nexus7.enter.Click()
        Nexus7.readytoarm.Wait(threshold=.95, seconds=5)
    Sleep(2)
elif Nexus7.armed.Exists(threshold = .95):
    None1 = False
    Nexus7.disarm.Click()
    Sleep(2)
    Nexus7.keyone.Click()
    Nexus7.keyone.Click()
    Nexus7.keyone.Click()
    Nexus7.keyone.Click()
    Nexus7.enter.Click()
    Nexus7.readytoarm.Wait(threshold = .95,seconds = 10)
elif Nexus7.arming.Exists():
    raise ValueError("Stuck in arming")
Nexus7.shudder.Click()
Sleep(2)
Nexus7.security10itemshighlighted.Click()
Sleep(2)
if None1 == True:
    raise ValueError("Nothing was tested, something is wrong")
GoHomeAndStayOn()