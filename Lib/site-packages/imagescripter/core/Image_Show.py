
from PyQt5 import QtGui,uic,QtCore
from win32api import GetSystemMetrics
import sys
from PyQt5.QtWidgets import QApplication, QWidget, QInputDialog, QLineEdit, QFileDialog


Main_Image_File = r"C:\Settings\Last_Templet_Image.png"


class Image_Show_Class(QWidget):
    def __init__(self):
        QWidget.__init__(self)
        paths = [Main_Image_File]
        self.fs_watcher = QtCore.QFileSystemWatcher(paths)
        self.fs_watcher.fileChanged.connect(self.File_Changed)
        self.ui = uic.loadUi(r"C:\ImageScripter_2\Lib\site-packages\imagescripter\core\show_image.ui")
        self.ui.setWindowTitle('Show Image')
        self.load_image()
        self.ui.showMaximized()

    def load_image(self):
        Width = GetSystemMetrics(0)
        Height = GetSystemMetrics(1)
        Pixmap = QtGui.QPixmap(Main_Image_File)
        Pixmap = Pixmap.scaled(Width,Height,QtCore.Qt.KeepAspectRatio)
        self.ui.label.setPixmap(Pixmap)
        self.ui.label.resize(Pixmap.width(), Pixmap.height())

    def File_Changed(self):
        self.load_image()


if __name__ == '__main__':
    app = QApplication(sys.argv)
    screen = app.primaryScreen()
    size = screen.size()
    ex = Image_Show_Class()
    sys.exit(app.exec_())