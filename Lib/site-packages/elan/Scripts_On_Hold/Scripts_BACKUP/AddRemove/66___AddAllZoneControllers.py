#Image Scripter
from elan import *
from elan import Add
#DONE

Day_Of_Week = Get_Day_Of_Week()
print("Day of week is ",Day_Of_Week)
#if Day_Of_Week == "Saturday"
if Day_Of_Week == "Saturday":
    Configurator.Reset(start=True)
    Configurator.Start()
    Configurator.media.Click()
    Configurator.zonecontrollers.RightClickType('a')
    try:
        Add.name.Wait()
    except Exception as e:
        print(str(e))
    AddNewDevice.Wait()
    count = AddNewDevice.ListView.GetCount(1) - 1
    xcount = count
    AddNewDevice.Close()
    print(count)
    Configurator.Close()
    for num in range(count):
            Configurator.Start()
            print("@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@")
            print("Device Index -> " + str(num))
            print("@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@")
            Configurator.media.Click()
            sleep(1)
            Configurator.zonecontrollers.Wait()
            sleep(1)
            #try:
            #    Configurator.zonecontrollers.Click()
            #except:
            #    sleep(1)
            #    Configurator.zonecontrollers.Click()
            #########################
            Configurator.Wait()
            sleep(3)
            #theObject.Click()
            Configurator.zonecontrollers.RightClickType('a')
            try:
                AddNewDevice.Wait()
            except:
                sleep(3)
                #theObject.Click()
                Configurator.zonecontrollers.RightClickType('a')
                
            AddNewDevice.name.Wait()
            sleep(1)
            AddNewDevice.Type('@@@')
            AddNewDevice.ListView.SelectByIndex(1,num)
            AddNewDevice.Wait()
            sleep(4)
            #if AddNewDevice.searchfordevices.Exists():
            #   Add.Close()
            #  Configurator.CloseAndClean()
            #  continue
            try:
                Add.Wait()
                Add.PushButton.Click('OK')
            except:
                Add.Close()
                Configurator.CloseAndClean()
                continue
                
            sleep(2)
            try:
                HlConfig.PushButton.Click('OK')
            except:
                pass
            Configurator.Wait()
            sleep(2)
            ########################
            try:
                Configurator.atatat.Wait()
            except:
                HlConfig.PushButton.Click('OK')
                Configurator.atatat.Wait()
                
        ##############################################
        #reboot
        
            Configurator.system.Click()
            Configurator.RestartHard()
            Configurator.Start()
            Configurator.media.Click()
           
            Configurator.zonecontrollers.Wait()
            sleep(1)
            Configurator.zonecontrollers.Click(xoffset=-98)
            #Configurator.zonecontrollers.Max()
            sleep(3)   
            try:
                Configurator.atatat1.RightClickTypeThenPress('d','enter')
            except:
                Configurator.atatatred.RightClickTypeThenPress('d','enter')
            sleep(2)
            try:
                HlConfig.PushButton.Click('Yes')
                sleep(1)
                try:
                    HlConfig.PushButton.Click('Yes')
                except:
                    pass
            except:
                pass               
            Configurator.atatat.WaitVanish()
            sleep(1)
            Configurator.CloseAndClean()
    #try:
    #    Configurator.CloseAndClean()
    #except:
    #    pass
    try:
        ElanConnectPro.CloseAndClean()
    except:
        pass
else:
    print("Skipping, It is not Saturday")    

try:
    Configurator.CloseAndClean()
except Exception as e:
    print(e)
          
    
                            
    
