from elan import *
#Configurator.Reset(start = True)
Configurator.Start(password = '')
Configurator.climate.Click()
Configurator.thermostats.Wait()
Configurator.thermostats.RightClickType('a')
Add.name.Wait()
count = Add.ListView.GetCount(1) - 1
xcount = count
Add.Close()
print(count)
Configurator.Close()
for num in range(count):
		Configurator.Start()
		print("@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@")
		print("Device Index -> " + str(num))
		print("@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@")
		Configurator.climate.Click()
		sleep(1)
		Configurator.thermostats.Wait()
		sleep(1)
		Configurator.Wait()
		sleep(3)
		Configurator.thermostats.RightClickType('a')
		try:
			Add.Wait()
		except:
			sleep(3)
			Configurator.thermostats.RightClickType('a')
			
		Add.name.Wait()
		sleep(1)
		Add.Type('@@@')
		Add.ListView.SelectByIndex(1,num)
		Add.Wait()
		sleep(4)
		Add.PushButton.Click('OK')
		Configurator.Wait()
		sleep(2)
		Configurator.atatat.Wait()
		Configurator.system.Click()
		Configurator.RestartHard()
		Configurator.Start(password = '')
		Configurator.climate.Click()
	   
		Configurator.thermostats.Wait()
		
		Configurator.atatatred22.RightClickTypeThenPress('d','enter')
		
		
		
		
		
		#except:
		#	Configurator.atatatred.RightClickTypeThenPress('d','enter')
		#sleep(2)
		#try:
		#	HlConfig.PushButton.Click('Yes')
		#	sleep(1)
		#	try:
		#		HlConfig.PushButton.Click('Yes')
		#	except:
		#		pass
		#except:
		#	pass               
		Configurator.atatatred22.WaitVanish()
		Configurator.atatat.WaitVanish()
		sleep(1)
		Configurator.CloseAndClean()
						