
import os
from elan import * 
import time
import os

Start_Image_Show()



day = Get_Day_Of_Week()
if day == "Saturday":
#if True:

        Configurator.Start()
        Say("Going to Fully Backup Controller Configuration")
        now = str(time.strftime("%c"))
        now = "Date_" + now
        now = now.replace(':','-')
        now = now.replace(' ','__Time_')
        now = now.replace('/','-')
        now = now + ".EVBK"
        ElanBackupsPath = "C:\\ELAN_Backups\\"
        if not os.path.exists(ElanBackupsPath):
                os.makedirs(ElanBackupsPath)
        Path = ElanBackupsPath + now
        print(Path)
        #Path = "\\\\192.168.0.163\Public\Controller Backups\\" + now
        #Configurator.Start()
        Configurator.basicinformation.RightClickTypeThenPress('bb','enter')
        HlConfig.Wait()
        sleep(2)
        HlConfig.PushButton.Click('Yes')
        Sleep(10)
        SaveAs.Type(Path)
        SaveAs.Press('enter')
        sleep(2)
        if ConfirmSaveAs.doyouwanttoreplaceit.Exists():
            ConfirmSaveAs.PushButton.Click('Yes')
        else:
            pass
        HlConfig.Wait()
        HlConfig.PushButton.Click('Yes')
        Backup.Wait()
        Backup.readytostart.Wait(seconds=5000)
        Sleep(14)
        
        Backup.start.Click()
        Backup.backupsuccessful.Wait(seconds=5000)
        Sleep(2)
        Backup.PushButton.Click('Done')
        Backup.backupsuccessful.WaitVanish()
        sleep(3)
        Configurator.CloseAndClean()
        Say("Completed Backup of Configuration")
    

Close_Image_Show()
