# from ImageScripter import *
from elan import *
# from pytank.Core.SystemFunctions import Say
# DONE
# Itp8.bluescreenlarge2.SetThreshold(.7283)
def Check_If_Blue_Screen_Exists():
    try:
        sleep(10)
        Blue = '[254   0   0]'
        if Itp8.bluescreen.GetDominantColor(threshold=.70) == Blue:
            raise ValueError('Blue Screen')
        Blue = '[255   0   0]'
        if Itp8.bluescreen.GetDominantColor(threshold=.70) == Blue:
            raise ValueError('Blue Screen')
        Blue = '[253   0   0]'
        if Itp8.bluescreen.GetDominantColor(threshold=.70) == Blue:
            raise ValueError('Blue Screen')
        Say('Blue Screen Does not exist')
    except:
        sleep(40)
        Blue = '[254   0   0]'
        if Itp8.bluescreen.GetDominantColor(threshold=.70) == Blue:
            raise ValueError('Blue Screen')
        Blue = '[255   0   0]'
        if Itp8.bluescreen.GetDominantColor(threshold=.70) == Blue:
            raise ValueError('Blue Screen')
        Blue = '[253   0   0]'
        if Itp8.bluescreen.GetDominantColor(threshold=.70) == Blue:
            raise ValueError('Blue Screen')
        Say('Blue Screen Does not exist')
def Check_If_Connecting_Exists():
    try:
        if Itp8.connectingtocamerapleasewait.Exists() == True:
            sleep(3)
            if Itp8.connectingtocamerapleasewait.Exists() == True:
                sleep(3)
                if Itp8.connectingtocamerapleasewait.Exists() == True:
                    sleep(3)
                    raise ValueError('No video showing')
        else:
            Say("Video Looks good")
        if Itp8.blockytext.Exists() == True:
            raise ValueError('Blocky Text is happening')
        if Itp8.blackimage.Exists() == True:
            raise ValueError('No video showing')
    except Exception as e:
        print(e)
        sleep(40)
        if Itp8.connectingtocamerapleasewait.Exists() == True:
            sleep(3)
            if Itp8.connectingtocamerapleasewait.Exists() == True:
                sleep(3)
                if Itp8.connectingtocamerapleasewait.Exists() == True:
                    sleep(3)
                    raise ValueError('No video showing')
        else:
            Say("Video Looks good")
        if Itp8.blockytext.Exists() == True:
            raise ValueError('Blocky Text is happening')
        if Itp8.blackimage.Exists() == True:
            raise ValueError('No video showing')
# Check_If_Connecting_Exists()

GetBackTOHomeScreenITP8()
Itp8.video10items.Click()
##################################SCROLL TO TOP
Sleep(3)
Itp8.videocameras.Click(xoffset=776,yoffset=80)
Itp8.videocameras.Click(xoffset=776,yoffset=80)
Itp8.videocameras.Click(xoffset=776,yoffset=80)
Itp8.videocameras.Click(xoffset=776,yoffset=80)
#################################################################
Sleep(3)
Itp8.videocameras.Click(xoffset=-452,yoffset=326)
# Itp8.ip8.Wait(threshold = .90)
Itp8.tp12topmiddle.Wait(threshold=.90, wait=False)

for i in range(100):
    print(i)
    try:
        Check_If_Connecting_Exists()
        # Check_If_Blue_Screen_Exists()
    except:
        sleep(30)
        Check_If_Connecting_Exists()
        # Check_If_Blue_Screen_Exists()
    try:
        Itp8.gonextarrow.Click()
        Sleep(3)
        if Itp8.nonext.Exists(threshold=.99999) == True:
            break
    except:
        Itp8.nonext.Wait(threshold=.99999)
        break
sleep(2)
Itp8.nonext.Wait(threshold=.99999)
Check_If_Connecting_Exists()
# Check_If_Blue_Screen_Exists()
Itp8.shudder.Click()
Itp8.videohighlighted2.Click()
Itp8.settingswheel.Wait()