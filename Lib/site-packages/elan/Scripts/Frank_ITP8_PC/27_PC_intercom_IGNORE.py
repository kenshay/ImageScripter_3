from elan import *
#Done


try:
    Viewer.Start(quick=True)
    GetBackTOHomeScreenPC()
    Viewer.intercom10items.Click(threshold = .88)
    Viewer.intercomtopmiddle.Wait(threshold = .88)
    sleep(3)
    Viewer.door2.Click(threshold = .88)
    try:
        Viewer.intercompage.Wait(seconds = 20,threshold = .88)
    except:
        Viewer.door3.Click(threshold = .88)
        Viewer.intercompage.Wait(threshold = .88)
    Say("the intercom page looks good")
    Viewer.doorstation.Click(threshold = .88)
    for i in range(3):
        try:
            try:
                Viewer.monitor.Click(threshold = .88)
            except:
                Viewer.monitor2.Click(threshold = .88)
            Viewer.callingdoorstation.WaitVanish(threshold = .88)
            Say("Im going to check door station monitoring")
            Viewer.doorstationtopleft.Wait(seconds=30,threshold = .88)
            print('Found door station top left')
            break
        except:
            print('Didnt find door station top left')
            if i >= 3:
                raise ValueError('Excection 25 intercom issue')
            continue
    Viewer.startingvideostream.WaitVanish(threshold = .88)
    Sleep(3)
    try:
        Viewer.endmutesnap.Wait(seconds = 10,threshold = .88)
    except Exception as e:
        print(e)
        Viewer.mutesnap.Wait(seconds = 10)
        Viewer.endonly.Wait(seconds = 10)
    Viewer.cameraiconsnapshot.Wait(threshold = .88)
    Say("door station monitoring looks good")
    Pass = False
    for i in range(3):
        try:
            Viewer.end.Click(threshold=.85)
            Pass = True
            break
        except:
            pass
    if Pass == False:
        raise ValueError('Never clicked end, it dis')
    sleep(5)
    Viewer.shudder3.Click(threshold = .88)
    Viewer.CloseAndClean()
    print("Finished")
except Exception as e:
    print(e)
    for i in range(10):
        try:
            Viewer.end.Click(threshold=.85)
            Sleep(1)
        except:
            pass
    raise ValueError(e)
