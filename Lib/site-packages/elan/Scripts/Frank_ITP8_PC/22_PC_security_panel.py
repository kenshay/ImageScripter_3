from elan import *

#DONE

Viewer.Start(quick = True)
GetBackTOHomeScreenPC()
Viewer.security10items.Click()

Say("Checking Security Page")
Viewer.houserightdoorlockleftdoorlocksecuritypage.Wait()

if Viewer.paneloffline.Exists() == True:
    raise ValueError("Panel is Offline")


Say("The Security Page looks great")
Say("Checking Security Panel")
Viewer.housesecuritypartition.Click()
Say("Checking if Security Panel is armed or disarmed")
##############################################################Read to arm



if Viewer.paneloffline2.Exists() == True:
    raise ValueError("Panel is Offline")






if Viewer.readytoarm.Exists():
    Say("Security Panel is disarmed")
    Say("Arming Security Panel to Stay")
    Viewer.stay.Click()
    Sleep(4)
    try:
        Viewer.areyousureyes.Click()
    except:
        sleep(5)
        Viewer.cancel.Click()
        sleep(5)
        Viewer.stay.Click()
        sleep(5)
        Viewer.areyousureyes.Click()
    try:
        Viewer.arming.Wait(seconds = 15)
    except:
        Viewer.areyousureyes.Click()
        Viewer.arming.Wait(seconds=15)
    Viewer.arming.WaitVanish()
    Viewer.armed.Wait()
    Say("Security Panel is now Armed in Stay")
    ##################################################Disarm
    Say("Disarming Security Panel")
    Viewer.disarm.Click()

    Viewer.keyone.Wait()
    Sleep(1)
    Viewer.keyone.Click()
    Viewer.keyone.Click()
    Viewer.keyone.Click()
    Viewer.keyone.Click()
    Viewer.enter.Click()
    
    Viewer.readytoarm.Wait()
    Say("Security Panel is now Disarmed")
    
elif Viewer.armed.Exists():
    Say("Security Panel is Armed")
    Say("Disarming Security Panel")
    Viewer.disarm.Click()
    Viewer.keyone.Wait()
    Sleep(1)
    Viewer.keyone.Click()
    Viewer.keyone.Click()
    Viewer.keyone.Click()
    Viewer.keyone.Click()
    Viewer.enter.Click()
    Viewer.readytoarm.Wait()
    Say("Security Panel is now Disarmed")

Viewer.shudder.Click()

Viewer.security10itemshighlighted.Click()

print("Finished")
Viewer.CloseAndClean()