from elan import *
#Done
Viewer.Start(quick = True)
GetBackTOHomeScreenPC()
Viewer.intercom10items.Click(threshold = .88)
Viewer.intercomtopmiddle.Wait(threshold = .88)
sleep(3)
Viewer.door2.Click(threshold = .88)
try:
    Viewer.intercompage.Wait(seconds = 20,threshold = .88)
except:
    Viewer.door3.Click(threshold = .88)
    Viewer.intercompage.Wait(threshold = .88)
Say("the intercom page looks good")
Viewer.doorstation.Click(threshold = .88)
for i in range(3):
    try:
        try:
            Viewer.monitor.Click(threshold = .88)
        except:
            Viewer.monitor2.Click(threshold = .88)
        Viewer.callingdoorstation.WaitVanish(threshold = .88)
        Say("Im going to check door station monitoring")
        Viewer.doorstationtopleft.Wait(seconds=30,threshold = .88)
        print('Found door station top left')
        break
    except:
        print('Didnt find door station top left')
        if i >= 3:
            raise ValueError('Excection 25 intercom issue')
        continue
    
Viewer.startingvideostream.WaitVanish(threshold = .88)
Viewer.endmutesnap.Wait(threshold = .88)
Viewer.cameraiconsnapshot.Wait(threshold = .88)
Say("door station monitoring looks good")
Viewer.end.Click(threshold = .85)
sleep(5)
Viewer.shudder3.Click(threshold = .88)

Viewer.CloseAndClean()

print("Finished")