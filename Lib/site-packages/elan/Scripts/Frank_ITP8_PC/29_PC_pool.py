
from elan import *
Viewer.Start(quick = True)
GetBackTOHomeScreenPC()
Viewer.pool10items.Click()
Viewer.poolspamiddle.Wait()
Say("Looking to see if connecting, is showing")
try:
    Viewer.redconnecting.Wait(seconds = 5,threshold = .92)
except Exception as e:
    print('Exceptoion -> ' + str(e))
    pass
Viewer.redconnecting.WaitVanish(seconds = 500)


#################

Viewer.poolspa.Wait()
##################################################################
#print(Viewer.spatopright.GetDominantColorClosest(threshold=.83))
####################################################################################################
if Viewer.pooltopleft.Exists(threshold=.99):
    Viewer.pooltopleft.Click(threshold=.99)
    sleep(10)

if Viewer.spatopright.Exists(threshold=.99):
    Viewer.spatopright.Click()
    sleep(10)

try:
    Viewer.pooltempnothing.Wait(seconds=5)
except:
    try:
        Viewer.pooltopleft.Click(threshold=.83)
        Viewer.pooltempnothing.Wait(seconds=5)
    except:
        sleep(2)
        Viewer.poolblue.RealClick()
        Viewer.pooltempnothing.Wait(seconds=5)
        sleep(2)

try:
    Viewer.spatempnothing.Wait(threshold = .92,seconds = 10)
except:
    Viewer.spatopright.Click(threshold=.99)
    Sleep(1)
    Viewer.spatempnothing.Wait(threshold=.92, seconds=10)


Viewer.pooltopleft.Click(threshold=.83)
try:
    Viewer.tempset2.Wait(seconds = 10,threshold=.83)
except:
    Viewer.tempset4.Wait(threshold=.92)
Viewer.spatopright.Click(threshold=.83)

Viewer.tempset3.Wait()

##################################################################






Viewer.shudder.Click()
sleep(10)
Viewer.CloseAndClean()