from elan import *

Viewer.Start()
tries = 0
for i in range(100):
    Viewer.security10items.Click()
    sleep(5)
    if Viewer.securityblank.Exists() == True:
        Viewer.securityhighlighted.Click()
    
        if tries >= 50:
            raise ValueError('Blank Security Page')
        else:
            tries += 1
            continue
    else:
        break
    
Say("I'm going to test ZWave Door Locks")

if Viewer.doorlockwarning.Exists() == True:
    raise ValueError('Somthing is wrong with the door lock')


##################################################Rightdoorlock
Viewer.rightdoorlock.Click()
Viewer.eventlog.Wait()

Viewer.anysecured.Wait(seconds = 500) #need to wait for log to load.

##########################Right Door Lock
Viewer.rightdoorlockmiddle.Click(xoffset = 510,yoffset = 70)
if Viewer.notrespodingdoorlock.Exists() == True:
    raise ValueError("Door lock is not respoding")
Viewer.eventlogunsecured.Wait()
Say("Door Lock is now unSecured")

Viewer.rightdoorlockmiddle.Click(xoffset = 330,yoffset = 70)
Viewer.eventlogsecured.Wait()
if Viewer.notrespodingdoorlock.Exists() == True:
    raise ValueError("Door lock is not respoding")
Say("Door Lock is now secured")
################################




Viewer.shudder.Click()

################################################leftdoorlock
Viewer.leftdoorlock.Click()
################################################
Viewer.eventlog.Wait()
Viewer.anysecured.Wait(seconds = 500)#need to wait for log to load.
Viewer.leftdoorlockmiddle.Click(xoffset = 510,yoffset = 70)
Viewer.securitypinone.Click()
Viewer.securitypinone.Click()
Viewer.securitypinone.Click()
Viewer.securitypinone.Click()
sleep(5)
if Viewer.notrespodingdoorlock.Exists() == True:
    raise ValueError("Door lock is not respoding")
Viewer.eventlogunsecured.Wait()
Say("Door Lock is now unSecured")

Viewer.leftdoorlockmiddle.Click(xoffset = 330,yoffset = 70)
Viewer.eventlogsecured.Wait()
Say("Door Lock is now secured")




##################################################END
Viewer.shudder.Click()
Viewer.security10itemshighlighted.Click()
Viewer.CloseAndClean()

