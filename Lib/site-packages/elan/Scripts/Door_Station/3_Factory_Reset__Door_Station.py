from elan import *
List = ['192.168.1.126', '192.168.1.125', '192.168.1.124']
Selected_IP = None
for i in range(100):
    if Selected_IP != None:
        break
    if i >= 98:
        raise ValueError('no response from ping in list')
    for ip in List:
        print('trying ip -> ', ip)
        Bool = Ping(ip)
        if Bool == True:
            Selected_IP = ip
            break
        else:
            Sleep(2)
for i in range(10):
    try:
        from pywinauto import *
        app = Application().start(r'C:\Program Files (x86)\Google\Chrome\Application\chrome.exe')
        Sleep(3)
        Browser.Max()
        Sleep(15)
        Type(r'http://' + Selected_IP)
        Press('enter')
        try:
            Sleep(10)
            if Browser.save.Exists == True:
                Browser.save.Click()
            Browser.system.Wait(seconds=20)
        except:
            Type('ELAN')
            print(3)
            Press('tab')
            print(4)
            Type('3526')
            print(5)
            Browser.signin.Click()
            Sleep(10)
            if Browser.save.Exists == True:
                Browser.save.Click()
            Browser.system.Wait(seconds=20)
        break
    except:
        try:
            Browser.Close()
            from pywinauto import *
            from elan import *
            app = Application().start(r'C:\Program Files (x86)\Google\Chrome\Application\chrome.exe')
            Sleep(3)
            Browser.Max()
            Sleep(15)
            Type(r'http://' + Selected_IP)
            Press('enter')
            try:
                Sleep(10)
                if Browser.save.Exists == True:
                    Browser.save.Click()
                Browser.system.Wait(seconds=20)
            except:
                Type('ELAN')
                print(3)
                Press('tab')
                print(4)
                Type('3526')
                print(5)
                Browser.signin.Click()
                if Browser.save.Exists == True:
                    Browser.save.Click()
                Browser.system.Wait(seconds=20)
            break
        except:
            Browser.Close()
            from pywinauto import *
            from elan import *
            app = Application().start(r'C:\Program Files (x86)\Google\Chrome\Application\chrome.exe')
            Sleep(3)
            Browser.Max()
            Sleep(15)
            Type(r'http://' + Selected_IP)
            Press('enter')
            try:
                Sleep(10)
                if Browser.save.Exists == True:
                    Browser.save.Click()
                Browser.system.Wait(seconds=20)
            except:
                Type('ELAN')
                print(3)
                Press('tab')
                print(4)
                Type('3526')
                print(5)
                Browser.signin.Click()
                Sleep(10)
                if Browser.save.Exists == True:
                    Browser.save.Click()
                Browser.system.Wait(seconds=20)
            break
Browser.system.Click()
Browser.resetall.Wait()
Browser.resetall.Click()
Browser.ok.Wait()
Browser.ok.Click()
Browser.pleasewait.Wait()
Browser.pleasewait.WaitVanish(seconds=1000)
Sleep(15)
Browser.Close()