from elan import *
#done3
Configurator.Reset(start=True)
Configurator.Start(password = '')
Sleep(20)
Configurator.discovery.Click()
window = Configurator.getWindow()
window.combobox0.select(1)
Configurator.apply.Click()
for i in range(100):
	try:
		Configurator.refresh2.Click()
		Sleep(10)
		Configurator.cpuusage.Click()
		Sleep(3)
		Configurator.discovery.Click()
		Sleep(3)
		Sleep(50)
		Configurator.refresh2.Click()
		Configurator.elanvideodoorbell.Wait(seconds = 100)
		break
	except Exception as e:
		print(e)
		Sleep(20)
Configurator.elanvideodoorbell.Click(xoffset=471,yoffset=1)
window2 = ConfigureDevice.getWindow()
window2.Configure.click()
Sleep(4)
HlConfig.PushButton.Click('OK')
Sleep(20)
try:
	Configurator.messaging.Click()
except:
	ElanConnectPro.Close()
	Configurator.Reset(start=True)
	Configurator.Start(password = '')
	Sleep(20)
	Configurator.discovery.Click()
	window = Configurator.getWindow()
	window.combobox0.select(1)
	Configurator.apply.Click()
	Sleep(10)
	Configurator.refresh2.Click()
	Configurator.elanvideodoorbell.Wait()
	Configurator.elanvideodoorbell.Click(xoffset=471,yoffset=1)
	window2 = ConfigureDevice.getWindow()
	window2.Configure.click()
	Sleep(4)
	HlConfig.PushButton.Click('OK')
	Sleep(20)
	Configurator.messaging.Click()
		
Sleep(4)
try:
	Configurator.elaneldb.Click()
except:
	Configurator.media.Click()
	Sleep(70)
	Configurator.messaging.Click()
	Configurator.elaneldb.Click()
	
Configurator.statusokgreen.Wait()
Configurator.lighting.Click()
Sleep(4)
Configurator.elaneldb.Click()
Configurator.statusokgreen.Wait()
Configurator.video.Click()
Configurator.elaneldb.Click()
Sleep(4)
Configurator.statusokgreen.Wait()
Configurator.CloseAndClean()