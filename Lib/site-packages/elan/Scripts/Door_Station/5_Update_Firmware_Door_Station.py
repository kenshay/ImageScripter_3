import os
#Done3
from elan import *
amount_to_run = 5
path = r"C:\Settings\Firmware_Update_Cycle.txt"
try:
	f = open(path,'r')
	f.close()
except:
	f = open(path,'w')
	f.write('0')
	f.close()
with open(path,'r') as f:
	cycle = int(f.read())
if cycle >= amount_to_run:
	print('Runnung, Cycle is',cycle,' >= ',amount_to_run)
	with open(path,'w') as f:
		f.write('0')
	Configurator.Start(password = '')
	Configurator.media.Wait()
	Press('f5')
	Press('f5')
	Press('f5')
	Press('f5')
	Press('f5')
	Press('f5')
	Press('f5')
	Press('f5')
	HlConfig.PushButton.Click('OK')
	Press('enter')
	Configurator.video.Click()
	Sleep(3)
	Configurator.elaneldb.Click()
	Configurator.updatefirmware2.Click()
	Sleep(5)
	HlConfig.PushButton.Click('Yes')
	HlConfig.Press('enter')
	Configurator.disconnectedred.Wait(seconds = 1000)
	Configurator.greenokok.Wait(seconds = 1000)
	print('found ok')
	Configurator.CloseAndClean()
	
else:
	print('Skipping, Cycle is',cycle,'/',amount_to_run)
	cycle += 1
	with open(path,'w') as f:
		f.write(str(cycle))