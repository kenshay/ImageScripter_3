
from elan import *
from elan.functions import Diff

def Get_Device_List_Simple(One,Two,Three):
    from elan.importer import *
    from elan import *
    from elan import ElanSettings
    One.Click()
    Two.RightClickTypeThenPress(Three,'enter')
    list = AddNewDevice.ListView.GetSelection(1)
    AddNewDevice.PushButton.Click('Cancel')
    return list


Past_List =  ['Autonomic OSD', 'Kaleidescape', 'Lilin', 'SnapAV Luma 500 NVR', 'SnapAV WPS-300-NVR', 'Sony BDP-CX7000ES']

one = Configurator.media
two = Configurator.sources
three = 'aaa'

Current_List = Get_Device_List_Simple(one,two,three)


Configurator.system.Click()

if Current_List != Past_List:
    Difference = Diff(Past_List,Current_List)
    error = 'List Changed\n' + str(Difference)
    raise ValueError(error)

