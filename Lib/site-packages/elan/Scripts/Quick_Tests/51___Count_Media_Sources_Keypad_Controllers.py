
from elan import *
from elan.functions import Diff

#Finished 3/6/19

#DONE
def Get_Device_List_Simple(One,Two,Three):
    One.Click()
    Two.RightClickTypeThenPress(Three,'enter')
    list = AddNewDevice.ListView.GetSelection(1)
    AddNewDevice.PushButton.Click('Cancel')
    return list


#Past_List =  ['SpeakerCraft Peripherial Device']
Past_List =  ['SpeakerCraft Peripherial Device', 'ELAN']


Configurator.Reset(start=True)
Configurator.Start(password = '')

one = Configurator.media
two = Configurator.sources
three = 'aaaa'

Current_List = Get_Device_List_Simple(one,two,three)


Configurator.system.Click()

if Current_List != Past_List:
    Difference = Diff(Past_List,Current_List)
    error = 'List Changed\n' + str(Difference)
    raise ValueError(error)

Configurator.CloseAndClean()