from elan import *

Configurator.Reset(start = True)
Configurator.Start(password = '')
Configurator.Wait()
Configurator.locationandweather.Click()
Configurator.locationtype.Wait()
Configurator.ComboBox.Select(0,"Country/City")
Configurator.Edit.SetText(0,"USA")
Configurator.Edit.SetText(1,"NH")
Configurator.Edit.SetText(2,"Londonderry")
Configurator.Wait()
for i in range(10):
    try:
        Configurator.ComboBox.Select(1, 1)
        #Configurator.ComboBox.Select(1,"Airport KMHT - Manchester, NH")
        break
    except:
        sleep(2)
Configurator.lookuplatlonfromlocation.Click()
Configurator.apply.Click()
Configurator.RestartHard()
Configurator.WaitForControllerToComeBackOnline()
Configurator.Start(password = '')
Configurator.locationandweather.Click()
Configurator.locationtype.Wait()
try:
    Configurator.setweatherbycountryforlondonderry.Wait()
except:
    Configurator.media.Click()
    Configurator.system.Click()
    Configurator.Wait()
    Configurator.locationandweather.Click()
    Configurator.setweatherbycountryforlondonderry.Wait()
Configurator.CloseAndClean()
print('                                Finished')
