from elan import *
#Finished 3/5/19

Configurator.Reset(start=True)
ConfigBackupFilePath = r"C:\Elan_Tools\ImageScripter\ProgramData\SystemFiles\Python\Lib\site-packages\elan\Bin\Backup\ConfigBackup.EBK"
Configurator.Start(password = '')
Configurator.basicinformation.RightClickTypeThenPress('r','enter')
try:
    Open.Wait()
except:
    Configurator.basicinformation.RightClickTypeThenPress('r','enter')
    Open.Wait()
Sleep(10)
Open.Edit.SetText(0,ConfigBackupFilePath)
Sleep(1)
Open.PushButton.Click('Open')
try:
    Restore.readytostart.Wait(seconds = 20)
except ValueError:
    Open.PushButton.Click('Open')

try:
    HlConfig.PushButton.Click('Yes')
    HlConfig.PushButton.Click('Yes')
    Restore.readytostart.Wait(seconds = 30)
except:
    try:
        HlConfig.PushButton.Click('OK')
        HlConfig.Press('enter')
    except RuntimeError as e:
        print(e)
        pass
Restore.PushButton.Click('Start')
Restore.restorecomplete.Wait(300)
Restore.PushButton.Click('Done')
HlConfig.Wait()
HlConfig.PushButton.Click('OK')
HlConfig.ok.WaitVanish()
ElanConnectPro.CloseAndClean()
ElanConnectPro.waitForControllerToComeBackOnline()


