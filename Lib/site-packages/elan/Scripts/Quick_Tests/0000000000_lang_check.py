from elan import *
import os
import difflib

path = r"C:\ImageScripter_2\Lib\site-packages\elan\lang_default_for_script.xml"
old_text = r"C:\ImageScripter_2\Lib\site-packages\elan\old_lang_default_for_script.txt"


# Python3 program to find list of uncommon words

# Function to return all uncommon words
def UncommonWords(A, B):
    # count will contain all the word counts
    count = {}

    # insert words of string A to hash
    for word in A.split():
        count[word] = count.get(word, 0) + 1

    # insert words of string B to hash
    for word in B.split():
        count[word] = count.get(word, 0) + 1

    # return required list of words
    return str([word for word in count if count[word] == 1])












Configurator.Reset(start=True)

Configurator.Start()
Configurator.language.Click()
Configurator.export.Click()
try:
	os.remove(path)
except Exception as e:
	print(e)

window = SaveAs.getWindow()
window.edit.wait('visible')
window.edit.set_text(path)

Sleep(5)
window.Save.click()
Press('enter')
#window = ConfirmSaveAs.getWindow()
#window.yes.wait('visible')
#window.yes.Click()
Sleep(5)

try:
	with open(path,'r') as f:
		text = f.read()
except:
	Sleep(10)
	with open(path,'r') as f:
		text = f.read()
###############################This is for fixing the script when changes happen. Keep Commented out or test is useless##########
#with open(old_text,'w') as f:
#	f.write(text)
#############################################################################################
with open(old_text,'r') as f:
	old_text = f.read()	

if old_text != text:
    # Driver Code
    A = "Geeks for Geeks"
    B = "Learning from Geeks for Geeks"
    # Print required answer
    string = UncommonWords(old_text, text)
    string = string.replace('x00','')
    string = string.replace('\\','')
    string = string.replace("]'",'')
    string = string.replace("['",'')
    string = string.replace("']",'')
    Configurator.CloseAndClean()
    raise ValueError(string)
    #print('diff')
    #print(1)
    #output_list = str([li for li in difflib.ndiff(old_text, text) if li[0] != ' '])
    #print(2)
    #output_list2 = str([li for li in difflib.ndiff(text, old_text) if li[0] != ' '])
    #print(3)
    #string = ''
    #print(4)
    #string = string + output_list
    #print(5)
    #string = string + '\\n'
    #print(6)
    #string = string + output_list2
    #print(7)
    #print(path)
    #print(8)
    #print(old_text)
    #print(9)
    # print(path)
    # print(old_text)
    #raise ValueError(string)
else:
    print('Old and New Language files are still the same, test passed')
    Configurator.CloseAndClean()