from elan import *

Start_Image_Show()
time_to_wait = 50

#Configurator.Reset(start = True)
Configurator.Start(password = '')
Configurator.Wait()
Configurator.locationandweather.Click()
try:
    Configurator.locationtype.Wait(20)
except:
    Sleep(10)
    if HlConfig.gettinglistofcordsfailed.Exists() == True:
        HlConfig.gettinglistofcordsfailed.Wait(seconds = 10)
        raise ValueError("Weather Failed")
    else:
        Configurator.locationtype.Wait(10)
Configurator.ComboBox.Select(0,"Country/City")
Configurator.Edit.SetText(0,"USA")
Configurator.Edit.SetText(1,"NH")
Configurator.Edit.SetText(2,"Londonderry")
Configurator.Wait()
Configurator.lookuplatlonfromlocation.Click()
Configurator.weatherissetup.Wait(seconds = 500)
try:
    Configurator.fortyseventyone.Wait(seconds = 20)
except:
    Sleep(10)
    if HlConfig.gettinglistofcordsfailed.Exists() == True:
        HlConfig.gettinglistofcordsfailed.Wait(seconds=10)
        raise ValueError("Weather Failed")
    else:
        Configurator.fortyseventyone.Wait(seconds=10)
Configurator.apply.Click()
Configurator.RestartHard()
Configurator.WaitForControllerToComeBackOnline()
Configurator.Start(password = '')
Configurator.locationandweather.Click()
try:
    Configurator.locationtype.Wait(20)
except:
    Sleep(10)
    if HlConfig.gettinglistofcordsfailed.Exists() == True:
        HlConfig.gettinglistofcordsfailed.Wait(seconds=10)
        raise ValueError("Weather Failed")
    else:
        Configurator.locationtype.Wait(10)
Configurator.setweatherbycountryforlondonderry.Wait(seconds = 500)
Configurator.CloseAndClean()

Close_Image_Show()