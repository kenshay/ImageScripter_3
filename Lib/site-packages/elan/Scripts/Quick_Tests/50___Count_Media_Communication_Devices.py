from elan.functions import Get_Device_List_Simple,Diff
from elan import *
Start_Image_Show()
#Finished 3/6/19
#DONE
#Past_List = ['ADA Bus', 'Autonomic eAudioCast', 'Autonomic Media Server', 'Bose SoundTouch Discovery', 'Denon AVR/AVC (Ethernet)', 'Denon AVR/AVC (RS-232)', 'Denon Heos Network', 'DISH Network', 'ELAN DT11/DT22 Tuner (Ethernet)', 'ELAN DT11/DT22 Tuner (RS-232)', 'ELAN DTNR AM/FM Tuner', 'ELAN System', 'ELAN XM-R3 Tuner', 'Gefen HD-FST Matrix (RS232)', 'Gefen HD-FST Matrix (TCP/IP)', 'Generic Serial', 'Integra RI System (Ethernet)', 'Integra RI System (RS-232)', 'JAP HD over IP Cisco Switch', 'Logitech Media Server', 'Marantz', 'Marantz (D-type)(Ethernet)', 'Marantz (D-type)(RS-232)', 'Pioneer (I-Type) (Ethernet)', 'Pioneer (I-Type) (RS-232)', 'Pioneer SC/VSX (Ethernet)', 'Pioneer SC/VSX (RS-232)', 'Sonos', 'Standard Connection', 'Sunfire TGR-3, TGP-5', 'Sunfire TGR-401, TGP-401', 'ViaNet SC1', 'Yamaha (Ethernet)', 'Yamaha (RS-232)', 'Yamaha MusicCast', 'Yamaha YNCA (Ethernet)', 'Yamaha YNCA (RS-232)']
#Past_List = ['ADA Bus', 'Autonomic eAudioCast', 'Autonomic Media Server', 'Bose SoundTouch Discovery', '1.6.3', 'Denon AVR/AVC (Ethernet)', 'Denon AVR/AVC (RS-232)', 'Denon Heos Network', 'DISH Network', '1.0.0', 'ELAN DT11/DT22 Tuner (Ethernet)', 'ELAN DT11/DT22 Tuner (RS-232)', 'ELAN DTNR AM/FM Tuner', 'ELAN System', 'ELAN XM-R3 Tuner', 'Gefen HD-FST Matrix (RS232)', 'Gefen HD-FST Matrix (TCP/IP)', 'Generic Serial', 'Integra RI System (Ethernet)', 'Integra RI System (RS-232)', 'JAP HD over IP Cisco Switch', 'Logitech Media Server', 'Marantz', 'Marantz (D-type)(Ethernet)', 'Marantz (D-type)(RS-232)', 'Pioneer (I-Type) (Ethernet)', 'Pioneer (I-Type) (RS-232)', 'Pioneer SC/VSX (Ethernet)', 'Pioneer SC/VSX (RS-232)', 'Sonos', 'Standard Connection', 'Sunfire TGR-3, TGP-5', 'Sunfire TGR-401, TGP-401', 'ViaNet SC1', 'Yamaha (Ethernet)', 'Yamaha (RS-232)', 'Yamaha MusicCast', '1.0.18', 'Yamaha YNCA (Ethernet)', 'Yamaha YNCA (RS-232)']
Past_List = ['ADA Bus', 'Autonomic eAudioCast', 'Autonomic Media Server', 'Bose SoundTouch Discovery', '1.6.3', 'Denon AVR/AVC (Ethernet)', 'Denon AVR/AVC (RS-232)', 'Denon Heos Network', 'DISH Network', '1.0.0', 'ELAN DT11/DT22 Tuner (Ethernet)', 'ELAN DT11/DT22 Tuner (RS-232)', 'ELAN DTNR AM/FM Tuner', 'ELAN System', 'ELAN XM-R3 Tuner', 'Gefen HD-FST Matrix (RS232)', 'Gefen HD-FST Matrix (TCP/IP)', 'Generic Serial', 'Integra RI System (Ethernet)', 'Integra RI System (RS-232)', 'JAP HD over IP Cisco Switch', 'Logitech Media Server', 'Marantz', 'Marantz (D-type)(Ethernet)', 'Marantz (D-type)(RS-232)', 'Pioneer (I-Type) (Ethernet)', 'Pioneer (I-Type) (RS-232)', 'Pioneer SC/VSX (Ethernet)', 'Pioneer SC/VSX (RS-232)', 'Sonos', 'Standard Connection', 'Sunfire TGR-3, TGP-5', 'Sunfire TGR-401, TGP-401', 'ViaNet SC1', 'Yamaha (Ethernet)', 'Yamaha (RS-232)', 'Yamaha MusicCast', '1.0.19', 'Yamaha YNCA (Ethernet)', 'Yamaha YNCA (RS-232)']



Configurator.Reset(start=True)
Configurator.Start(password = '')
One = Configurator.media
Two = Configurator.communicationdevices
Current_List = Get_Device_List_Simple(One,Two)
Configurator.system.Click()
if Current_List != Past_List:
    Difference = Diff(Past_List,Current_List)
    error = 'List Changed\n' + str(Difference)
    raise ValueError(error)
Configurator.CloseAndClean()
Close_Image_Show()
'''
from ImageScripter import *
from elan.functions import Get_Device_Count
from elan import *
One = Configurator.media
Two = Configurator.communicationdevices
count = 37
newcount = Get_Device_Count_Simple(One,Two)
Com_Count_Pass_OR_Fail(One,Two,10)
print("New Count is " + str(newcount))
if count != newcount:
    Say('Count for ' + Two.DisplayName + " is off")
    raise ValueError('Exception 11 -> Count for ' + Two.DisplayName + " is off, raising error")
else:
    Say("The new count matches the old count. The test has passed")
Configurator.system.Click()
'''