
from elan import *
from elan.functions import Diff
#Finished 3/6/19
def Get_Device_List_Simple(One,Two,Three):
    One.Click()
    Two.RightClickTypeThenPress(Three,'enter')
    list = AddNewDevice.ListView.GetSelection(1)
    AddNewDevice.PushButton.Click('Cancel')
    return list


#Past_List = ['ADA TuneSuite AM/FM Tuner', 'ADA TuneSuite HD AM/FM Tuner', 'ADA TuneSuite Sirius Tuner', 'ADA TuneSuite XM Tuner', 'Denon AVR Internal AM/FM Tuner', 'Denon AVR Internal FM Only Euro Tuner', 'Denon AVR Internal FM Only Tuner', 'Denon AVR Internal HD Tuner', 'Denon AVR Internal Sirius Tuner', 'Denon AVR Internal XM Tuner', 'Denon AVR-xxxxCI Internal AM/FM Tuner', 'ELAN DT11/DT22 AM/FM Euro Tuner', 'ELAN DT11/DT22 AM/FM Tuner', 'ELAN DT11/DT22 Sirius Tuner', 'ELAN DTNR AM/FM Tuner', 'ELAN XM-R3 Tuner', 'Integra 3.7 AM/FM Tuner', 'Integra 3.7 AM/FM/Sirius Tuner', 'Integra 3.7 AM/FM/XM Tuner', 'Integra DTR Internal AM/FM Euro Tuner', 'Integra DTR Internal AM/FM Tuner', 'Integra DTR Internal HD AM/FM Tuner', 'Integra DTR Internal Sirius Tuner', 'Integra DTR Internal XM Tuner', 'Marantz Internal AM/FM Tuner (D-Type)', 'Marantz Internal FM Only Euro Tuner (D-Type)', 'Marantz Internal FM Only Tuner (D-Type)', 'Marantz Internal HD AM/FM Tuner (D-Type)', 'Marantz Internal Sirius Tuner (D-Type)', 'Marantz SR Internal AM/FM Tuner', 'Marantz SR Internal HD AM/FM Tuner', 'Marantz SR Internal Sirius Tuner', 'Marantz SR Internal XM Tuner', 'Pioneer (I-Type) Internal AM/FM Tuner', 'Pioneer (I-Type) Internal HD AM/FM Tuner', 'Pioneer Internal AM/FM Euro Tuner', 'Pioneer Internal AM/FM Tuner', 'Pioneer Internal Sirius Tuner', 'Sirius SCH2P Tuner', 'SpeakerCraft MZC Internal AM/FM Tuner', 'Sunfire TGR-3/TGP-5 Internal AM/FM Tuner', 'Sunfire TGR-401 Internal Sirius Tuner', 'Sunfire TGR/TGP-401 Internal AM/FM Tuner', 'Yamaha Internal AM/FM Euro Tuner (YNCA)', 'Yamaha Internal AM/FM Tuner (RS-232)', 'Yamaha Internal AM/FM Tuner (YNCA)', 'Yamaha Internal HD AM/FM Tuner (Ethernet)', 'Yamaha Internal HD AM/FM Tuner (RS-232)', 'Yamaha Internal HD AM/FM Tuner (YNCA)', 'Yamaha Internal Sirius Tuner (Ethernet)', 'Yamaha Internal Sirius Tuner (RS-232)', 'Yamaha Internal Sirius Tuner (YNCA)', 'Yamaha Internal XM Tuner (Ethernet)', 'Yamaha Internal XM Tuner (RS-232)']
Past_List = ['ADA TuneSuite AM/FM Tuner', 'ELAN', 'ADA TuneSuite HD AM/FM Tuner', 'ELAN', 'ADA TuneSuite Sirius Tuner', 'ELAN', 'ADA TuneSuite XM Tuner', 'ELAN', 'Denon AVR Internal AM/FM Tuner', 'ELAN', 'Denon AVR Internal FM Only Euro Tuner', 'ELAN', 'Denon AVR Internal FM Only Tuner', 'ELAN', 'Denon AVR Internal HD Tuner', 'ELAN', 'Denon AVR Internal Sirius Tuner', 'ELAN', 'Denon AVR Internal XM Tuner', 'ELAN', 'Denon AVR-xxxxCI Internal AM/FM Tuner', 'ELAN', 'ELAN DT11/DT22 AM/FM Euro Tuner', 'ELAN', 'ELAN DT11/DT22 AM/FM Tuner', 'ELAN', 'ELAN DT11/DT22 Sirius Tuner', 'ELAN', 'ELAN DTNR AM/FM Tuner', 'ELAN', 'ELAN XM-R3 Tuner', 'ELAN', 'Integra 3.7 AM/FM Tuner', 'ELAN', 'Integra 3.7 AM/FM/Sirius Tuner', 'ELAN', 'Integra 3.7 AM/FM/XM Tuner', 'ELAN', 'Integra DTR Internal AM/FM Euro Tuner', 'ELAN', 'Integra DTR Internal AM/FM Tuner', 'ELAN', 'Integra DTR Internal HD AM/FM Tuner', 'ELAN', 'Integra DTR Internal Sirius Tuner', 'ELAN', 'Integra DTR Internal XM Tuner', 'ELAN', 'Marantz Internal AM/FM Tuner (D-Type)', 'ELAN', 'Marantz Internal FM Only Euro Tuner (D-Type)', 'ELAN', 'Marantz Internal FM Only Tuner (D-Type)', 'ELAN', 'Marantz Internal HD AM/FM Tuner (D-Type)', 'ELAN', 'Marantz Internal Sirius Tuner (D-Type)', 'ELAN', 'Marantz SR Internal AM/FM Tuner', 'ELAN', 'Marantz SR Internal HD AM/FM Tuner', 'ELAN', 'Marantz SR Internal Sirius Tuner', 'ELAN', 'Marantz SR Internal XM Tuner', 'ELAN', 'Pioneer (I-Type) Internal AM/FM Tuner', 'ELAN', 'Pioneer (I-Type) Internal HD AM/FM Tuner', 'ELAN', 'Pioneer Internal AM/FM Euro Tuner', 'ELAN', 'Pioneer Internal AM/FM Tuner', 'ELAN', 'Pioneer Internal Sirius Tuner', 'ELAN', 'Sirius SCH2P Tuner', 'ELAN', 'SpeakerCraft MZC Internal AM/FM Tuner', 'ELAN', 'Sunfire TGR-3/TGP-5 Internal AM/FM Tuner', 'ELAN', 'Sunfire TGR-401 Internal Sirius Tuner', 'ELAN', 'Sunfire TGR/TGP-401 Internal AM/FM Tuner', 'ELAN', 'Yamaha Internal AM/FM Euro Tuner (YNCA)', 'ELAN', 'Yamaha Internal AM/FM Tuner (RS-232)', 'ELAN', 'Yamaha Internal AM/FM Tuner (YNCA)', 'ELAN', 'Yamaha Internal HD AM/FM Tuner (Ethernet)', 'ELAN', 'Yamaha Internal HD AM/FM Tuner (RS-232)', 'ELAN', 'Yamaha Internal HD AM/FM Tuner (YNCA)', 'ELAN', 'Yamaha Internal Sirius Tuner (Ethernet)', 'ELAN', 'Yamaha Internal Sirius Tuner (RS-232)', 'ELAN', 'Yamaha Internal Sirius Tuner (YNCA)', 'ELAN', 'Yamaha Internal XM Tuner (Ethernet)', 'ELAN', 'Yamaha Internal XM Tuner (RS-232)', 'ELAN']

Configurator.Reset(start=True)
Configurator.Start(password = '')


one = Configurator.media
two = Configurator.sources
three = 'aa'

Current_List = Get_Device_List_Simple(one,two,three)


Configurator.system.Click()

if Current_List != Past_List:
    Difference = Diff(Past_List,Current_List)
    error = 'List Changed\n' + str(Difference)
    raise ValueError(error)
Configurator.CloseAndClean()