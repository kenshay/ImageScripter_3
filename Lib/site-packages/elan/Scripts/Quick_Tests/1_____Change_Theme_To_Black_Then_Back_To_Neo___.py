#Finished 3/5/19

from elan import *
Start_Image_Show()




Configurator.Reset(start=True)
Configurator.Start(password = '')
Configurator.security.Click()
Configurator.securitypanels.RightClickType('a')
AddNewDevice.ListView.Select(1, 'Virtual')
AddNewDevice.PushButton.Click('OK')
Configurator.discoverdevices.Click()
Configurator.CloseAndClean()
sleep(1)
Viewer.Start()
Viewer.GoToSettings()
Viewer.configurethisstation.Click()
Viewer.themes.Click()
if Viewer.black.Exists() == False:
    Viewer.ThemeScroll()
Viewer.black.Click()
Viewer.blackelan3.Click()
try:
    Viewer.blackelan3.Click()
except:
    pass
for i in range(4):
    print(i)
    Viewer.Wait()
    Viewer.blacksettingswheel.Click()
    Viewer.blackelan3.Click()
Viewer.blacksettingswheel.Click()
Viewer.blackone.Click()
Viewer.blacktwo.Click()
Viewer.blackthree.Click()
Viewer.blackfour.Click()
Viewer.blackconfigurethisstation.Click()
Viewer.blackthemes.Click()
x = 0
while Viewer.blackelanneo.Exists() == False:
    Viewer.ThemeScroll()
    x += 1
    if x >= 100:
        raise ValueError("Scrolled too many times")
x = 0
Viewer.blackelanneo.Click()
Viewer.Wait()
Viewer.elan.Wait()
Viewer.elan.Click()
try:
    Viewer.shudder.Click()
    Viewer.home.Wait()
    Viewer.CloseAndClean()
except Exception as e:
    print(str(e))
    Viewer.Close()
    try:
        Viewer.CloseAndClean()
    except:
        pass
print("                             Finished")


Close_Image_Show()
