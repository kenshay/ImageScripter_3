
from elan.functions import Get_Device_List_Simple,Diff
from elan import *
Start_Image_Show()
#Finished 3/6/19
#DONE

#Past_List = ['2GIG GC3', '2GIG GC3', '2GIG GC3 (3.2 firmware)', 'Ademco VISTA-128BP,250BP,FA1660C', 'Ademco VISTA-128BPT,250BPT', 'Ademco VISTA-128FBP,250FBP', 'Bosch/Radionics D7412G,D9412G', 'DSC MAXSYS', 'DSC Power Series / 5401', 'DSC Power Series / IT-100', 'ELK-M1', 'GE Concord', 'GE NetworX NX-4,6,8,8E', 'HAI Omni Series', 'Napco Gemini GEM-X255, P9600', 'Paradox Digiplex', 'Texecom Premier Elite', 'Virtual Security Controller']
#Past_List =  ['2GIG GC3', '2GIG GC3 (3.2 firmware)', 'Ademco VISTA-128BP,250BP,FA1660C', 'Ademco VISTA-128BPT,250BPT', 'Ademco VISTA-128FBP,250FBP', 'Bosch/Radionics D7412G,D9412G', 'DSC MAXSYS', 'DSC Power Series / 5401', 'DSC Power Series / IT-100', 'ELK-M1', 'GE Concord', 'GE NetworX NX-4,6,8,8E', 'HAI Omni Series', 'Napco Gemini GEM-X255, P9600', 'Paradox Digiplex', 'Texecom Premier Elite', 'Vario (IP)', 'Vario (RS-232)', 'Virtual Security Controller']
#Past_List = ['2GIG GC3', '2GIG GC3', '2GIG GC3 (3.2 firmware)', 'Ademco VISTA-128BP,250BP,FA1660C', 'Ademco VISTA-128BPT,250BPT', 'Ademco VISTA-128FBP,250FBP', 'Bosch/Radionics D7412G,D9412G', 'DSC MAXSYS', 'DSC Power Series / 5401', 'DSC Power Series / IT-100', 'ELK-M1', 'GE Concord', 'GE NetworX NX-4,6,8,8E', 'HAI Omni Series', 'Napco Gemini GEM-X255, P9600', 'Paradox Digiplex', 'Texecom Premier Elite', 'Vario (IP)', 'Vario (RS-232)', 'Virtual Security Controller']
#Past_List = ['2GIG GC3', '2GIG GC3 (3.2 firmware)', 'Ademco VISTA-128BP,250BP,FA1660C', 'Ademco VISTA-128BPT,250BPT', 'Ademco VISTA-128FBP,250FBP', 'Bosch/Radionics D7412G,D9412G', 'DSC MAXSYS', 'DSC Power Series / 5401', 'DSC Power Series / IT-100', 'ELK-M1', 'GE Concord', 'GE NetworX NX-4,6,8,8E', 'HAI Omni Series', 'Napco Gemini GEM-X255, P9600', 'Paradox Digiplex', 'Texecom Premier Elite', 'Vario (IP)', 'Vario (RS-232)', 'Virtual Security Controller']
Past_List = ['2GIG GC3', '3.1.0 v2', 'ELAN', '2GIG GC3 (3.2 firmware)', '3.2.0 v7', 'ELAN', 'Ademco VISTA-128BP,250BP,FA1660C', 'ELAN', 'Ademco VISTA-128BPT,250BPT', 'ELAN', 'Ademco VISTA-128FBP,250FBP', 'ELAN', 'Bosch/Radionics D7412G,D9412G', 'ELAN', 'DSC MAXSYS', 'ELAN', 'DSC Power Series / 5401', 'ELAN', 'DSC Power Series / IT-100', 'ELAN', 'ELK-M1', 'ELAN', 'GE Concord', 'ELAN', 'GE NetworX NX-4,6,8,8E', 'ELAN', 'HAI Omni Series', 'ELAN', 'Napco Gemini GEM-X255, P9600', 'ELAN', 'Paradox Digiplex', 'ELAN', 'Texecom Premier Elite', 'Janus', 'Vario (IP)', '1.0.3', 'ELAN', 'Vario (RS-232)', '1.0.3', 'ELAN', 'Virtual Security Controller', 'ELAN']

Configurator.Reset(start=True)
Configurator.Start(password = '')

One = Configurator.security
Two = Configurator.securitypanels

Current_List = Get_Device_List_Simple(One,Two,index = 1)


Configurator.system.Click()

if Current_List != Past_List:
    Difference = Diff(Past_List,Current_List)
    error = 'List Changed\n' + str(Difference)
    raise ValueError(error)
Configurator.CloseAndClean()

Close_Image_Show()

'''
from ImageScripter import *
from elan.functions import Get_Device_Count
from elan import *

One = Configurator.security
Two = Configurator.securitypanels
count = 18

newcount = Get_Device_Count_Simple(One,Two)
print("New Count is " + str(newcount))
if count != newcount:
    Say('Count for ' + Two.DisplayName + " is off")
    raise ValueError('Exception 11 -> Count for ' + Two.DisplayName + " is off, raising error")
else:
    Say("The new count matches the old count. The test has passed")
Configurator.system.Click()
'''
