#Finished 3/5/19
from elan import *

for i in range(5):
    try:

        Say("Checking Remote Connection")

        try:
            Configurator.Start('frank2','stein',waitseconds = 20)
            Configurator.CloseAndClean()
        except:
            raise ValueError('remote connection for Configurator failed')

        try:
            Viewer.Start('frank2','stein',waitseconds = 20)
            Viewer.CloseAndClean()
        except:
            raise ValueError('remote connection for Viewer failed')
        break
    except ValueError as e:
        print('Trying again.')
        print(i,' / ', 50)
        print(e)
        Ecp.Close()
        ElanConnectPro.CloseAndClean()
        Sleep(2)




