#Finished 3/5/19
from elan import *
Start_Image_Show()
def Try_TO_CLOSE_ECP():
    for i in range(4):
        try:
            Ecp.Close()
        except:
            pass
        Sleep(1)





for i in range(5):
    Try_TO_CLOSE_ECP()
    try:
        Say("Checking Remote Connection")
        try:
            Configurator.Start('frank2','stein',waitseconds = 20)
            Configurator.CloseAndClean()
        except:
            raise ValueError('remote connection for Configurator failed')
        try:
            Viewer.Start('frank2','stein',waitseconds = 20)
            Viewer.CloseAndClean()
        except:
            raise ValueError('remote connection for Viewer failed')
        break
    except ValueError as e:
        print('Trying again.')
        print(i,' / ', 50)
        print(e)
        Ecp.Close()
        ElanConnectPro.CloseAndClean()
        Sleep(2)
Sleep(4)
Try_TO_CLOSE_ECP()



Close_Image_Show()