
from elan import *
from pytank.Core.SystemFunctions import Say
from elan import *

#Itp8.bluescreenlarge2.SetThreshold(.7283)
def Check_If_Blue_Screen_Exists():
    try:
        sleep(10)
        Blue = '[254   0   0]'
        if Itp8.bluescreen.GetDominantColor(threshold=.70) == Blue:
            raise ValueError('Blue Screen')
        Blue = '[255   0   0]'
        if Itp8.bluescreen.GetDominantColor(threshold=.70) == Blue:
            raise ValueError('Blue Screen')
        Blue = '[253   0   0]'    
        if Itp8.bluescreen.GetDominantColor(threshold=.70) == Blue:
            raise ValueError('Blue Screen')
        Say('Blue Screen Does not exist')
    except:
        sleep(40)
        Blue = '[254   0   0]'
        if Itp8.bluescreen.GetDominantColor(threshold=.70) == Blue:
            raise ValueError('Blue Screen')
        Blue = '[255   0   0]'
        if Itp8.bluescreen.GetDominantColor(threshold=.70) == Blue:
            raise ValueError('Blue Screen')
        Blue = '[253   0   0]'    
        if Itp8.bluescreen.GetDominantColor(threshold=.70) == Blue:
            raise ValueError('Blue Screen')
        Say('Blue Screen Does not exist')
        
def Check_If_Connecting_Exists():
    try:
        if Itp8.connectingtocamerapleasewait.Exists() == True:
            sleep(3)
            if Itp8.connectingtocamerapleasewait.Exists() == True:
                sleep(3)
                if Itp8.connectingtocamerapleasewait.Exists() == True:
                    sleep(3)
                    raise ValueError('No video showing')           
        else:
            Say("Video Looks good")
        if Itp8.blockytext.Exists() == True:
            raise ValueError('Blocky Text is happening')    
        if Itp8.blackimage.Exists() == True:
            raise ValueError('No video showing') 
    except Exception as e:
        print(e)
        sleep(40)
        if Itp8.connectingtocamerapleasewait.Exists() == True:
            sleep(3)
            if Itp8.connectingtocamerapleasewait.Exists() == True:
                sleep(3)
                if Itp8.connectingtocamerapleasewait.Exists() == True:
                    sleep(3)
                    raise ValueError('No video showing')           
        else:
            Say("Video Looks good")
        if Itp8.blockytext.Exists() == True:
            raise ValueError('Blocky Text is happening')    
        if Itp8.blackimage.Exists() == True:
            raise ValueError('No video showing') 
    
    
    
#Check_If_Connecting_Exists()    
  

Itp8.video10items.Click()  
##################################SCROLL TO TOP
Itp8.videocameras.Click(xoffset = 475,yoffset = 70,threshold = .90)
Itp8.videocameras.Click(xoffset = 475,yoffset = 70,threshold = .90)
#Itp8.dishmiddleblack.Wait(threshold = .90) 
#################################################################

Itp8.videocameras.Click(xoffset = -200,yoffset = 100,threshold = .90)

#Itp8.ip8.Wait(threshold = .90) 
Itp8.tp12topmiddle.Wait(threshold = .90)

#for i in range(8):
for i in range(7):
    print(i)
    try:
        Check_If_Connecting_Exists()
        #Check_If_Blue_Screen_Exists()
    except:
        sleep(30)
        Check_If_Connecting_Exists()
        #Check_If_Blue_Screen_Exists()
    Itp8.gonextarrow.Click()
    sleep(5)

Check_If_Connecting_Exists()
#Check_If_Blue_Screen_Exists()

Itp8.shudder.Click()

Itp8.videohighlighted2.Click()


Say("Finished Checking the Video Camera's")
