from elan import *

#DOne1
GetBackTOHomeScreenITP8()
Itp8.intercom10items.Click()
Itp8.intercomtopmiddle.Wait()
Itp8.door2.Click()
Itp8.intercompage.Wait(seconds = 20)
Itp8.doorstation.Click()
Itp8.doorstationhighlighted.Wait()
for i in range(3):
    try:
        try:
            Itp8.monitor.Click()
        except:
            Itp8.monitor2.Click()
        Itp8.callingdoorstation.WaitVanish()

        Itp8.doorstationtopleft.Wait(seconds=30)

        break
    except:
        if i >= 3:
            raise ValueError('Excection 25 intercom issue')
        continue
Itp8.endmutesnap.Wait(threshold=.95)
Itp8.cameraiconsnapshot.Wait(threshold=.95)
Itp8.end.Click(threshold=.95)
Itp8.shudder.Click()

print("Finished")