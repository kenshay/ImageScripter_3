from elan import *


Say("Im going to check the intercom page")
Itp8.intercom10items.Click(threshold = .88)
Itp8.intercomtopmiddle.Wait(threshold = .88)
sleep(3)
Itp8.door2.Click(threshold = .88)
try:
    Itp8.intercompage.Wait(seconds = 20,threshold = .88)
except:
    Itp8.door3.Click(threshold = .88)
    Itp8.intercompage.Wait(threshold = .88)
Say("the intercom page looks good")
Itp8.doorstation.Click(threshold = .88)
for i in range(3):
    try:
        try:
            Itp8.monitor.Click(threshold = .88)
        except:
            Itp8.monitor2.Click(threshold = .88)
        Itp8.callingdoorstation.WaitVanish(threshold = .88)
        Say("Im going to check door station monitoring")
        Itp8.doorstationtopleft.Wait(seconds=30,threshold = .88)
        print('Found door station top left')
        break
    except:
        print('Didnt find door station top left')
        if i >= 3:
            raise ValueError('Excection 25 intercom issue')
        continue
    
Itp8.startingvideostream.WaitVanish(threshold = .88)
Itp8.endmutesnap.Wait(threshold = .88)
Itp8.cameraiconsnapshot.Wait(threshold = .88)
Say("door station monitoring looks good")
Itp8.end.Click(threshold = .85)
sleep(5)
Itp8.shudder3.Click(threshold = .88)



print("Finished")