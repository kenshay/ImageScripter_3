from elan import *
'''
tries = 0
for i in range(100):
    Itp8.security.Click()
    sleep(5)
    if Itp8.securityblank.Exists() == True:
        Itp8.securityhighlighted.Click()
        if tries >= 50:
            raise ValueError('Blank Security Page')
        else:
            tries += 1
            continue
    else:
        break
'''
Itp8.security10items.Click()

Say("Checking Security Page")
Itp8.houserightdoorlockleftdoorlocksecuritypage.Wait()

if Itp8.paneloffline.Exists() == True:
    raise ValueError("Panel is Offline")


Say("The Security Page looks great")
Say("Checking Security Panel")
Itp8.housesecuritypartition.Click()
Say("Checking if Security Panel is armed or disarmed")
##############################################################Read to arm



if Itp8.paneloffline2.Exists() == True:
    raise ValueError("Panel is Offline")






if Itp8.readytoarm.Exists():
    Say("Security Panel is disarmed")
    Say("Arming Security Panel to Stay")
    Itp8.stay.Click()
    try:
        Itp8.areyousureyes.Click()
    except:
        sleep(5)
        Itp8.cancel.Click()
        sleep(5)
        Itp8.stay.Click()
        sleep(2)
        Itp8.areyousureyes.Click()
    Itp8.arming.Wait()      
    Itp8.arming.WaitVanish()
    Itp8.armed.Wait()
    Say("Security Panel is now Armed in Stay")
    ##################################################Disarm
    Say("Disarming Security Panel")
    Itp8.disarm.Click()
    Itp8.keyone.Click()
    Itp8.keyone.Click()
    Itp8.keyone.Click()
    Itp8.keyone.Click()
    Itp8.enter.Click()
    
    Itp8.readytoarm.Wait()
    Say("Security Panel is now Disarmed")
    
elif Itp8.armed.Exists():
    Say("Security Panel is Armed")
    Say("Disarming Security Panel")
    Itp8.disarm.Click()
    Itp8.keyone.Click()
    Itp8.keyone.Click()
    Itp8.keyone.Click()
    Itp8.keyone.Click()
    Itp8.enter.Click()
    Itp8.readytoarm.Wait()
    Say("Security Panel is now Disarmed")

Itp8.shudder.Click()

Itp8.security10itemshighlighted.Click()

print("Finished")