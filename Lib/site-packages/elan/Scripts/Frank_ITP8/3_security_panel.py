from elan import *


#Done1

GetBackTOHomeScreenITP8()
Itp8.security10items.Click()
Sleep(1)
Itp8.houserightdoorlockleftdoorlocksecuritypage.Wait()
Sleep(1)
if Itp8.paneloffline.Exists() == True:
    raise ValueError("Panel is Offline")
Itp8.housesecuritypartition.Click()
Sleep(1)
##############################################################Read to arm

None1 = True

if Itp8.readytoarm.Exists(threshold = .95):
    print('############Ready to arm exists')
    None1 = False
    Itp8.stay.Click()
    Sleep(1)
    try:
        Itp8.areyousureyes.Click()
        Sleep(1)
    except:
        Itp8.cancel.Click()
        Sleep(1)
        Itp8.stay.Click()
        Sleep(1)
        Itp8.areyousureyes.Click()
        Sleep(1)
    #Itp8.arming.Wait()
    #Itp8.arming.WaitVanish()
    Itp8.armed.Wait(threshold = .95)
    Sleep(1)
    ##################################################Disarm
    Itp8.disarm.Click()

    Itp8.keyone.Click()

    Itp8.keyone.Click()

    Itp8.keyone.Click()

    Itp8.keyone.Click()

    Itp8.enter.Click()

    Itp8.readytoarm.Wait(threshold = .95)
    Sleep(1)
elif Itp8.armed.Exists(threshold = .95):
    print('############arm exists')
    None1 = False
    Itp8.disarm.Click()
    Sleep(1)
    Itp8.keyone.Click()

    Itp8.keyone.Click()

    Itp8.keyone.Click()

    Itp8.keyone.Click()

    Itp8.enter.Click()

    Itp8.readytoarm.Wait(threshold = .95)

elif Itp8.arming.Exists():
    raise ValueError("Stuck in arming")

Itp8.shudder.Click()
Sleep(1)
Itp8.security10itemshighlighted.Click()
Sleep(1)
print("Finished")
if None1 == True:
    raise ValueError("Nothing was tested, something is wrong")