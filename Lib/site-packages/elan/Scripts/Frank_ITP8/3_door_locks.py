from elan import *

Say("Im looking for a blank security page")
tries = 0
for i in range(100):
    Itp8.security10items.Click()
    sleep(5)
    if Itp8.securityblank.Exists() == True:
        Itp8.securityhighlighted.Click()
    
        if tries >= 50:
            raise ValueError('Blank Security Page')
        else:
            tries += 1
            continue
    else:
        break
    
Say("I'm going to test ZWave Door Locks")

if Itp8.doorlockwarning.Exists() == True:
    raise ValueError('Somthing is wrong with the door lock')


##################################################Rightdoorlock
Itp8.rightdoorlock.Click()
Itp8.eventlog.Wait()

Itp8.anysecured.Wait(seconds = 500) #need to wait for log to load.

##########################Right Door Lock
Itp8.rightdoorlockmiddle.Click(xoffset = 510,yoffset = 70)
if Itp8.notrespodingdoorlock.Exists() == True:
    raise ValueError("Door lock is not respoding")
Itp8.eventlogunsecured.Wait()
Say("Door Lock is now unSecured")

Itp8.rightdoorlockmiddle.Click(xoffset = 330,yoffset = 70)
Itp8.eventlogsecured.Wait()
if Itp8.notrespodingdoorlock.Exists() == True:
    raise ValueError("Door lock is not respoding")
Say("Door Lock is now secured")
################################




Itp8.shudder.Click()

################################################leftdoorlock
Itp8.leftdoorlock.Click()
################################################
Itp8.eventlog.Wait()
Itp8.anysecured.Wait(seconds = 500)#need to wait for log to load.
Itp8.leftdoorlockmiddle.Click(xoffset = 510,yoffset = 70)
Itp8.securitypinone.Click()
Itp8.securitypinone.Click()
Itp8.securitypinone.Click()
Itp8.securitypinone.Click()
sleep(5)
if Itp8.notrespodingdoorlock.Exists() == True:
    raise ValueError("Door lock is not respoding")
Itp8.eventlogunsecured.Wait()
Say("Door Lock is now unSecured")

Itp8.leftdoorlockmiddle.Click(xoffset = 330,yoffset = 70)
Itp8.eventlogsecured.Wait()
Say("Door Lock is now secured")




##################################################END
Itp8.shudder.Click()
Itp8.security10itemshighlighted.Click()


