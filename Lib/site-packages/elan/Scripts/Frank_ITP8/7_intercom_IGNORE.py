from elan import *

#DOne1
GetBackTOHomeScreenITP8()
Itp8.intercom10items.Click()
Sleep(1)
Itp8.intercomtopmiddle.Wait()
Sleep(1)
try:
    Itp8.door2.Click()
except:
    Itp8.doors.Click()
Sleep(1)
Itp8.intercompage.Wait(seconds = 20)
Sleep(1)
Itp8.doorstation.Click()
Sleep(1)
Itp8.doorstationhighlighted.Wait()
Sleep(1)
for i in range(3):
    try:
        try:
            Itp8.monitor.Click()
            Sleep(1)
        except:
            Itp8.monitor2.Click()
            Sleep(1)
        Itp8.callingdoorstation.WaitVanish()
        Sleep(1)
        Itp8.doorstationtopleft.Wait(seconds=30)
        Sleep(1)
        break
    except:
        if i >= 3:
            raise ValueError('Excection 25 intercom issue')
        continue
Itp8.endmutesnap.Wait(threshold=.95)
Sleep(1)
Itp8.cameraiconsnapshot.Wait(threshold=.95)
Sleep(1)
Itp8.end.Click(threshold=.95)
Sleep(1)

Itp8.shudder.Click()
Sleep(1)
print("Finished")