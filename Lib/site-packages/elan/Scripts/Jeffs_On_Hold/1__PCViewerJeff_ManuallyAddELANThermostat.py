from elan import *
Configurator.Reset(start = True)
Configurator.Start()
Configurator.climate.Click()
Configurator.thermostats.RightClickType('a')
AddNewThermostat.ListView.Select(1,"ELAN WiFi Thermostat")
AddNewThermostat.PushButton.Click('OK')
Sleep(5)
Configurator.Edit.SetText(7,'10')
Configurator.applythermostat.Click()
Sleep(2)
Configurator.climate2.Click()
Configurator.thermostats.RightClickType('a')
AddNewThermostat.ListView.Select(1,"ELAN WiFi Thermostat")
AddNewThermostat.PushButton.Click('OK')
Sleep(5)
Configurator.Edit.SetText(7,'122')
Configurator.applythermostat.Click()
Sleep(2)
Configurator.CloseAndClean()
try:
	Viewer.Start()
except:
	ElanConnectPro.Close()
	Sleep(100)
	Viewer.Start()
	Sleep(5)
Viewer.climate.Click()
if Viewer.offline.Exists() == True:
	raise ValueError('offline exists')
if Viewer.offline.Exists() == False:
	pass
Viewer.CloseAndClean()
Configurator.Start()
Configurator.climate.Click()
Configurator.elanwifithermostat.RightClickType('d')
Sleep(2)
HlConfig.PushButton.Click('Yes')
Sleep(3)
Configurator.elanwifithermostat.RightClickType('d')
Sleep(2)
HlConfig.PushButton.Click('Yes')
Sleep(2)
Configurator.CloseAndClean()