from elan import *
import time
from time import sleep
from datetime import date
import calendar






def GetBackTOHomeScreenITP12():
    Pass = False
    for i in range(2):
        try:
            from elan import Itp12
            print("Get Back To Home Screen ITP8")
            try:
                sleep(2)
                Itp12.settingswheel.Wait(seconds=1)
                Pass = True
                break
            except Exception as e:
                print(e)
                try:
                    Itp12.shudder.Wait(seconds=1)
                    Itp12.shudder.Click()
                    sleep(2)
                    Itp12.settingswheel.Wait(seconds=1)
                    Pass = True
                    break
                except Exception as e:
                    print(e)
                    try:
                        Itp12.homeicon10itemshighlighted.Wait(seconds = 1)
                        Itp12.homeicon10itemshighlighted.Click()
                        sleep(2)
                        Itp12.settingswheel.Wait(seconds=1)
                        Pass = True
                        break
                    except Exception as e:
                        print(e)
                        try:
                            Itp12.shudder.Wait(seconds=1)
                            Itp12.shudder.Click()
                            Itp12.homeicon10items2.Click()
                            Itp12.homeicon10itemshighlighted.Click()
                            sleep(2)
                            Itp12.settingswheel.Wait(seconds=1)
                            Pass = True
                            break
                        except Exception as e:
                            print(e)
                            try:
                                Itp12.homeicon10itemshighlighted.Wait(seconds=1)
                                Itp12.homeicon10itemshighlighted.Click()
                                sleep(2)
                                Itp12.settingswheel.Wait(seconds=1)
                                Pass = True
                                break
                            except Exception as e:
                                try:
                                    sleep(2)
                                    Itp12.settingswheel.Wait(seconds=1)
                                    Pass = True
                                    break
                                except Exception as e:
                                    try:
                                        Itp12.elanlogo2.Wait(seconds=1)
                                        Itp12.elanlogo2.Click()
                                        sleep(2)
                                        Itp12.settingswheel.Wait(seconds=1)
                                        Pass = True
                                        break
                                    except Exception as e:
                                        print(e)
                                        Itp12.elantriangle.Wait(seconds=1)
                                        Itp12.elantriangle.Click()
                                        Itp12.shudder.Click()
                                        sleep(2)
                                        Itp12.settingswheel.Wait(seconds=1)
                                        Pass = True
                                        break
        except:
            print('Trying to get back to home again',i)
    if Pass == False:
        raise ValueError("Cant get back to home")



def GetBackTOHomeScreenITP8Portrait():
    Pass = False
    for i in range(2):
        try:
            from elan import Itp8p
            print("Get Back To Home Screen ITP8")
            try:
                sleep(2)
                Itp8p.settingswheel.Wait(seconds=1)
                Pass = True
                break
            except Exception as e:
                print(e)
                try:
                    Itp8p.shudder.Wait(seconds=1)
                    Itp8p.shudder.Click()
                    sleep(2)
                    Itp8p.settingswheel.Wait(seconds=1)
                    Pass = True
                    break
                except Exception as e:
                        print(e)
                        try:
                            Itp8p.shudder.Wait(seconds=1)
                            Itp8p.shudder.Click()
                            Itp8p.homeicon10items2.Click()
                            #Itp8p.homeicon10itemshighlighted.Click()
                            sleep(2)
                            Itp8p.settingswheel.Wait(seconds=1)
                            Pass = True
                            break
                        except Exception as e:
                                print(e)
                                try:
                                    sleep(2)
                                    Itp8p.settingswheel.Wait(seconds=1)
                                    Pass = True
                                    break
                                except Exception as e:
                                    try:
                                        Itp8p.elanlogo2.Wait(seconds=1)
                                        Itp8p.elanlogo2.Click()
                                        sleep(2)
                                        Itp8p.settingswheel.Wait(seconds=1)
                                        Pass = True
                                        break
                                    except Exception as e:
                                        try:
                                            print(e)
                                            Itp8p.elantriangle.Wait(seconds=1)
                                            Itp8p.elantriangle.Click()
                                            Itp8p.shudder.Click()
                                            sleep(2)
                                            Itp8p.settingswheel.Wait(seconds=1)
                                            Pass = True
                                            break
                                        except Exception as e:
                                            try:
                                                print(e)
                                                Itp8p.homeunhighlighted2.Wait(seconds=2)
                                                Itp8p.homeunhighlighted2.Click()
                                                Itp8p.shudder.Wait()
                                                Itp8p.shudder.Click()
                                                Itp8p.settingswheel.Wait()
                                                Pass = True
                                                break
                                            except Exception as e:
                                                print(e)
                                                Itp8p.videolong.Wait(seconds=2)
                                                Itp8p.videolong.Click()
                                                Itp8p.settingswheel.Wait()
                                                Pass = True
                                                break
        except:
            print('Trying to get back to home again',i)
    if Pass == False:
        raise ValueError("Cant get back to home")















def GetBackTOHomeScreenITP8():
    Pass = False
    for i in range(2):
        try:
            from elan import Itp8
            print("Get Back To Home Screen ITP8")
            try:
                sleep(2)
                Itp8.settingswheel.Wait(seconds=1)
                Itp8.bigelan2.Wait(seconds=1)
                Pass = True
                break
            except Exception as e:
                print(e)
                try:
                    Itp8.shudder.Wait(seconds=1)
                    Itp8.shudder.Click()
                    sleep(2)
                    Itp8.settingswheel.Wait(seconds=1)
                    Itp8.bigelan2.Wait(seconds=1)
                    Pass = True
                    break
                except Exception as e:
                    print(e)
                    try:
                        Itp8.homeicon10itemshighlighted.Wait(seconds = 1)
                        Itp8.homeicon10itemshighlighted.Click()
                        sleep(2)
                        Itp8.settingswheel.Wait(seconds=1)
                        Itp8.bigelan2.Wait(seconds=1)
                        Pass = True
                        break
                    except Exception as e:
                        print(e)
                        try:
                            Itp8.shudder.Wait(seconds=1)
                            Itp8.shudder.Click()
                            Itp8.homeicon10items2.Click()
                            Itp8.homeicon10itemshighlighted.Click()
                            sleep(2)
                            Itp8.settingswheel.Wait(seconds=1)
                            Itp8.bigelan2.Wait(seconds=1)
                            Pass = True
                            break
                        except Exception as e:
                            print(e)
                            try:
                                Itp8.homeicon10itemshighlighted.Wait(seconds=1)
                                Itp8.homeicon10itemshighlighted.Click()
                                sleep(2)
                                Itp8.settingswheel.Wait(seconds=1)
                                Itp8.bigelan2.Wait(seconds=1)
                                Pass = True
                                break
                            except Exception as e:
                                try:
                                    sleep(2)
                                    Itp8.settingswheel.Wait(seconds=1)
                                    Itp8.bigelan2.Wait(seconds=1)
                                    Pass = True
                                    break
                                except Exception as e:
                                    try:
                                        Itp8.elanlogo2.Wait(seconds=1)
                                        Itp8.elanlogo2.Click()
                                        sleep(2)
                                        Itp8.settingswheel.Wait(seconds=1)
                                        Itp8.bigelan2.Wait(seconds=1)
                                        Pass = True
                                        break
                                    except Exception as e:
                                        print(e)
                                        Itp8.elantriangle.Wait(seconds=1)
                                        Itp8.elantriangle.Click()
                                        Itp8.shudder.Click()
                                        sleep(2)
                                        Itp8.settingswheel.Wait(seconds=1)
                                        Itp8.bigelan2.Wait(seconds=1)
                                        Pass = True
                                        break
        except:
            print('Trying to get back to home again',i)
    if Pass == False:
        raise ValueError("Cant get back to home")



def GetBackTOHomeScreenPC():
    from elan import Viewer
    print("Get Back To Home Screen PC")
    Pass = False
    for i in range(3):
        try:
            try:
                Viewer.settingswheel.Wait(seconds=2)
                Pass = True
                break
            except Exception as e:
                print(e)
                try:
                    Viewer.homeicon10items.Wait(seconds=2)
                    Viewer.homeicon10items.Click()
                    Viewer.homeicon10itemshighlighted.Click()
                    Viewer.settingswheel.Wait(seconds=2)
                    Pass = True
                    break
                except Exception as e:
                    print(e)
                    try:
                        Viewer.shudder.Wait(seconds=2)
                        Viewer.shudder.Click()
                        Viewer.settingswheel.Wait(seconds=2)
                        Pass = True
                        break
                    except Exception as e:
                        print(e)
                        try:
                            Viewer.homeicon10itemshighlighted.Wait(seconds = 2)
                            Viewer.homeicon10itemshighlighted.Click()
                            Viewer.settingswheel.Wait(seconds=2)
                            Pass = True
                            break
                        except Exception as e:
                            print(e)
                            try:
                                Viewer.shudder.Wait(seconds=2)
                                Viewer.shudder.Click()
                                Viewer.homeicon10items.Click()
                                Viewer.homeicon10itemshighlighted.Click()
                                Viewer.settingswheel.Wait(seconds=2)
                                Pass = True
                                break
                            except Exception as e:
                                print(e)
                                try:
                                    Viewer.homeicon10itemshighlighted.Wait(seconds=1)
                                    Viewer.homeicon10itemshighlighted.Click()
                                    Viewer.settingswheel.Wait(seconds=2)
                                    Pass = True
                                    break
                                except Exception as e:
                                    try:
                                        Viewer.settingswheel.Wait(seconds=2)
                                        Pass = True
                                        break
                                    except Exception as e:
                                        try:
                                            Viewer.elanlogo2.Wait(seconds=2)
                                            Viewer.elanlogo2.Click()
                                            Viewer.settingswheel.Wait(seconds=2)
                                            Pass = True
                                            break
                                        except Exception as e:
                                                Viewer.settingswheel.Wait(seconds=20)
                                                Pass = True
                                                break
        except Exception as e:
            print(e)
            print('Trying get back to home screen again ->',i)
    if Pass == False:
        raise ValueError("could not get back to home screen")


def Get_Device_List_Simple(One,Two,index = 0):
    from elan import AddNewDevice
    One.Click()
    Two.RightClickType('a')
    list = AddNewDevice.ListView.GetSelection(index)
    print('################')
    print(list)
    print('################')
    AddNewDevice.PushButton.Click('Cancel')
    return list

def Get_Day_Of_Week():
    my_date = date.today()
    day_of_the_week = calendar.day_name[my_date.weekday()]
    return day_of_the_week


def Diff(li1, li2):
    li1 = set(li1)
    li2 = set(li2)
    diff = li1 - li2
    diff2 = li2 - li1
    difference = str(diff) + str(diff2)
    difference = difference.replace("set(",'')
    difference = difference.replace(")",'')
    difference = difference.replace("[]",'')
    return difference







def AddNewDeviceSimple(theObject, stringOrIndexOfDevice):
    from elan import AddNewDevice
    if not type(stringOrIndexOfDevice) is int:
        time.sleep(3)
        theObject.RightClickType('a')
        AddNewDevice.name.Wait()
        AddNewDevice.Type('@@@')
        AddNewDevice.ListView.Select(1, stringOrIndexOfDevice)

def addNewComDev(ComType,HardwareType = None,Comport = None):
    from elan import Configurator
    from elan import AddNewDevice
    Configurator.communicationdevices.RightClickType('A')
    sleep(2)
    AddNewDevice.ListView.Select(0,ComType)
    sleep(2)
    if HardwareType:
        AddNewDevice.ListBox.Select(0,HardwareType)
    else:
        print("hardware disabled")
    if Comport != None:
        sleep(3)
        AddNewDevice.ComboBox.Select(0,int(Comport))
    else:
        print("comport disabled")
    sleep(3)
    AddNewDevice.PushButton.Click('OK')


def addNewDevice(theObject, stringOrIndexOfDevice):
    from elan import AddNewDevice,Configurator
    if not type(stringOrIndexOfDevice) is int:
        theObject.Wait()
        # theObject.Click()
        theObject.RightClickType('a')
        AddNewDevice.Wait()
        sleep(2)
        AddNewDevice.name.Wait()
        sleep(1)
        AddNewDevice.Type('@@@')
        AddNewDevice.ListView.Select(1, stringOrIndexOfDevice)
        AddNewDevice.Wait()
        sleep(3)
        AddNewDevice.PushButton.Click('OK')
        try:
            HlConfig.PushButton.Click('OK')
        except:
            pass
        Configurator.Wait()
        sleep(2)
    if type(stringOrIndexOfDevice) is int:
        theObject.Wait()
        Configurator.Wait()
        sleep(3)
        # theObject.Click()
        theObject.RightClickType('a')
        try:
            AddNewDevice.Wait()
        except:
            sleep(3)
            # theObject.Click()
            theObject.RightClickType('a')

        AddNewDevice.name.Wait()
        sleep(1)
        AddNewDevice.Type('@@@')
        AddNewDevice.ListView.SelectByIndex(1, stringOrIndexOfDevice)
        AddNewDevice.Wait()
        sleep(3)
        AddNewDevice.PushButton.Click('OK')
        sleep(2)
        try:
            HlConfig.PushButton.Click('OK')
        except:
            pass
        Configurator.Wait()
        sleep(2)