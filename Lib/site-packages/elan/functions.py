from elan import *
import time
from time import sleep


def AddNewDeviceSimple(theObject, stringOrIndexOfDevice):
    from elan import AddNewDevice
    if not type(stringOrIndexOfDevice) is int:
        time.sleep(3)
        theObject.RightClickType('a')
        AddNewDevice.name.Wait()
        AddNewDevice.Type('@@@')
        AddNewDevice.ListView.Select(1, stringOrIndexOfDevice)

def addNewComDev(ComType,HardwareType = None,Comport = None):
    from elan import Configurator
    from elan import AddNewDevice
    Configurator.communicationdevices.RightClickType('A')
    sleep(2)
    AddNewDevice.ListView.Select(0,ComType)
    sleep(2)
    if HardwareType:
        AddNewDevice.ListBox.Select(0,HardwareType)
    else:
        print("hardware disabled")
    if Comport != None:
        sleep(3)
        AddNewDevice.ComboBox.Select(0,int(Comport))
    else:
        print("comport disabled")
    sleep(3)
    AddNewDevice.PushButton.Click('OK')


def addNewDevice(theObject, stringOrIndexOfDevice):
    from elan import AddNewDevice,Configurator
    if not type(stringOrIndexOfDevice) is int:
        theObject.Wait()
        # theObject.RealClick()
        theObject.RightClickType('a')
        AddNewDevice.Wait()
        sleep(2)
        AddNewDevice.name.Wait()
        sleep(1)
        AddNewDevice.Type('@@@')
        AddNewDevice.ListView.Select(1, stringOrIndexOfDevice)
        AddNewDevice.Wait()
        sleep(3)
        AddNewDevice.PushButton.Click('OK')
        try:
            HlConfig.PushButton.Click('OK')
        except:
            pass
        Configurator.Wait()
        sleep(2)
    if type(stringOrIndexOfDevice) is int:
        theObject.Wait()
        Configurator.Wait()
        sleep(3)
        # theObject.RealClick()
        theObject.RightClickType('a')
        try:
            AddNewDevice.Wait()
        except:
            sleep(3)
            # theObject.RealClick()
            theObject.RightClickType('a')

        AddNewDevice.name.Wait()
        sleep(1)
        AddNewDevice.Type('@@@')
        AddNewDevice.ListView.SelectByIndex(1, stringOrIndexOfDevice)
        AddNewDevice.Wait()
        sleep(3)
        AddNewDevice.PushButton.Click('OK')
        sleep(2)
        try:
            HlConfig.PushButton.Click('OK')
        except:
            pass
        Configurator.Wait()
        sleep(2)