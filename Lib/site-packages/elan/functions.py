from elan import *
import time
from time import sleep
from datetime import date
import calendar




def GetBackTOHomeScreenITP8():
    from elan import Itp8
    print("Get Back To Home Screen ITP8")
    try:
        Itp8.settingswheel.Wait(seconds=1)
    except Exception as e:
        print(e)
        try:
            Itp8.shudder.Wait(seconds=1)
            Itp8.shudder.Click()
            Itp8.settingswheel.Wait(seconds=1)
        except Exception as e:
            print(e)
            try:
                Itp8.homeicon10itemshighlighted.Wait(seconds = 1)
                Itp8.homeicon10itemshighlighted.Click()
                Itp8.settingswheel.Wait(seconds=1)
            except Exception as e:
                print(e)
                try:
                    Itp8.shudder.Wait(seconds=1)
                    Itp8.shudder.Click()
                    Itp8.homeicon10items2.Click()
                    Itp8.homeicon10itemshighlighted.Click()
                    Itp8.settingswheel.Wait(seconds=1)
                except Exception as e:
                    print(e)
                    try:
                        Itp8.homeicon10itemshighlighted.Wait(seconds=1)
                        Itp8.homeicon10itemshighlighted.Click()
                        Itp8.settingswheel.Wait(seconds=1)
                    except Exception as e:
                        try:
                            Itp8.settingswheel.Wait(seconds=5)
                        except Exception as e:
                            Itp8.elanlogo2.Wait(seconds=5)
                            Itp8.elanlogo2.Click()
                            Itp8.settingswheel.Wait(seconds=1)






def Get_Device_List_Simple(One,Two,index = 0):
    from elan import AddNewDevice
    One.Click()
    Two.RightClickType('a')
    list = AddNewDevice.ListView.GetSelection(index)
    print('################')
    print(list)
    print('################')
    AddNewDevice.PushButton.Click('Cancel')
    return list

def Get_Day_Of_Week():
    my_date = date.today()
    day_of_the_week = calendar.day_name[my_date.weekday()]
    return day_of_the_week


def Diff(li1, li2):
    li1 = set(li1)
    li2 = set(li2)
    diff = li1 - li2
    diff2 = li2 - li1
    difference = str(diff) + str(diff2)
    difference = difference.replace("set(",'')
    difference = difference.replace(")",'')
    difference = difference.replace("[]",'')
    return difference







def AddNewDeviceSimple(theObject, stringOrIndexOfDevice):
    from elan import AddNewDevice
    if not type(stringOrIndexOfDevice) is int:
        time.sleep(3)
        theObject.RightClickType('a')
        AddNewDevice.name.Wait()
        AddNewDevice.Type('@@@')
        AddNewDevice.ListView.Select(1, stringOrIndexOfDevice)

def addNewComDev(ComType,HardwareType = None,Comport = None):
    from elan import Configurator
    from elan import AddNewDevice
    Configurator.communicationdevices.RightClickType('A')
    sleep(2)
    AddNewDevice.ListView.Select(0,ComType)
    sleep(2)
    if HardwareType:
        AddNewDevice.ListBox.Select(0,HardwareType)
    else:
        print("hardware disabled")
    if Comport != None:
        sleep(3)
        AddNewDevice.ComboBox.Select(0,int(Comport))
    else:
        print("comport disabled")
    sleep(3)
    AddNewDevice.PushButton.Click('OK')


def addNewDevice(theObject, stringOrIndexOfDevice):
    from elan import AddNewDevice,Configurator
    if not type(stringOrIndexOfDevice) is int:
        theObject.Wait()
        # theObject.RealClick()
        theObject.RightClickType('a')
        AddNewDevice.Wait()
        sleep(2)
        AddNewDevice.name.Wait()
        sleep(1)
        AddNewDevice.Type('@@@')
        AddNewDevice.ListView.Select(1, stringOrIndexOfDevice)
        AddNewDevice.Wait()
        sleep(3)
        AddNewDevice.PushButton.Click('OK')
        try:
            HlConfig.PushButton.Click('OK')
        except:
            pass
        Configurator.Wait()
        sleep(2)
    if type(stringOrIndexOfDevice) is int:
        theObject.Wait()
        Configurator.Wait()
        sleep(3)
        # theObject.RealClick()
        theObject.RightClickType('a')
        try:
            AddNewDevice.Wait()
        except:
            sleep(3)
            # theObject.RealClick()
            theObject.RightClickType('a')

        AddNewDevice.name.Wait()
        sleep(1)
        AddNewDevice.Type('@@@')
        AddNewDevice.ListView.SelectByIndex(1, stringOrIndexOfDevice)
        AddNewDevice.Wait()
        sleep(3)
        AddNewDevice.PushButton.Click('OK')
        sleep(2)
        try:
            HlConfig.PushButton.Click('OK')
        except:
            pass
        Configurator.Wait()
        sleep(2)