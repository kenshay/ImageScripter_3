
from paths import All_Scripts_Folder_Location as scripts_location
from yattag import Doc
import os
from yattag import indent

station_and_scripts = []
excluded = []


extensions = ('.py')  # extinctions want to search

for dname, dirs, files in os.walk(scripts_location):
    dirs[:] = [d for d in dirs if d not in excluded]
    for fname in files:
        if (fname.lower().endswith(extensions)):
            script = os.path.join(dname, fname)
            script = os.path.basename(script)
            Filename = script
            station = dname.split('Scripts\\')[1]
            station_and_scripts.append({"station":station,"script":script,"filename":Filename})


#aList = ['00100','ITP12','Viewer','Content','WebPictures','Web Picture Control','Detects if the web picture is working']





#ID,   Interface,   Application,   Catagory,   Inner-Catagory,   Device,  Description
#ID,Catagory,Inner-Catagory,Device,Description,Application,Interface


os.chdir(r'C:\Eluminate\Projects\_elan_\elan\Scripts\FrankSC100')



for script in station_and_scripts:
    if script['station'] == 'FrankSC100':
        info = str(script['script'].strip('.py'))
        info = eval(info)
        Filename = script['filename']
        ID = info[0]
        Interface = info[1]
        Application = info[2]
        Catagory = info[3]
        InnerCatagory = info[4]
        Device = info[5]
        Description = info[6]

        Newname = "['{}','{}','{}','{}','{}','{}','{}'].py".format(ID,Catagory,InnerCatagory,Device,Description,Application,Interface)
        os.rename(Filename,Newname)
        print("Old name = ",Filename)
        print("New name = ",Newname)

        #print(Newname)


