import json
import os
from paths import All_Scripts_Folder_Location as scripts_location


Location = "C:\Eluminate\Projects\_elan_\elan\Scripts\Smoke_Station\Security"

os.chdir(Location)


def get_list_of_scripts():
    scripts = []
    excluded = []
    extensions = ('.py')  # extinctions want to search
    for folder, dirs, files in os.walk(scripts_location):
        dirs[:] = [d for d in dirs if d not in excluded]
        for fname in files:
            if (fname.lower().endswith(extensions)):
                Dict = {}
                Dict['station'] = folder.split('Scripts\\')[1]
                Dict['fullpath'] = os.path.join(folder, fname)
                Dict['scriptname'] = os.path.basename(os.path.join(folder, fname))
                Dict['directory'] = folder
                if Dict['station'] == 'FrankSC100':
                    scripts.append(Dict)
    return scripts

#for i in get_list_of_scripts():
#    print(i)





def get_commands_from_old_file(path):
    with open(path,'r') as f:
        commands = f.read()
    return commands



for Filename in os.listdir(Location):
    if not Filename.startswith('XX') and Filename.endswith('.py'):
        file_name_no_extension = Filename.strip('.py')
        #info = eval(file_name_no_extension)
        info = file_name_no_extension.split(',')
        ID = info[0]
        print(ID)
        Interface = info[1]
        Application = info[2]
        Catagory = info[3]
        InnerCatagory = info[4]
        Device = info[5]
        Description = info[6]
        ############################################################
        script_info_dict = {}
        script_info_dict['id'] = ID
        script_info_dict['interface'] = Interface
        script_info_dict['application'] = Application
        script_info_dict['catagory'] = Catagory
        script_info_dict['inter-catagory'] = InnerCatagory
        script_info_dict['device'] = Device
        script_info_dict['description'] = Description
        script_info_dict['script'] = Filename
        ss_file_name = file_name_no_extension + '.ss'
        #new_file_name = Filename.replace("','",' ')
        #new_file_name = new_file_name.replace("'",'')
        #new_file_name = new_file_name.replace("[",'')
        #new_file_name = new_file_name.replace("]",'')
        #os.rename(Filename,new_file_name)


        with open(ss_file_name, 'w') as outfile:
           json.dump(script_info_dict, outfile)
        #print(script_info_dict)