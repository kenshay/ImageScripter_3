import matplotlib
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
from paths import Dictionary_Database_Location,All_Scripts_Folder_Location
from Database_Manager.Dictionary_Database_Manager import Dictionary_Database_Manager_Class
Dictionary_Database_Manager = Dictionary_Database_Manager_Class(Dictionary_Database_Location)
import random
#set plot defaults using seaborn formatting
sns.set()

Stations_List = Dictionary_Database_Manager.get_all_station_names()
for station in Stations_List:
    Station_Name = station
    scripts = Dictionary_Database_Manager.get_all_scripts_from_station(Station_Name)
    PassesList = []
    FailsList = []
    for script in scripts:
        Pass_Int,Fail_Int = Dictionary_Database_Manager.get_total_scripts_passes_and_fails(Station_Name,script)
        print(script,' ',Pass_Int,' ',Fail_Int)
        amount_of_fails_this_script_has = Fail_Int
        FailsList.append(amount_of_fails_this_script_has)
        amount_of_passes_this_script_has = Pass_Int
        PassesList.append(amount_of_passes_this_script_has)
    Fails = np.array(FailsList)
    print(FailsList)
    Passes = np.array(PassesList)
    print(PassesList)
    ind = [x for x, _ in enumerate(scripts)]
    plt.bar(ind, Fails, width=1, label='Fail', color='red')
    plt.bar(ind, Passes, width=1, label='Pass', color='green', bottom=Fails)
    plt.xticks(ind, scripts)
    plt.ylabel("Amount")
    plt.xlabel("Scripts")
    plt.xticks(rotation=90)
    plt.legend(loc="upper right")
    plt.title("Fail / Pass")
    plt.gcf().subplots_adjust(bottom=0.60)
    plt.show()