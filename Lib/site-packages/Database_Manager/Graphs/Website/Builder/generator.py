from yattag import Doc
from yattag import indent
import random
from Database_Manager.Dictionary_Database_Manager import Dictionary_Database_Manager_Class
from paths import Dictionary_Database_Location,All_Scripts_Folder_Location,Graph_Folder_Location,Active_Build_without_EXE
####################################################################
Script_Amount = 94
Cycle_Time = '0:04:27'
Station_Name = 'FrankPC_Station'
Build = '8.4.90.1'
Amount_Of_Runs_Total = 9
Dictionary_Database_Manager = Dictionary_Database_Manager_Class(Dictionary_Database_Location)


############################################

#List_of_scripts = []
#Total_Scripts = 5
#Total_entry_per_Script = 5
#List_of_Lenth = []
#Num = 0

Stations_List = Dictionary_Database_Manager.get_all_station_names()
for Station_Name in Stations_List:
    scripts = Dictionary_Database_Manager.get_all_scripts_from_station(Station_Name)
    for i in scripts:
        #Pass_Int, Fail_Int = Dictionary_Database_Manager.get_total_scripts_passes_and_fails(Station_Name, script)
        #PassesFailsListFromFunction = Dictionary_Database_Manager.get_scripts_passes_and_fails_ordered_list(Station_Name, script)
        #Script_Duration = Dictionary_Database_Manager.get_pass_script_duration(Station_Name, script)








        script = {}
        script['name'] = str(Num) + '_Detect_Controller_Crashes'
        Num += 1
        List = []
        for i in range(Total_entry_per_Script):
            Result_Dict = {}
            #Result_Dict['name'] = script['name']
            Result_Dict['pass'] = True
            Result_Dict['link'] = 'FrankPC_Station__5_PC_Check_Video_Video_Settings_For_Changes__8.4.91.1__Fail__34751995279110805x'
            List.append(Result_Dict)
        script['results'] = List
        List_of_scripts.append(script)



    Amount_Of_Runs_Total = Total_entry_per_Script












##################################################################
doc, tag, text = Doc().tagtext()

doc.asis('<!DOCTYPE HTML>')

with tag('html',lang=" en"):
    with tag('head'):
        doc.asis('<!-- basic.html -->')
        with tag('title'):
            text('basic.html')
        doc.asis('<meta charset = "UTF-8" />')
        doc.asis('<link rel="stylesheet" href="style.css">')
    with tag('body'):
        with tag('table',id="title_table"):
            with tag('tr'):
                with tag('td',id="title_table_td"):
                    astring = 'Script Amount = $'
                    astring = astring.replace('$',str(Script_Amount))
                    text(astring)
                with tag('td',id="title_table_td"):
                    astring = 'Cycle Time = $'
                    astring = astring.replace('$',str(Cycle_Time))
                    text(astring)
                with tag('td',id="title_table_td"):
                    astring = 'Station Name = $'
                    astring = astring.replace('$',str(Station_Name))
                    text(astring)
                with tag('td',id="title_table_td"):
                    astring = 'Build = $'
                    astring = astring.replace('$',str(Build))
                    text(astring)
        with tag('table', cellspacing="0",cellpadding="0"):
###################################################################################
            with tag('tr'):
                with tag('td', id="td_script_name"):
                    pass
                for interger in range(Amount_Of_Runs_Total):
                    interger += 1
                    with tag('td', id="td_script_name"):
                        text(str(interger))
#################################################################################

                for script_dict in List_of_scripts:
                     name = script['name']
                     List = script['results']
                     with tag('tr'):
                        with tag('td',id="td_script_name"):
                            text(name)

                        for result in List:

                            pass_or_fail = Result_Dict['pass']

                            pass_or_fail = random.choice(['tdpass','tdfail'])


                            link = Result_Dict['link']
                            linkwhole = "location.href='http://172.105.150.15/fails/" + link + "/fail.php'"
                            with tag('td',id=pass_or_fail,onclick=linkwhole):
                                pass




result = indent(doc.getvalue())
print(result)

with open(r"C:\xampp\htdocs\index.php",'w') as f:
    f.write(result)
#with tag('html'):
#    with tag('body'):
#       text('Hello world!')

#print(doc.getvalue())




'''

with tag('html'):
    with tag('body'):
        with tag('p', id = 'main'):
            text('some text')
        with tag('a', href='/my-url'):
            text('some link')

result = doc.getvalue()
print(result)

'''










'''



with open(r"C:\Eluminate\System\ImageScripter\Lib\site-packages\Database_Manager\Graphs\Website\Builder\0_top.txt",'r') as f:
    Top_0 = f.read()

Top_0 += Top_0 + '/n'

with open(r"C:\Eluminate\System\ImageScripter\Lib\site-packages\Database_Manager\Graphs\Website\Builder\1_table_name.txt",'r') as f:
    Table_Name_1 = f.read()
Table_Name_1 += Table_Name_1 + '/n'

print(Top_0)
print(Table_Name_1)
'''