from paths import Dictionary_Database_Folder
import os
import json
import time
import pickle

os.chdir(Dictionary_Database_Folder)
List_of_databases = os.listdir()
aList = []

for database_file_name in List_of_databases:
    #print('Grabbing Data ',database_file_name)
    #database_file_name = r"\\172.16.43.21\nas\Reports\Dictionary_Databases\FrankPC_Station__8_4_81_170.json"
    #with open(database_file_name) as f:
    #    aList.append(json.load(f))
    with open(database_file_name, 'rb') as f:
        #data = pickle.load(f)
        #print(data)
        aList.append(pickle.load(f))
    time.sleep(1)

for database_list in aList:
    for entry_dict in database_list:
        print(entry_dict)
        if entry_dict['pass'] == 'False':
            print(entry_dict['templet_img'])
            print(entry_dict['script_name'])
            print(entry_dict)
            my_dict = entry_dict

import xlsxwriter
workbook = xlsxwriter.Workbook(r"C:\Users\ken.shay\Desktop\New folder (5)\hello_world.xlsx")
worksheet = workbook.add_worksheet()
data = [
    ['script_name', 10000, 5000, 8000, 6000],
    ['pass',   2000, 3000, 4000, 5000],
    ['script_start_time', 6000, 6000, 6500, 6000],
    ['controller_name',  500,  300,  200,  700],
    ['station_name',  500,  300,  200,  700],
    ['controller_build',  500,  300,  200,  700],

]
worksheet.add_table('A1:E7', {'data': data})
col_num = 0
workbook.close()


