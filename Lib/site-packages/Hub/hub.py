from paths import *
from PyQt5.QtWidgets import QApplication, QWidget
from PyQt5.QtGui import QIcon
from PyQt5.QtWidgets import QApplication, QWidget, QInputDialog, QLineEdit, QFileDialog
from PyQt5.QtWidgets import QApplication, QWidget, QPushButton, QMessageBox
from PyQt5 import QtGui, uic, Qt
from PyQt5.QtGui import QStandardItemModel,QStandardItem
from paths import *
from PyQt5.QtGui import QIcon, QPixmap
from PyQt5.QtGui import *
from PyQt5.QtWidgets import *
from PyQt5.QtCore import *
from paths import *
import PyQt5
from PyQt5 import QtCore
import subprocess
import time
import os
from paths import *


class Hub_Class(QWidget):
    def __init__(self):
        super().__init__()
        self.ui = uic.loadUi(Hub_Ui)
        #self.ui.showMaximized()
        self.ui.resize(400, 600)
        self.ui.show()
        self.ui.pushButton_3.clicked.connect(self.script_writer_clicked)
        self.ui.pushButton_5.clicked.connect(self.new_clicked)
        self.ui.pushButton.clicked.connect(self.browse_for_project)
        self.ui.pushButton_2.clicked.connect(self.database_viewer_clicked)
        self.ui.pushButton_3.clicked.connect(self.script_runner_clicked)
        self.ui.lineEdit.setText(Full_Project_Path )
        self.ui.setWindowTitle(Full_Project_Path)
        pixmap = QPixmap(loading_eyepng)
        self.ui.label_2.setPixmap(pixmap)
        self.ui.label_2.setScaledContents(True)

        List = os.listdir(Projects_Location)
        for i in List:
            i = i.replace('_','')
            #self.ui.comboBox.addItem(os.path.abspath(i))
            self.ui.comboBox.addItem(i)

        #index = self.ui.comboBox.(textToFind)
        #self.ui.comboBox.setCurrentIndex(index)

    def get_windows_version(self):
        import platform
        ver = platform.platform()
        return ver







    def browse_for_project(self):
        try:
            os.chdir(Projects_Location)
            txt1 = ''
            file_name = ''
            if 'Windows-7' not in self.get_windows_version():
                file_name = QFileDialog.getExistingDirectory(self, 'Select directory', directory=Projects_Location)
            else:
                os.chdir(r'C:\\')
                os.chdir(Projects_Location)
                file_name = QFileDialog.getExistingDirectory(self, 'Select directory',
                                                             options=QFileDialog.DontUseNativeDialog, directory=Projects_Location)
            if file_name != '':
                self.ui.lineEdit_2.setText(file_name)
        except Exception as e:
            print(e)


    def save_project_clicked(self):
        print('Save')
    def new_clicked(self):
        print('New')

    def on_combobox_changed(self):
        currentText = str(self.ui.comboBox.currentText())
        self.ui.lineEdit.setText(currentText)

    def script_writer_clicked(self):
        path = Python_Exe_Location + ' ' + ImageScripter_Location + "Lib\site-packages\Script_Writer\script_writer.py"
        proc = subprocess.Popen(path, shell=True)


    def database_viewer_clicked(self):
        path = Python_Exe_Location + ' ' + ImageScripter_Location + "Lib\site-packages\database_viewer\database_viewer.py"
        proc = subprocess.Popen(path, shell=True)

    def script_runner_clicked(self):
        path = Python_Exe_Location + ' ' + ImageScripter_Location + "Lib\site-packages\Script_Writer\script_writer.py"
        proc = subprocess.Popen(path, shell=True)


if __name__ == '__main__':
    try:
        app = QApplication(sys.argv)
        Hub = Hub_Class()
        sys.exit(app.exec_())
    except Exception as e:
        raise
        e = str(e)
        import ctypes
        ctypes.windll.user32.MessageBoxW(0, e, 'Error', 0)
