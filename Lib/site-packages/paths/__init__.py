import os
import sys
import copy

def strip_end(text, suffix):
    if not text.endswith(suffix):
        return text
    return text[:len(text)-len(suffix)]


Full_Project_Path = r"C:\Ellumination\Projects\_elan_\elan"



REPORTS_LOCATION = r"\\172.16.43.21\nas\Reports"




REPORTS_LOCATION_ReversSlash = REPORTS_LOCATION.replace('\\','/')
The_NAME = Full_Project_Path.split('\\')[-1]
Project_Import_Command = "from " + The_NAME + ' import * '
project_path = strip_end(Full_Project_Path,'\\' + The_NAME)
sys.path.append(project_path)
List = Full_Project_Path.split(r'Projects')
PartOne = List[0].rstrip('\\')
IMAGESCRIPTERPATH = PartOne + r"\System\ImageScripter"
PROJECT = project_path + '\\' + The_NAME
#schematxt = r"C:\Ellumination\Projects\_elan_\elan\Data\schema.txt"
schematxt = PROJECT + r"\Data\schema.txt"

project_path_reverse = project_path.replace('\\','/')
PROJECT_Reverse = project_path_reverse + r"/" + The_NAME
PROJECT_Reverse = PROJECT_Reverse.replace(':','')
SETTINGSPATH = project_path + r'\Settings'
# = SETTINGSPATH.replace('\\','/')
#SETTINGSPATH_Reverse_no_Colan = SETTINGSPATH_Reverse_no_Colan.replace(':','')
#Old_Project_Copy_Reversed = SETTINGSPATH_Reverse_no_Colan + '/' + The_NAME
Old_Project_Copy_Reversed = PartOne + r"/System/Data/" + The_NAME #REVERSED
Old_Project_Copy_Reversed = Old_Project_Copy_Reversed.replace('\\','/')#REVERSED
Old_Project_Copy_Reversed = Old_Project_Copy_Reversed.replace('C','c')#REVERSED
Old_Project_Copy_Reversed = Old_Project_Copy_Reversed.replace(':','')#REVERSED

Chroneexe = IMAGESCRIPTERPATH + r"\chrome\App\Chrome-bin\chrome.exe"
Applications_Folder_Location = PROJECT + r"\Applications_And_Devices"#
Elan_Controller_Password = r'elanscX'#
Elan_Controller_User_Name = r'root'#
Elan_Controller_Port = int(r'2199')#
Build_Raw_File = PROJECT + r"\Build_Raw_File.txt"#
Name_Raw_File = PROJECT + r"\Name_Raw_File.txt"
FROM_EMAIL = 'elantestertools@gmail.com'
FROM_EMAIL_Pass = "corebrands123"
Email_Recipients_List = ["kennyshay123@gmail.com","elantestertools@gmail.com","ben.bickell@nortekcontrol.com","Ken.Shay@nortekcontrol.com"]
Settings_Location = SETTINGSPATH + "\\"#
ReverseSETTINGSPATH = SETTINGSPATH.replace('\\','/')
Settings_Location_Reversed_Slash = ReverseSETTINGSPATH + r"/"####Reverse###
VersionBuild = SETTINGSPATH + r"\Version.txt"

Target_Path = IMAGESCRIPTERPATH + r"\Lib\site-packages\imagescripter\core\Last_Target_Image.png"




#Template_Path = r"C:\Users\Administrator\Desktop\Image_Scripter\System\ImageScripter\Lib\site-packages\imagescripter\core\Last_Templet_Image.png"
Template_Path = IMAGESCRIPTERPATH + r"\Lib\site-packages\imagescripter\core\Last_Templet_Image.png"



#Current_Thresh_Match = r"C:\Users\Administrator\Desktop\Image_Scripter\System\ImageScripter\Lib\site-packages\imagescripter\core\Current_Thresh_Match.txt"
Current_Thresh_Match = IMAGESCRIPTERPATH + r"\Lib\site-packages\imagescripter\core\Current_Thresh_Match.txt"


#Image_Compare_Location = r"C:\Users\Administrator\Desktop\Image_Scripter\System\Comparison_Pictures"
Image_Compare_Location = PartOne + r"\System\Comparison_Pictures"

#############


#Current_Action = r"C:\Users\Administrator\Desktop\Image_Scripter\System\ImageScripter\Lib\site-packages\Script_Writer\Current_Action.txt"
Current_Action = IMAGESCRIPTERPATH + r"\Lib\site-packages\Script_Writer\Current_Action.txt"





#Cached_Database_Location = r"C:\Users\Administrator\Desktop\Image_Scripter\System\Data\Cached_Database"
Cached_Database_Location = PartOne + r"\System\Data\Cached_Database"

#################################
################################
###################################





##cygdriveone = r"C:\Users\Administrator\Desktop\Image_Scripter\System\Data\\" + The_NAME + r"/"#####Reverse###
cygdriveone_wrong_way = PartOne + "\System\Data\\" + The_NAME + "\\"
cygdriveone = cygdriveone_wrong_way.replace('\\','/')#####Reverse###



#old_elan = r"C:\Users\Administrator\Desktop\Image_Scripter\System\Data" + The_NAME + "/"#####Reverse###
old_elan = cygdriveone#####Reverse###

#Elan_Folder_Settings = r"C:\Users\Administrator\Desktop\Image_Scripter\System\Data" + The_NAME#

Elan_Folder_Settings = PartOne + "\System\Data\\" + The_NAME#




#Recordings_Location = r"C:\Users\Administrator\Desktop\Image_Scripter\System\Data\Recordings"
Recordings_Location = PartOne + r"\System\Data\Recordings"


#Active_Script_Ouput = r"C:\Users\Administrator\Desktop\Image_Scripter\System\ImageScripter\Lib\site-packages\imagescripter\core\Active_Script_Ouput.txt"
Active_Script_Ouput = IMAGESCRIPTERPATH + r"\Lib\site-packages\imagescripter\core\Active_Script_Ouput.txt"




Current_Running_Script = IMAGESCRIPTERPATH + r"\Lib\site-packages\Script_Writer\Current_Running_Script.txt"#
script_runner_script_path = IMAGESCRIPTERPATH + r"\Lib\site-packages\Script_Writer\script_runner_script_path.txt"#
Imported_Images_And_Scriptstxt = IMAGESCRIPTERPATH + r"\Lib\site-packages\Script_Writer\Imported_Images_And_Scripts.txt"#

## ## ###


#Export_Index22 = r"C:\Users\Administrator\Desktop\Image_Scripter\System\Data\Export_Index.txt"
Export_Index22 = PartOne + r"\System\Data\Export_Index.txt"




#Exported_Script = r"C:\Users\Administrator\Desktop\Image_Scripter\System\ImageScripter\Lib\site-packages\Script_Writer\Exported_Script.txt"
Exported_Script = IMAGESCRIPTERPATH + r"\Lib\site-packages\Script_Writer\Exported_Script.txt"

Last_Opened_Script = Settings_Location + r"Last_Opened_Script.txt"#



#Current_Image_Cordinates = r"C:\Users\Administrator\Desktop\Image_Scripter\System\ImageScripter\Lib\site-packages\imagescripter\core\Current_Image_Cordinates.txt"
Current_Image_Cordinates = IMAGESCRIPTERPATH + r"\Lib\site-packages\imagescripter\core\Current_Image_Cordinates.txt"



##last_x_y = r"C:\Users\Administrator\Desktop\Image_Scripter\System\ImageScripter\Lib\site-packages\imagescripter\core\last_x_y.txt"
last_x_y = IMAGESCRIPTERPATH + r"\Lib\site-packages\imagescripter\core\last_x_y.txt"



All_Scripts_Folder_Location = PROJECT + r'\Scripts'
with open(SETTINGSPATH + r"\Station_Name.txt") as f:
                Station_Name = f.read()
Database_Folder = REPORTS_LOCATION + "\Databases"
Controler_Build_Location = REPORTS_LOCATION + "\Elan_Builds"
Database_Location = Database_Folder + '\\' + Station_Name + '.db'
Notes_Database_Path = REPORTS_LOCATION + r"\Notes\Notes.db"
Videos_For_Database_Location = REPORTS_LOCATION + r"\Videos"
Writer_Backups_place = REPORTS_LOCATION_ReversSlash + "/Exports/"#####Reverse###
NAS_DRIVE = REPORTS_LOCATION + "\Exports"
Cloud_drive_ip = REPORTS_LOCATION + "\\"#
explorer_to_nas = r'explorer ' + NAS_DRIVE
writerbackups123123 = NAS_DRIVE




lang_default_for_scriptxml = r"C:\Ellumination\Projects\_elan_\elan\lang_default_for_script.xml"


old_lang_default_for_scripttxt = r"C:\Ellumination\Projects\_elan_\elan\old_lang_default_for_script.txt"

bluescreenpng = r"C:\Ellumination\Projects\_elan_\elan\Data\bluescreen.png"

Hub_Ui = r"C:\Ellumination\System\ImageScripter\Lib\site-packages\Hub\hub.ui"


languageFile = REPORTS_LOCATION + "\Language\language.XML"
Error_Images_Folder_Location = IMAGESCRIPTERPATH + r'\Lib\site-packages\database_viewer\Failure_Images'#
CElan_ToolsData = PROJECT + r"\Data\Data_For_Backup"#
Elan_ToolsDataFile_Name_Backuptxt = CElan_ToolsData + r"\File_Name_Backup.txt"#
rCElan_Toolslast_buildtxt = PROJECT + "\last_build.txt"#
adb_location = IMAGESCRIPTERPATH + r'\Android\ADB'#
ReverseIMAGESCRIPTERPATH = IMAGESCRIPTERPATH.replace('\\','/')
ImageScripter_Location = IMAGESCRIPTERPATH + r'\\'
ElanConnectProExeLocation = PROJECT  + r"\exe\ecp.exe"
ImageScripter_Location_Reversed_Slashes =  IMAGESCRIPTERPATH + '/'# ##Reverse###
ImageScripter_Location_Reversed_Slashes =  ImageScripter_Location_Reversed_Slashes.replace('\\','/')
Python_Exe_Location = ImageScripter_Location + 'python.exe'#
cygdrivetwo = PROJECT_Reverse + "/"#####Reverse###
COutputoutputcsv = PROJECT + r"\Data\output.csv"
C123123Output = PROJECT + r"\Data\Output"
COld_Build = PROJECT + "\Data\Old_Build"
outputrC = PROJECT + "\Data"
rCNew_Build = PROJECT + r"\Data\New_Build"
CProgramFiles7Zip = ImageScripter_Location + r"7-Zip"
ocNew_Buildry = " -o" + rCNew_Build + " -r -y"
settings_pagepy = Python_Exe_Location + ' ' + ImageScripter_Location + r'Lib\site-packages\Script_Writer\settings_page.py'
Help_Documentrtf = ImageScripter_Location + r"Lib\site-packages\Script_Writer\Help_Document.rtf"
smart_export_to_cloudpy = ImageScripter_Location + r"Lib\site-packages\Script_Writer\rsync\smart_export_to_cloud.py"
runpy = ImageScripter_Location + r"Lib\site-packages\imagescripter\core\run.py"
smart_export_to_deskoppy = ImageScripter_Location + r"Lib\site-packages\Script_Writer\rsync\smart_export_to_deskop.py"
imagescripter_scriptpy = ImageScripter_Location + r'Lib\site-packages\imagescripter\core\imagescripter_script.py'
script_runner_class_repeate_after_fail_start_overpy = ImageScripter_Location + r"Lib\site-packages\imagescripter\core\script_runner_class_repeate_after_fail_start_over.py"
script_runner_for_testingpy = ImageScripter_Location + r"Lib\site-packages\imagescripter\core\script_runner_for_testing.py"
script_runner_class_multipy = ImageScripter_Location + r"Lib\site-packages\imagescripter\core\script_runner_class_multi.py"
script_runner_classpy = ImageScripter_Location + r"Lib\site-packages\imagescripter\core\script_runner_class.py"
diplay_image_for_capturepyPC = Python_Exe_Location + ' ' + ImageScripter_Location + "Lib\site-packages\Script_Writer\diplay_image_for_capture.py PC"
diplay_image_for_capturepyItp8 = Python_Exe_Location + ' ' + ImageScripter_Location + r"Lib\site-packages\Script_Writer\diplay_image_for_capture.py Itp8"
diplay_image_for_capturepyItp8p = Python_Exe_Location + ' ' + ImageScripter_Location + r"Lib\site-packages\Script_Writer\diplay_image_for_capture.py Itp8p"
diplay_image_for_capturepyItp12 = Python_Exe_Location + ' ' + ImageScripter_Location + r"Lib\site-packages\Script_Writer\diplay_image_for_capture.py Itp12"
Script_Converter_Setuppyspace = Python_Exe_Location + ' ' + ImageScripter_Location + r'Lib\site-packages\Script_Writer\Script_Converter_Setup.py '
Desktop_Location = os.path.join(os.environ["HOMEPATH"], "Desktop") + '\\' #
rsyncnogcommand = "rsync  -rvcm --no-p --chmod=ugo=rwX --no-g --no-o --compare-dest=/cygdrive/" + cygdriveone + ' ' + "/cygdrive/" + cygdrivetwo + " "#####Reverse###
screenshot_export = Desktop_Location + r"Exorted\screenshot.png"#
zoneonepng = Desktop_Location + r"Exorted\zoneone.png"#
shudderpng = Desktop_Location + r"Exorted\shudder.png"#
Templet = Desktop_Location + r"templet.png"#
Image = Desktop_Location + r"systemlogs.png"#
log1text = Desktop_Location + r"log1.txt"#
Writer_Backups_place = Writer_Backups_place.replace('\\','/')#
Outputoutputtxt = ImageScripter_Location + r"Data\ouput.txt.txt"#
ConfigBackupFilePath = PROJECT + r"\ConfigBackup.EBK"##
chronewebdriver2 = ImageScripter_Location + r"Browser\chromedriver.exe"#
on_the_fly_capture_ui = ImageScripter_Location + r"Lib\site-packages\imagescripter\core\on_the_fly_capture.py.ui"#
image_display_for_savepy = ImageScripter_Location + r'Lib\site-packages\Script_Writer\image_display_for_save.py'#
Difference_folder = ImageScripter_Location + r"Lib\site-packages\Script_Writer\rsync\difference"#
rsync_path = ImageScripter_Location + r"Lib\site-packages\Script_Writer\rsync"#
new_elan = ImageScripter_Location + r"Lib/site-packages/" + The_NAME + "/"#####Reverse###
SettingsFolder = Settings_Location[:-1]#
CELAN_Backups = Settings_Location + r"ELAN_Backups\\"#

#
#
#
#

#Templet_Image_File_With_Red_Box = r"C:\Users\Administrator\Desktop\Image_Scripter\System\ImageScripter\Lib\site-packages\imagescripter\core\Last_Templet_Image_With_Red_Box.png"
Templet_Image_File_With_Red_Box = IMAGESCRIPTERPATH + r"\Lib\site-packages\imagescripter\core\Last_Templet_Image_With_Red_Box.png"




#LastVideavi = r"C:\Users\Administrator\Desktop\Image_Scripter\System\ImageScripter\Lib\site-packages\imagescripter\core\Last_Video.avi"
#LastVideavi = r"C:\Ellumination\System\ImageScripter\Lib\site-packages\imagescripter\core\Last_Video.avi"
LastVideavi = IMAGESCRIPTERPATH + r"\Lib\site-packages\imagescripter\core\Last_Video.avi"






Convert_Script_Path = Settings_Location + r"Converted_Script_Path.txt"#
oneminute = Settings_Location + r"oneminute.avi"#
thirtyseconds = Settings_Location + r"thirtyseconds.avi"#
threeminutes = Settings_Location + r"threeminutes.avi"#
Firmware_Update_Cycle = Settings_Location + r"Firmware_Update_Cycle.txt"#
twominutes = Settings_Location + r"twominutes.avi"#
dvr_video2223 = Settings_Location + r"dvr_video.avi"#




#Last_Templet_Image_with_dotpng = r"C:\Users\Administrator\Desktop\Image_Scripter\System\ImageScripter\Lib\site-packages\imagescripter\core\Last_Templet_Image_with_dot.png"
Last_Templet_Image_with_dotpng = IMAGESCRIPTERPATH + r"\Lib\site-packages\imagescripter\core\Last_Templet_Image_with_dot.png"






last_selected_apptxt33 =  Settings_Location + r"last_selected_app.txt"#
Controller_Nametxt = Settings_Location + r"Controller_Name.txt"#
Controller_IPtxt = Settings_Location + r"Controller_IP.txt"#





#Total_Runs_Script_Runnertxt = r"C:\Users\Administrator\Desktop\Image_Scripter\System\ImageScripter\Lib\site-packages\imagescripter\core\Total_Runs_Script_Runner.txt"
Total_Runs_Script_Runnertxt = IMAGESCRIPTERPATH + r"\Lib\site-packages\imagescripter\core\Total_Runs_Script_Runner.txt"






Run_Controller_List_Script_Runnertxt = Settings_Location + r"Run_Controller_List_Script_Runner.txt"#
##SettingsLast_Videopng = r"C:\Users\Administrator\Desktop\Image_Scripter\System\ImageScripter\Lib\site-packages\imagescripter\core\Last_Video.png"
SettingsLast_Videopng = IMAGESCRIPTERPATH + r"\Lib\site-packages\imagescripter\core\Last_Video.png"










Last_Target_Image_png = Target_Path
##On_the_Fly_Captured_Pic_File_Location = r"C:\Users\Administrator\Desktop\Image_Scripter\System\ImageScripter\Lib\site-packages\imagescripter\core\On_The_Fly_Captured_Images.pkl"
On_the_Fly_Captured_Pic_File_Location = IMAGESCRIPTERPATH + r"\Lib\site-packages\imagescripter\core\On_The_Fly_Captured_Images.pkl"
#print(On_the_Fly_Captured_Pic_File_Location)






Capture_Mode_Place = Settings_Location + r"Capture_Mode.txt"#

capturepng = ImageScripter_Location + r"Lib\site-packages\Script_Writer\capture.png"#
image_display_for_save_python_space = Python_Exe_Location + ' ' + ImageScripter_Location + 'Lib\site-packages\Script_Writer\image_display_for_save.py '#
image_display_for_save_python_no_space = Python_Exe_Location + ' ' + ImageScripter_Location + 'Lib\site-packages\Script_Writer\image_display_for_save.py'#
overwrite_imageui =  ImageScripter_Location + r"Lib\site-packages\Script_Writer\overwrite_image.ui"#
image_display_for_saveui2 = ImageScripter_Location + r"Lib\site-packages\Script_Writer\image_display_for_save.ui"#
update_Automcompletetxt = ImageScripter_Location + r"Lib\site-packages\Script_Writer\update_Automcomplete.txt"#
Script_WriterImage_Converterpy =  Python_Exe_Location + ' ' + ImageScripter_Location + r"Lib\site-packages\Script_Writer\Image_Converter.py "#
offsettool = Python_Exe_Location + ' ' + ImageScripter_Location + r"Lib\site-packages\Script_Writer\offset_tool.py"#
database_viewerdatabase_viewerui = ImageScripter_Location + r"Lib\site-packages\database_viewer\database_viewer.ui"#
fresh_data_base = ImageScripter_Location + r"Memory_Viewer\Fresh\memory_viewer_fresh.db"#
fresh_database_location = ImageScripter_Location + r'Lib\site-packages\imagescripter\database\fresh_station_database.db'#
screenshot_file_itp8 = ImageScripter_Location + r"TEMP\ITP8_Screenshot.png"#
Show_Image_Ui_Location_graph = ImageScripter_Location + r"Lib\site-packages\imagescripter\core\show_image_graph.ui"#
Max = ImageScripter_Location + r"Lib\site-packages\imagescripter\core\max.png"#
Min = ImageScripter_Location + r"Lib\site-packages\imagescripter\core\min.png"#
Loading_Interface_script = ImageScripter_Location + r"Lib\site-packages\imagescripter\core\Loading_Interface.py"#
scriptImage_Show = ImageScripter_Location + r"Lib\site-packages\imagescripter\core\Image_Show.py"#
Show_Image_Ui_Location = ImageScripter_Location + r"Lib\site-packages\imagescripter\core\show_image.ui"#
find_window_Ui_Location = ImageScripter_Location + r"Lib\site-packages\Script_Writer\find_window.ui"
script_writerui = ImageScripter_Location + r"Lib\site-packages\Script_Writer\script_writer.ui"
itp8IPAddress = PROJECT + r"\Applications_And_Devices\Itp8\ip_address.txt"#

#
#itp12IPAddress = r"C:\Users\Administrator\Desktop\Image_Scripter\Projects\_elan_\elan\Applications_And_Devices\Itp12\ip_address.txt"
itp12IPAddress = PROJECT + r"\Applications_And_Devices\Itp12\ip_address.txt"

#
pic_place = ImageScripter_Location + r"TEMP\pics"#
Loading_Interface_ui = ImageScripter_Location + r"Lib\site-packages\imagescripter\core\Loading_Interface.ui"#
loading_eyepng = ImageScripter_Location + r"Lib\site-packages\imagescripter\core\loading_eye.png"#
Image_Converter_location = ImageScripter_Location + r'Lib\site-packages\Script_Writer\Image_Converter.py'#
screenshot_file_MAC = ImageScripter_Location + r"TEMP\Mac_Screenshot.png"#
screenshotfile = ImageScripter_Location + r'TEMP\Android_Screenshot.png'#
gitProject = ImageScripter_Location[:-2]#

git = ImageScripter_Location + r"Sync\cmd\git.exe"#
oneonglocation = ImageScripter_Location + r"TEMP\PC_Pics\1.PNG"#
aonepng = ImageScripter_Location + r"TEMP\Android_Pics\1.png"#
atwopng = ImageScripter_Location + r"TEMP\Android_Pics\2.png"#
Reset_Image_Scripter_2exe = ImageScripter_Location + r"Scripts\dist\Reset_Image_Scripter_2.exe"
coresnipping_tool_for_on_the_flypy = Python_Exe_Location + ' ' + ImageScripter_Location + r"Lib\site-packages\imagescripter\core\snipping_tool_for_on_the_fly.py"#
Itp12ip_addresstxt = PROJECT + r"\Applications_And_Devices\Itp12\ip_address.txt"
ITP12settingswheelPNG = PROJECT + "\Applications_And_Devices\ITP12\settingswheel.PNG"
Itp12media10itemspng = PROJECT + "\Applications_And_Devices\Itp12\media10items.png"
sitepackagesScript_WriterImage_Converterui = ImageScripter_Location + r"Lib\site-packages\Script_Writer\Image_Converter.ui"
Script_Writernew_application_windowui = ImageScripter_Location + r"Lib\site-packages\Script_Writer\new_application_window.ui"




settings_pageui = ImageScripter_Location + r"Lib\site-packages\Script_Writer\settings_page.ui"
Script_Writerdiplay_image_for_captureui = ImageScripter_Location + r"Lib\site-packages\Script_Writer\diplay_image_for_capture.ui"
snipping_toolpy123space = Python_Exe_Location + ' ' + ImageScripter_Location + r"Lib\site-packages\Script_Writer\snipping_tool.py "#
snipping_toolpynospace = Python_Exe_Location + ' ' + ImageScripter_Location + r"Lib\site-packages\Script_Writer\snipping_tool.py"
new_application_windowpy = Python_Exe_Location + ' ' + ImageScripter_Location + r"Lib\site-packages\Script_Writer\new_application_window.py"
rsycconnand22 = "rsync  -rvcm --chmod=ug=rwX,o=rxX --compare-dest=/cygdrive/" + Old_Project_Copy_Reversed + "/ /cygdrive/" + PROJECT_Reverse + "/ "
Script_WriterScript_Converter_Setupui = ImageScripter_Location + r"Lib\site-packages\Script_Writer\Script_Converter_Setup.ui"
screenshot_file_pc = ImageScripter_Location + r"TEMP\PC_Screenshot.png"#
#commandrsyncvvv2233 = r"rsync  -rvcm --chmod=ug=rwX,o=rxX --compare-dest=/cygdrive/" + cygdrivetwo + r" /cygdrive/" + cygdrivetwo + " "#####Reverse### #
Imageexelocation = ImageScripter_Location + r"Lib\site-packages\imagescripter\exe"#
Video_Player_Scriptpy = Python_Exe_Location + ' ' + ImageScripter_Location + r'Lib\site-packages\Script_Writer\Video_Player_Script.py'#