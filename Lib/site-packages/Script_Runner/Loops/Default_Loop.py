
import os
from paths import *
import pickle
from PyQt5 import QtGui,QtCore
import subprocess

class Default_ScripRunner_Loop_Class():
    def get_list_of_script_dictionaries(self):
        List_of_Checked_Script_Dictionaries = []
        os.chdir(Script_Runner_Scripts_Folder)
        List_of_files = os.listdir()
        for file_name in List_of_files:
            with open(file_name,'rb') as f:
                script_dictionary = pickle.load(f)
                if script_dictionary['wasSavedChecked'] == True:
                    List_of_Checked_Script_Dictionaries.append(script_dictionary)
        return List_of_Checked_Script_Dictionaries



    def run(self):
        os.chdir(Script_Runner_Scripts_Folder)
        List_of_Checked_Script_Dictionaries = self.get_list_of_script_dictionaries()
        for Script_Dictionary in List_of_Checked_Script_Dictionaries:
            script_name = Script_Dictionary['name']
            script_path = Script_Dictionary['path']
            script_directory_path = Script_Dictionary['directory_full_path']
            script_directory_name = Script_Dictionary['directory_name']
            #self.process = subprocess.Popen(Python_Exe_Location, ['-u', script_path])
            with open(Active_Script_For_Script_Runner,'w') as f:
                f.write(script_path)
            os.system(Python_Exe_Location + ' -u ' + imagescripter_scriptpy)
            #self.process = QtCore.QProcess()
            #self.process.start()



if __name__ == '__main__':
    Loop = Default_ScripRunner_Loop_Class()
    Loop.run()