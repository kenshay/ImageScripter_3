from Script_Runner.Loops.Default_Loop import Default_ScripRunner_Loop_Class
from imagescripter.core.functions import Clear_Directory_Contents



class Run_Next_Folder_On_Fail_Loop_Class(Default_ScripRunner_Loop_Class):
    def run(self):
        self.Do_Before_While_Loop_Prep()
        while True:
            try:
                FOLDER_IGNORE_LIST = []
                self.Do_Before_Loop_Prep()
                for Script_Dictionary in self.get_list_of_script_dictionaries():
                    self.script_path = Script_Dictionary['path']
                    self.script_name = Script_Dictionary['name']
                    self.script_directory = Script_Dictionary['directory_name']
                    if self.script_directory not in FOLDER_IGNORE_LIST:
                        self.execute_script(self.script_path)
                    else:
                        print(self.script_path + " in Ignore List Folder -> " + self.script_name)
            except:
                self.Do_After_Failure_Post()
                FOLDER_IGNORE_LIST.append(self.script_directory)




if __name__ == '__main__':
    Loop = Run_Next_Folder_On_Fail_Loop_Class()
    Loop.run()